[
  {
    "objectID": "takehome_exercises/day2.html",
    "href": "takehome_exercises/day2.html",
    "title": "Day 2 - Take home exercise",
    "section": "",
    "text": "Answer script\n\n\n\nYou are expected to save your answer under R-cafe/day2/takehome.R\n\n\n\n\n\n\n\n\nPiping\n\n\n\nIt is expected that the exercise answers will be mainly using the pipe operators %&gt;%, instead of putting functions inside each other"
  },
  {
    "objectID": "takehome_exercises/day2.html#notes-and-instructions",
    "href": "takehome_exercises/day2.html#notes-and-instructions",
    "title": "Day 2 - Take home exercise",
    "section": "",
    "text": "Answer script\n\n\n\nYou are expected to save your answer under R-cafe/day2/takehome.R\n\n\n\n\n\n\n\n\nPiping\n\n\n\nIt is expected that the exercise answers will be mainly using the pipe operators %&gt;%, instead of putting functions inside each other"
  },
  {
    "objectID": "takehome_exercises/day2.html#dataset",
    "href": "takehome_exercises/day2.html#dataset",
    "title": "Day 2 - Take home exercise",
    "section": "Dataset",
    "text": "Dataset\nSame for day 1 exercise, we will also use covid_cases.rds under R-cafe/day1/data/covid_cases.rds for this exercise."
  },
  {
    "objectID": "takehome_exercises/day2.html#exercises",
    "href": "takehome_exercises/day2.html#exercises",
    "title": "Day 2 - Take home exercise",
    "section": "Exercises",
    "text": "Exercises\n\nTask 1: Data import\n\nRead data from R-cafe/day1/data/covid_cases.rds\nLoad the tidyverse meta-package into R\n\n\nsuppressPackageStartupMessages(library(tidyverse))\n\nWarning: package 'lubridate' was built under R version 4.4.2\n\ncovid_cases &lt;- read_rds(\"../data/covid_cases.rds\")\n\n\n\n\n\n\n\nNote\n\n\n\nA “meta-package” is a package that contains other packages. Remember, tidyverse is just a collection of packages.\n\n\n\n\nTask 2: Data cleaning and filtering\n\nDoes the data follow the tidy data standard? (refer to session 2 slides)\n\nIf not, pivot the data into a tibble that follows the tidy data standard\n\nDo some quick skim on the data. Do the variable values make sense given its type?\n\nIf not, filter out incorrect/impossible data\n\nFilter the data so that we only have week 3-12 of 2020\nSave the results back into covid_cases\n\n\ncovid_cases &lt;- covid_cases %&gt;%\n  pivot_longer(\n    -date,\n    names_to = \"country\",\n    names_pattern = \"cases_(.+)\",\n    values_to = \"cases\"\n  ) %&gt;%\n  mutate(week = week(date)) %&gt;%\n  filter(cases &gt; -1, week &lt; 3 + 10)\n\n\n\n\n\n\n\nTip: pivotting\n\n\n\n\n\n\nIf your data is not tidy data:\n\n“Lengthens” the data using tidyr::pivot_longer(), i.e. less columns, more rows\n“Widens” the data using tidyr::pivot_wider(), i.e. less rows, more columns\n\n\n\n\n\n\n\n\n\n\n\nTip: data skimming and cleaning\n\n\n\n\n\n\nUse skimr::skim() such as in day 1 exercises to quickly look at the data\nThe main variable here is case counts from each country. They should have a numeric type and should not be lower than 0. You can’t have negative case counts\nYou can remove or filter undesirable values using dplyr::filter()\n\n\n\n\n\n\nTask 3: Data transformation\n\nUsing the covid_cases object created in Task 2:\n\nGroup the data and calculate the total number of cases per country\nSelect the top 5 countries with highest total cases\nExtract the country codes and save them into a new object, e.g. top_countries\n\n\n\ntop_n &lt;- 5 # optional\ntop_countries &lt;- covid_cases %&gt;%\n  group_by(country) %&gt;%\n  summarise(total_cases = sum(cases)) %&gt;%\n  slice_max(total_cases, n = top_n) %&gt;%\n  pull(country)\n\n\nUse the covid_cases object created in Task 2 again:\n\nGroup the data again, calculate the total number of cases per country again\nModify the country column:\n\nSo that we only keep the names of countries in the top 5 (generated above). Countries on in the top 5 will be changed to \"Others\"\nTurn this column into a factor type (refer to session 1 slides using the forcats package (already in tidyverse)\nGroup the data again, this time, group by date and country\nCalculate the total number of cases per date per country\nCreate a new column called pct_cases, which is the percentage of total cases per date per country\n(Optional) remove rows with NA from the tibble\nThere are many ways to do this part of the task\n\nSave all of this into a new object, e.g. plot_data\n\n\n\nplot_data &lt;- covid_cases %&gt;%\n  group_by(country) %&gt;%\n  mutate(total_cases = sum(cases)) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    country = fct_lump_n(country, n = top_n, w = total_cases, other_level = \"Others\") %&gt;%\n      fct_relevel(\"Others\", after = Inf)\n  ) %&gt;%\n  group_by(date, country) %&gt;%\n  summarise(total_cases = sum(cases)) %&gt;%\n  mutate(\n    pct_cases = total_cases / sum(total_cases) * 100\n  ) %&gt;%\n  drop_na() %&gt;%\n  suppressMessages()\n\n\n\n\n\n\n\nTip: data grouping and summarisation\n\n\n\n\n\n\nGroup data into groups with dplyr::group_by() and ungroup data with dplyr::ungroup()\nSummarise each group into a single row with dplyr::summarise()\nYou can have multiple groups at the same time. For example:\n\n\ncovid_cases %&gt;%\n  group_by(date, country) %&gt;%\n  summarise(total_cases = sum(cases))\n\n`summarise()` has grouped output by 'date'. You can override using the\n`.groups` argument.\n\n\n\n  \n\n\n\n\nYou can choose not to summarise, but add a new column to each group with dplyr::mutate(). For example:\n\n\ncovid_cases %&gt;%\n  group_by(country) %&gt;%\n  mutate(total_cases = sum(cases))\n\n\n  \n\n\n\nThis will create a new column total_cases that contains the sum of cases for each country without reducing each group into a single row like summarise(). Values will be duplicated for each group.\n\n\n\n\n\n\n\n\n\nTip: get top n values in a tibble\n\n\n\n\n\n\nYou can select rows with the top n values in a tibble using dplyr::slice_max()\n\n\n\n\n\n\n\n\n\n\nTip: get values of a column in a tibble\n\n\n\n\n\n\nYou can extract values from a columns in a tibble using dplyr::pull()\n\n\n\n\n\n\n\n\n\n\nTip: turn a tibble column into a factor\n\n\n\n\n\n\nYou can create and work with factors inside a tibble using the forcats package (already in tidyverse)\nYou can “lump”, or gather, factor levels that are not frequent with forcats::fct_lump_n()\n\n\n\n\n\n\nTask 4: Data visualization\n\nUsing ggplot2, try your best to generate the following figure:\n\n\nplot_data %&gt;%\n  ggplot(aes(x = date, y = pct_cases, fill = country)) +\n  geom_area() +\n  scale_y_continuous(\n    \"Percent of total cases\",\n    breaks = seq(0, 100, 10),\n    labels = paste0(seq(0, 100, 10), \"%\")\n  ) +\n  scale_x_date(\n    \"Date\",\n    date_breaks = \"1 week\", date_labels = \"W%W\",\n    minor_breaks = NULL\n  ) +\n  scale_fill_discrete(\n    \"Country\",\n    labels = c(\n      \"chn\" = \"China\",\n      \"deu\" = \"Germany\",\n      \"esp\" = \"Spain\",\n      \"ita\" = \"Italy\",\n      \"usa\" = \"USA\"\n    )\n  ) +\n  ggtitle(\"Percentage of COVID case counts per country for the first 10 weeks of 2020\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip: how do I draw that??\n\n\n\n\n\n\nggplot2 reference page is very useful\nHere are all the functions used to generate the plot above, in sequence:\n\nggplot()\ngeom_area()\nscale_y_continuous()\nscale_x_date()\nscale_fill_discrete()\nggtitle()\nEvery function is connected with the + operator"
  },
  {
    "objectID": "slides/tidyverse.html#session-overview",
    "href": "slides/tidyverse.html#session-overview",
    "title": "R programming with tidyverse",
    "section": "Session overview",
    "text": "Session overview\nWhat will be covered:\n\nInto the tidyverse\n\nWhat is tidyverse?\nWhy should we use it?\nHow do we use it?\nPiping with %&gt;%\n\nVectorise R functions\n\nVectors and vectorisation\nVectorisation with map()\ntidyverse style vs. base R style\n\nggplot2 for data visualisation\n\nGrammar of graphics"
  },
  {
    "objectID": "slides/tidyverse.html#session-overview-1",
    "href": "slides/tidyverse.html#session-overview-1",
    "title": "R programming with tidyverse",
    "section": "Session overview",
    "text": "Session overview\n\nThroughout this session:\n\nIn-slide examples will be using the mtcars dataset (already in base R)\nWalk-through exercises will be using the covid_cases dataset"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-tidyverse",
    "href": "slides/tidyverse.html#what-is-tidyverse",
    "title": "R programming with tidyverse",
    "section": "What is tidyverse?",
    "text": "What is tidyverse?\n\ntidyverse is a collection of R packages built for data science\nAll packages shared the same principle of tidy data\nConsists of 8 core packages, and a dozen more packages for various specific purposes"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-tidyverse-1",
    "href": "slides/tidyverse.html#what-is-tidyverse-1",
    "title": "R programming with tidyverse",
    "section": "What is tidyverse?",
    "text": "What is tidyverse?\nTidy data\n\nA dataset with rows and columns\nEach column is a variable\nEach row is an observation\nEach cell contains 1 value only"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-tidyverse-2",
    "href": "slides/tidyverse.html#what-is-tidyverse-2",
    "title": "R programming with tidyverse",
    "section": "What is tidyverse?",
    "text": "What is tidyverse?\nTidy data\nWhich of these is a tidy data table\n\n\n\n  \n\n\n\nor"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-tidyverse-3",
    "href": "slides/tidyverse.html#what-is-tidyverse-3",
    "title": "R programming with tidyverse",
    "section": "What is tidyverse?",
    "text": "What is tidyverse?"
  },
  {
    "objectID": "slides/tidyverse.html#why-tidyverse",
    "href": "slides/tidyverse.html#why-tidyverse",
    "title": "R programming with tidyverse",
    "section": "Why tidyverse?",
    "text": "Why tidyverse?\n\n\nEvery function in tidyverse shares a consistent structure and pattern. Making it very easy to implement and edit your R code\nOutputs are also easier to read and consistent\nIn general, your R code may look cleaner and easier to follow, compared to base R\nYou just need to install everything once, instead of different packages for different things\n\n\n\n\n\n\n\n\n\nNote\n\n\nThis is all subjective and your experience with tidyverse may varies"
  },
  {
    "objectID": "slides/tidyverse.html#why-tidyverse-1",
    "href": "slides/tidyverse.html#why-tidyverse-1",
    "title": "R programming with tidyverse",
    "section": "Why tidyverse?",
    "text": "Why tidyverse?\n\n\n\n\n\n\nTakeaway points\n\n\n\ntidyverse is not a replacement of base R. It is just a collection of R packages\nYou don’t have to use tidyverse when using R\ntidyverse has most functions for data science needs. Though, there are times base R will be needed, and might be better/easier/faster\nUnderstanding the principles and goals of tidyverse will better your knowledge on good coding practices and R"
  },
  {
    "objectID": "slides/tidyverse.html#why-tidyverse-2",
    "href": "slides/tidyverse.html#why-tidyverse-2",
    "title": "R programming with tidyverse",
    "section": "Why tidyverse?",
    "text": "Why tidyverse?\nCommonly used tidyverse functions:\n\n\ndplyr::select() to select columns from a tibble\ndplyr::mutate() to change and create columns in a tibble\ntidyr::pivot_longer() to transform a tibble from wide to long format (less columns, more rows)\ntidyr::pivot_wider() to transform a tibble from long to wide format (less rows, more columns)\ndplyr::group_by() and dplyr::summarise() to group data and summarise it using a function, e.g. mean, max, min, sum\n\n\n\n\n\n\n\n\n\nNote\n\n\ntibble is a type of dataframe that is used by all tidyverse functions"
  },
  {
    "objectID": "slides/tidyverse.html#why-tidyverse-3",
    "href": "slides/tidyverse.html#why-tidyverse-3",
    "title": "R programming with tidyverse",
    "section": "Why tidyverse?",
    "text": "Why tidyverse?\n\n\nOne of the main “unit” you will work with in R is a dataframe\nIn base R, this object has type of data.frame\n\n\n\n\nclass(mtcars)\n\n[1] \"data.frame\"\n\n\n\n\n\nIn the tidyverse, we work with something called a tibble (object type is called tbl_df)\n\n\nclass(as_tibble(mtcars))\n\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\n\n\n\nYou can see the differences more clearly in R"
  },
  {
    "objectID": "slides/tidyverse.html#how-to-use-tidyverse",
    "href": "slides/tidyverse.html#how-to-use-tidyverse",
    "title": "R programming with tidyverse",
    "section": "How to use tidyverse",
    "text": "How to use tidyverse\nStart by installing it!\n\ninstall.packages(\"tidyverse\")\n\n\n\n\n\n\n\nNote\n\n\nMost packages will be installed. You might need some more packages, but generally it should cover most of your needs."
  },
  {
    "objectID": "slides/tidyverse.html#how-to-use-tidyverse-1",
    "href": "slides/tidyverse.html#how-to-use-tidyverse-1",
    "title": "R programming with tidyverse",
    "section": "How to use tidyverse",
    "text": "How to use tidyverse\nThen load it into your R environment!\n\nlibrary(tidyverse)\n\n\n\n\n\n\n\nFree R tip\n\n\nYou can load specific packages like library(dplyr)"
  },
  {
    "objectID": "slides/tidyverse.html#how-to-use-tidyverse-2",
    "href": "slides/tidyverse.html#how-to-use-tidyverse-2",
    "title": "R programming with tidyverse",
    "section": "How to use tidyverse",
    "text": "How to use tidyverse\nRun this example code below to make sure everything is running normally\n\nggplot(\n  data = ungroup(summarise(group_by(mtcars, gear), mean_mpg = mean(mpg))),\n  aes(x = gear, y = mean_mpg)\n) +\n  geom_col()\n\n\n\n\n\n\n\n\nFree R tips\n\n\n\ntype ?function_name for help on how to use a function and see which package is it coming from\nadd “tidyverse” into your Google searches when looking for R issues"
  },
  {
    "objectID": "slides/tidyverse.html#how-to-use-tidyverse-2-output",
    "href": "slides/tidyverse.html#how-to-use-tidyverse-2-output",
    "title": "R programming with tidyverse",
    "section": "How to use tidyverse",
    "text": "How to use tidyverse"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with",
    "href": "slides/tidyverse.html#piping-with",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\n\nLook back at the example code\n\n\nggplot(\n  data = ungroup(summarise(group_by(mtcars, gear), mean_mpg = mean(mpg))),\n  aes(x = gear, y = mean_mpg)\n) +\n  geom_col()\n\n\n\nHow easy is it to understand/follow this code?\nCan we improve readability?"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-1",
    "href": "slides/tidyverse.html#piping-with-1",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\n\n\nTypically in R, we perform a sequence of operations on a dataset, changing it as we go\nR has a functional style, which means the structure is typically: new_data &lt;- function(data, extra_arguments)\n\nfunction describes your action, what you want to do\ndata is the data that you are execute the action on\nextra_arguments are (optional) settings that changes how the action is performed\nnew_data is the output, what you get after performing the action"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-2",
    "href": "slides/tidyverse.html#piping-with-2",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\n\n\nThe example code can be rewritten as:\n\n\ngrouped_by_gear &lt;- group_by(mtcars, gear)\nmean_mpg_by_gear  &lt;- summarise(grouped_by_gear, mean_mpg = mean(mpg))\nungrouped_data &lt;- ungroup(mean_mpg_by_gear)\n\nggplot(\n  data = ungrouped_data,\n  aes(x = gear, y = mean_mpg)\n) +\n  geom_col()\n\n\n\n\nIs this a better way to write it? Can we improve it even further?\nIf we are performing a sequence of actions, each using the output of the previous action, we can use pipe"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-3",
    "href": "slides/tidyverse.html#piping-with-3",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\n\n\nPipe is a powerful tool to express a sequence of actions (functions)\nIt helps you write code that is easier to read and understand\nIn R, you can pipe between functions using the %&gt;% or |&gt; operators\nRstudio shortcut: Cmd+Shift+M or Ctrl+Shift+M\n\n\n\n\n\n\n\n\n\n%&gt;% vs. |&gt;\n\n\n\n%&gt;% comes from the magrittr package which is used by all of tidyverse\n|&gt; comes from R since version 4.1.0. It functions largely the same as %&gt;% but not identical\nR Café will use %&gt;%"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-4",
    "href": "slides/tidyverse.html#piping-with-4",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\n\nPipes transfer the data from its left-hand side (LHS) to the function on its right-hand side (RHS) as the first argument of that function\nThe structure: new_data &lt;- data %&gt;% function(extra_arguments)"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-5",
    "href": "slides/tidyverse.html#piping-with-5",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\nFor example:\n\ngroup_by(mtcars, gear)\n\nis exactly the same as\n\nmtcars %&gt;% group_by(gear)"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-6",
    "href": "slides/tidyverse.html#piping-with-6",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\nAnother example:\n\nsummarise(group_by(mtcars, gear), mean_mpg = mean(mpg))\n\nis exactly the same as\n\nmtcars %&gt;% group_by(gear) %&gt;% summarise(mean_mpg = mean(mpg))\n\n\n\n\n\n\n\n\nNote\n\n\nEvery function under tidyverse will take the data as the first argument, so everything can be piped!"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-7",
    "href": "slides/tidyverse.html#piping-with-7",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\n\nUsing pipe, we can now rewrite the code as:\n\n\nmtcars %&gt;% \n  group_by(gear) %&gt;% \n  summarise(mean_mpg = mean(mpg)) %&gt;% \n  ungroup() %&gt;% \n  ggplot(aes(x = gear, y = mean_mpg)) +\n  geom_col()\n\n\nFor you, is it better/faster to understand what’s happening now?"
  },
  {
    "objectID": "slides/tidyverse.html#piping-with-8",
    "href": "slides/tidyverse.html#piping-with-8",
    "title": "R programming with tidyverse",
    "section": "Piping with %>%",
    "text": "Piping with %&gt;%\nQuick comparison\n\nggplot(\n  data = ungroup(summarise(group_by(mtcars, gear), mean_mpg = mean(mpg))),\n  aes(x = gear, y = mean_mpg)\n) +\n  geom_col()\n\nvs.\n\nmtcars %&gt;% \n  group_by(gear) %&gt;% \n  summarise(mean_mpg = mean(mpg)) %&gt;% \n  ungroup() %&gt;% \n  ggplot(aes(x = gear, y = mean_mpg)) +\n  geom_col()"
  },
  {
    "objectID": "slides/tidyverse.html#exercise-1",
    "href": "slides/tidyverse.html#exercise-1",
    "title": "R programming with tidyverse",
    "section": "Exercise",
    "text": "Exercise\n\n\n\n\n\n\nChecklist\n\n\n\nLoad the covid_cases dataset\nHave a look at the dataset, do you understand how is it structured? Does it follow the tidy data standard?\nUse tidyverse to transform the data into a tidy tibble"
  },
  {
    "objectID": "slides/tidyverse.html#exercise-2",
    "href": "slides/tidyverse.html#exercise-2",
    "title": "R programming with tidyverse",
    "section": "Exercise",
    "text": "Exercise\n\nLoad the covid_cases dataset\n\n\n\n# read in data\ncovid_cases &lt;- read_rds(\"../data/covid_cases.rds\")\ncovid_cases\n\n\n  \n\n\n\n\n\n\nIs this a tidy data table?"
  },
  {
    "objectID": "slides/tidyverse.html#exercise-3",
    "href": "slides/tidyverse.html#exercise-3",
    "title": "R programming with tidyverse",
    "section": "Exercise",
    "text": "Exercise\n\n\nRecall what is the tidy data standard\nWe want:\n\nEach column to represent a single variable. What are the variables here?\nVariables: date, country, cases or case_count\nSo, we want less columns more rows: pivot_longer()"
  },
  {
    "objectID": "slides/tidyverse.html#exercise-4",
    "href": "slides/tidyverse.html#exercise-4",
    "title": "R programming with tidyverse",
    "section": "Exercise",
    "text": "Exercise\n\nHow to use: ?pivot_longer()\nMake the data “longer”\n\n\n\ncovid_cases &lt;- covid_cases %&gt;% \n  pivot_longer(\n    cols = -date,\n    names_to = \"country\", \n    names_pattern = \"cases_(.+)\",\n    values_to = \"cases\"\n  )\ncovid_cases"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-a-vector",
    "href": "slides/tidyverse.html#what-is-a-vector",
    "title": "R programming with tidyverse",
    "section": "What is a vector?",
    "text": "What is a vector?\n\n\nA vector is a container of elements of similar classes\nIn math, \\([1\\space 2\\space 3]\\) is a vector of 3 integers\nIn R, you can define vectors by putting them inside c()\n\nc(1, 2, 3) is a vector of 3 numeric elements\nc(\"ab\", \"cd\", \"ef\") is a vector of 3 character elements\nc(c(1, 2), c(2, 3), c(3, 4)) is a vector of 3 vector elements, each is a vector of 2 numeric elements"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-a-vector-1",
    "href": "slides/tidyverse.html#what-is-a-vector-1",
    "title": "R programming with tidyverse",
    "section": "What is a vector?",
    "text": "What is a vector?\n\nQuestion: is 12 a vector?\n\n\n\nclass(12)\n\n[1] \"numeric\"\n\nclass(c(12))\n\n[1] \"numeric\"\n\nclass(c(12, 13, 14))\n\n[1] \"numeric\"\n\n\n\nIn R, most things are vectors. A single number by itself is also a vector\n12 itself is a vector that has one numeric element"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-a-vector-2",
    "href": "slides/tidyverse.html#what-is-a-vector-2",
    "title": "R programming with tidyverse",
    "section": "What is a vector?",
    "text": "What is a vector?\n\n\nConceptually, a tibble is a list of named vectors!\nYou can see it using the str() function\n\n\n\n\nstr(covid_cases)\n\ntibble [19,412 × 3] (S3: tbl_df/tbl/data.frame)\n $ date   : Date[1:19412], format: \"2020-01-20\" \"2020-01-20\" ...\n $ country: chr [1:19412] \"chn\" \"kor\" \"aus\" \"jpn\" ...\n $ cases  : num [1:19412] 0 0 0 0 0 0 0 0 0 0 ...\n\n\n\n\n\ncovid_cases has 3 vectors:\n\ndate is a vector of dates\ncountry is a vector of characters\ncases is a vector of numbers"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-a-vector-3",
    "href": "slides/tidyverse.html#what-is-a-vector-3",
    "title": "R programming with tidyverse",
    "section": "What is a vector?",
    "text": "What is a vector?\n\nYou can access vector elements with the $ operator\n\n\ncovid_cases$date[10000:10010]\n\n [1] \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\"\n [6] \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\"\n[11] \"2020-03-08\"\n\ncovid_cases$country[10000:10010]\n\n [1] \"spm\" \"esp\" \"ita\" \"deu\" \"fra\" \"gbr\" \"tur\" \"bel\" \"che\" \"nld\" \"prt\"\n\ncovid_cases$cases[10000:10010]\n\n [1]    0   56 1247  156   93   43    0   60   55   60    8"
  },
  {
    "objectID": "slides/tidyverse.html#what-is-a-vector-4",
    "href": "slides/tidyverse.html#what-is-a-vector-4",
    "title": "R programming with tidyverse",
    "section": "What is a vector?",
    "text": "What is a vector?\n\nOr the tidyverse way with dplyr::slice() and dplyr::pull()\n\n\ncovid_cases %&gt;% slice(10000:10010) %&gt;% pull(date)\n\n [1] \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\"\n [6] \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\" \"2020-03-08\"\n[11] \"2020-03-08\"\n\ncovid_cases %&gt;% slice(10000:10010) %&gt;% pull(country)\n\n [1] \"spm\" \"esp\" \"ita\" \"deu\" \"fra\" \"gbr\" \"tur\" \"bel\" \"che\" \"nld\" \"prt\"\n\ncovid_cases %&gt;% slice(10000:10010) %&gt;% pull(cases)\n\n [1]    0   56 1247  156   93   43    0   60   55   60    8\n\n\n\n\n\n\n\n\nNote\n\n\n\none of the cases where using base R might be quicker and doesn’t sacrifice readability\ndplyr and tidyverse equivalents"
  },
  {
    "objectID": "slides/tidyverse.html#for-loops",
    "href": "slides/tidyverse.html#for-loops",
    "title": "R programming with tidyverse",
    "section": "For-loops",
    "text": "For-loops\n\n\nIn programming, we typically use for-loops to go through elements within a vector\nExample: We want to take the square of a vector\n\n\n\n\ndata &lt;- covid_cases$cases[10000:10010]\n\n# before\ndata\n\n [1]    0   56 1247  156   93   43    0   60   55   60    8\n\nsquared_data &lt;- numeric() # create new object to hold new data\nidx &lt;- seq(1, length(data)) # create index vector from 1 to the length of data\nfor (i in idx) {\n  squared_data[i] &lt;- data[i]^2\n}\n\n# after\nsquared_data\n\n [1]       0    3136 1555009   24336    8649    1849       0    3600    3025\n[10]    3600      64"
  },
  {
    "objectID": "slides/tidyverse.html#vectorisation",
    "href": "slides/tidyverse.html#vectorisation",
    "title": "R programming with tidyverse",
    "section": "Vectorisation",
    "text": "Vectorisation\n\n\nInstead of going through each element and perform an action, we can apply an action to all elements at once\nExample: Take the square root of a vector\n\n\n\n\n# before\nsquared_data\n\n [1]       0    3136 1555009   24336    8649    1849       0    3600    3025\n[10]    3600      64\n\n# after\nsqrt_data &lt;- sqrt(squared_data)\nsqrt_data\n\n [1]    0   56 1247  156   93   43    0   60   55   60    8\n\n# alternative using `sapply()`\nsqrt_data &lt;- sapply(squared_data, sqrt)\nsqrt_data\n\n [1]    0   56 1247  156   93   43    0   60   55   60    8\n\n\n\n\n\n\n\n\nNote\n\n\nMost functions math-related functions and operators in base R are already vectorised, e.g. sqrt(), log(), exp(), +, -, *, /"
  },
  {
    "objectID": "slides/tidyverse.html#vectorisation-1",
    "href": "slides/tidyverse.html#vectorisation-1",
    "title": "R programming with tidyverse",
    "section": "Vectorisation",
    "text": "Vectorisation\n\nR has a functional style, which means vectorisation is more intuitive to write and read code\nOn a technical level:\n\nR itself might be slightly faster when doing vectorisation, compared to for-loops\nfor more complex and time-consuming functions, it is easier to paralellise with vectorisation"
  },
  {
    "objectID": "slides/tidyverse.html#vectorisation-2",
    "href": "slides/tidyverse.html#vectorisation-2",
    "title": "R programming with tidyverse",
    "section": "Vectorisation",
    "text": "Vectorisation\n\nVectorisation shines when there are more complex actions, and you have to write your own functions\nExample: Assume that data is a vector of circle diameters, take its square roots and calculate the surface areas with vectorisation using sapply()\n\n\n\narea_from_diameter &lt;- function(d) {\n  return(3.14 * (sqrt(d) / 2)^2)\n}\nsapply(data, area_from_diameter)\n\n [1]   0.000  43.960 978.895 122.460  73.005  33.755   0.000  47.100  43.175\n[10]  47.100   6.280\n\n\n\n\n\n# alternatively\nsapply(data, \\(d) 3.14 * (sqrt(d) / 2)^2)\n\n [1]   0.000  43.960 978.895 122.460  73.005  33.755   0.000  47.100  43.175\n[10]  47.100   6.280"
  },
  {
    "objectID": "slides/tidyverse.html#vectorisation-with-map",
    "href": "slides/tidyverse.html#vectorisation-with-map",
    "title": "R programming with tidyverse",
    "section": "Vectorisation with map()",
    "text": "Vectorisation with map()\n\nIn the tidyverse, we can perform vectorisation with the purrr::map() family\nLet’s check how it works with ?purrr::map()\n\n\n\nPrevious example using map()\n\n\nmap(data, \\(d) 3.14 * (sqrt(d) / 2)^2) %&gt;% list_c()\n\n [1]   0.000  43.960 978.895 122.460  73.005  33.755   0.000  47.100  43.175\n[10]  47.100   6.280\n\n\n\n\n\n\n\n\n\nNote\n\n\nWe do list_c() after a map() because map() is designed to take in a list and return a list. list_c() helps combine a list into a vector"
  },
  {
    "objectID": "slides/tidyverse.html#vectorisation-with-map-1",
    "href": "slides/tidyverse.html#vectorisation-with-map-1",
    "title": "R programming with tidyverse",
    "section": "Vectorisation with map()",
    "text": "Vectorisation with map()\n\nIf you have 2 vectors that you want to go through at the same time, you can use map2()\nExample: data2 is a vector of side lengths of squares, I want the sum of surface areas from the circles and the squares\n\n\n\ndata2 &lt;- c(29, 37, 22, 35, 39, 29, 30, 33, 43, 36, 26)\n\nmap2(data, data2, \\(d, l) (3.14 * (sqrt(d) / 2)^2) + (l^2)) %&gt;% list_c()\n\n [1]  841.000 1412.960 1462.895 1347.460 1594.005  874.755  900.000 1136.100\n [9] 1892.175 1343.100  682.280"
  },
  {
    "objectID": "slides/tidyverse.html#vectorisation-with-map-2",
    "href": "slides/tidyverse.html#vectorisation-with-map-2",
    "title": "R programming with tidyverse",
    "section": "Vectorisation with map()",
    "text": "Vectorisation with map()\n\nYou can create new columns, or edit current columns, with complex actions when using map() with mutate()\nExample: Using the mtcars dataset, create a new column called hp_p_wt, which is the horsepower per weight of each car in kilograms\n\n\n\nmtcars %&gt;% \n  mutate(\n    hp_p_wt = map2(hp, wt, \\(h, w) h / (w / 2.205)) %&gt;% unlist(),\n    .before = mpg\n  )"
  },
  {
    "objectID": "slides/tidyverse.html#data-visualisation",
    "href": "slides/tidyverse.html#data-visualisation",
    "title": "R programming with tidyverse",
    "section": "Data visualisation",
    "text": "Data visualisation\n\n\nNow that we have the results of our study, we should visualise it to disseminate the information\nIn base R, we use plot() (and other functions) to draw figures\nIn tidyverse, we use the ggplot2 package"
  },
  {
    "objectID": "slides/tidyverse.html#an-example",
    "href": "slides/tidyverse.html#an-example",
    "title": "R programming with tidyverse",
    "section": "An example",
    "text": "An example\n\nBase R:\n\n\nplot(\n  x = mtcars$wt,\n  y = mtcars$mpg,\n  xlab = \"Weight (1000 lbs)\",\n  ylab = \"Miles Per Gallon\",\n  main = \"MPG vs. Weight\",\n  pch = 19,       # Solid circle points\n  col = \"blue\"\n)"
  },
  {
    "objectID": "slides/tidyverse.html#an-example-1",
    "href": "slides/tidyverse.html#an-example-1",
    "title": "R programming with tidyverse",
    "section": "An example",
    "text": "An example\n\nggplot2 :\n\n\nggplot(mtcars, aes(x = wt, y = mpg)) +\n  geom_point(color = \"blue\") +\n  scale_x_continuous(\"Weight (1000 lbs)\") +\n  scale_y_continuous(\"Miles Per Gallon\") +\n  ggtitle(\"MPG vs. Weight\") + \n  theme_bw()"
  },
  {
    "objectID": "slides/tidyverse.html#ggplot2",
    "href": "slides/tidyverse.html#ggplot2",
    "title": "R programming with tidyverse",
    "section": "ggplot2",
    "text": "ggplot2\n\nggplot2 works directly with tidy data (same as everything under tidyverse)\nIt is based on a concept called “grammar of graphics”\nHas intuitive and comprehensive documentation on how to use it effectively\nProvide enough flexibility for customisation"
  },
  {
    "objectID": "slides/tidyverse.html#grammar-of-graphics",
    "href": "slides/tidyverse.html#grammar-of-graphics",
    "title": "R programming with tidyverse",
    "section": "Grammar of graphics",
    "text": "Grammar of graphics\n\nA framework to describe and construct graphics in a structured manner\nHas a layered approach, i.e. each component of a figure is a separate layer"
  },
  {
    "objectID": "slides/tidyverse.html#grammar-of-graphics-1",
    "href": "slides/tidyverse.html#grammar-of-graphics-1",
    "title": "R programming with tidyverse",
    "section": "Grammar of graphics",
    "text": "Grammar of graphics"
  },
  {
    "objectID": "slides/tidyverse.html#grammar-of-graphics-2",
    "href": "slides/tidyverse.html#grammar-of-graphics-2",
    "title": "R programming with tidyverse",
    "section": "Grammar of graphics",
    "text": "Grammar of graphics\n\nLook back at the example code:\n\n\nggplot(mtcars, aes(x = wt, y = mpg)) +\n  geom_point(color = \"blue\") +\n  scale_x_continuous(\"Weight (1000 lbs)\") +\n  scale_y_continuous(\"Miles Per Gallon\") +\n  ggtitle(\"MPG vs. Weight\") + \n  theme_bw()\n\n\nCan you identify the different layers of this plot?"
  },
  {
    "objectID": "slides/tidyverse.html#grammar-of-graphics-3",
    "href": "slides/tidyverse.html#grammar-of-graphics-3",
    "title": "R programming with tidyverse",
    "section": "Grammar of graphics",
    "text": "Grammar of graphics\n\nCheckout the reference tab and cheatsheet for ggplot2 here"
  },
  {
    "objectID": "slides/quarto-example.html",
    "href": "slides/quarto-example.html",
    "title": "Hello, Quarto",
    "section": "",
    "text": "Quarto is a publishing system that allows you to create documents, presentations, websites, and more using Markdown syntax and additional tools."
  },
  {
    "objectID": "slides/quarto-example.html#introduction-to-quarto",
    "href": "slides/quarto-example.html#introduction-to-quarto",
    "title": "Hello, Quarto",
    "section": "",
    "text": "Quarto is a publishing system that allows you to create documents, presentations, websites, and more using Markdown syntax and additional tools."
  },
  {
    "objectID": "slides/quarto-example.html#header-levels",
    "href": "slides/quarto-example.html#header-levels",
    "title": "Hello, Quarto",
    "section": "2 Header Levels",
    "text": "2 Header Levels\nQuarto supports multiple header levels to create a hierarchical structure in your document. For example:\n\nLevel 1 header: # Header\nLevel 2 header: ## Subheader\nLevel 3 header: ### Sub-subheader\n\n\n2.1 Nested Headers\nUsing headers, you can create nested sections to structure your document in a clear and organized way."
  },
  {
    "objectID": "slides/quarto-example.html#inline-text-formatting",
    "href": "slides/quarto-example.html#inline-text-formatting",
    "title": "Hello, Quarto",
    "section": "3 Inline Text Formatting",
    "text": "3 Inline Text Formatting\nYou can format your text inline to add emphasis or other styling options.\n\nBold text: **bold**\nItalic text: *italic*\nInline code: `code`\n\n\nBlockquotes can be used to highlight important information or quotes by adding &gt; at the beginning of a line."
  },
  {
    "objectID": "slides/quarto-example.html#lists",
    "href": "slides/quarto-example.html#lists",
    "title": "Hello, Quarto",
    "section": "4 Lists",
    "text": "4 Lists\nQuarto supports both ordered and unordered lists.\n\n4.1 Unordered List\nTo create an unordered list, use an asterisk * before each item:\n\nFirst item\nSecond item\nThird item\n\n\n\n4.2 Ordered List\nTo create an ordered list, use numbers before each item:\n\nFirst item\nSecond item\nThird item"
  },
  {
    "objectID": "slides/quarto-example.html#links-and-images",
    "href": "slides/quarto-example.html#links-and-images",
    "title": "Hello, Quarto",
    "section": "5 Links and images",
    "text": "5 Links and images\nhttp://example.com\nlinked phrase\n\n\n\noptional caption text"
  },
  {
    "objectID": "slides/quarto-example.html#tables",
    "href": "slides/quarto-example.html#tables",
    "title": "Hello, Quarto",
    "section": "6 Tables",
    "text": "6 Tables\n\n\n\nFirst Header\nSecond Header\n\n\n\n\nContent Cell\nContent Cell\n\n\nContent Cell\nContent Cell"
  },
  {
    "objectID": "slides/quarto-example.html#code-block",
    "href": "slides/quarto-example.html#code-block",
    "title": "Hello, Quarto",
    "section": "7 Code block",
    "text": "7 Code block\nQuarto also supports code blocks, making it easy to include and execute code within your document. Here’s an example of a code block to create a simple plot using R:\n\nx &lt;- c(1, 2, 3, 4, 5)\ny &lt;- c(1, 4, 9, 16, 25)\n\nplot(x, y, type = \"o\", col = \"blue\", main = \"Simple plot\", xlab = \"x\", ylab = \"y\")"
  },
  {
    "objectID": "slides/quarto-example.html#footnotes",
    "href": "slides/quarto-example.html#footnotes",
    "title": "Hello, Quarto",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nThis is an example footnote.↩︎"
  },
  {
    "objectID": "slides/gtsummary.html",
    "href": "slides/gtsummary.html",
    "title": "Reproducible tables",
    "section": "",
    "text": "Intro to Quarto"
  },
  {
    "objectID": "slides/gtsummary.html#dataset",
    "href": "slides/gtsummary.html#dataset",
    "title": "Reproducible tables",
    "section": "Dataset",
    "text": "Dataset\n\nlibrary(gtsummary)\nlibrary(tidyverse)\n\ndf &lt;- readRDS(\"../data/simulated_covid.rds\")\n\nFirst, let’s take a look at the data:\n\nhead(df)\n\n  id  case_name case_type sex age date_onset date_admission   outcome\n1  1 jCQH5RSlVq confirmed   m  22 2023-01-01           &lt;NA&gt; recovered\n2  2 AdCD3im7sn  probable   m  21 2023-01-08           &lt;NA&gt; recovered\n3  3 iDzmfZhFkV  probable   m  21 2023-01-03           &lt;NA&gt; recovered\n4  4 sKipHJsjZ2  probable   m  10 2023-01-10           &lt;NA&gt;      died\n5  5 xG7GvAjlBf suspected   m  24 2023-01-05           &lt;NA&gt; recovered\n6  7 ZWWcBMLzoH confirmed   m  10 2023-01-04           &lt;NA&gt; recovered\n  date_outcome date_first_contact date_last_contact   district     outbreak\n1         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;   Tan Binh 1st outbreak\n2         &lt;NA&gt;         2022-12-31        2023-01-04    Tan Phu 1st outbreak\n3         &lt;NA&gt;         2022-12-29        2023-01-05   Binh Tan 1st outbreak\n4   2023-01-27         2023-01-10        2023-01-13    Quan 10 1st outbreak\n5         &lt;NA&gt;         2023-01-07        2023-01-07    Quan 12 1st outbreak\n6         &lt;NA&gt;         2023-01-06        2023-01-07 Binh Thanh 1st outbreak\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nIs this data tidy?\n\n\nThe dataset is a line list, where each row represents a case with details such as sex, age, and outcome. This outbreak is interesting for its two distinct peaks. After a slight decrease in case counts in July, the numbers rose again.\n\n\nCode\ndf %&gt;% \n  count(date_onset) %&gt;% \n  ggplot(\n    aes(\n      x = date_onset, y = n, \n      text = paste0(\"Ngày: \", date_onset, \"\\n\", \"Số ca: \", n)\n      )\n    ) + \n  geom_bar(stat = \"identity\", fill = \"cornflowerblue\") + \n  labs(x = \"Date of onset\", y = \"Case count\") +\n  theme_classic()"
  },
  {
    "objectID": "slides/gtsummary.html#descriptive-tables",
    "href": "slides/gtsummary.html#descriptive-tables",
    "title": "Reproducible tables",
    "section": "Descriptive tables",
    "text": "Descriptive tables\nAt the start of any analysis, it’s common to present a demographic table that summarises the characteristics of our sample. This can be done easily using tbl_summary() from the gtsummary package:\n\ndf %&gt;% \n  tbl_summary(\n    include = c(sex, age, outcome, outbreak)\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 2,7621\n\n\n\n\nsex\n\n\n\n\n    f\n1,365 (49%)\n\n\n    m\n1,397 (51%)\n\n\nage\n15 (8, 22)\n\n\noutcome\n\n\n\n\n    died\n220 (8.0%)\n\n\n    recovered\n2,542 (92%)\n\n\noutbreak\n\n\n\n\n    1st outbreak\n1,513 (55%)\n\n\n    2nd outbreak\n1,249 (45%)\n\n\n\n1 n (%); Median (Q1, Q3)\n\n\n\n\n\n\n\n\nThe variable labels and values in your table might not appear as expected. Let’s fix this, starting with the labels:\n\ndf %&gt;%\n  tbl_summary(\n    include = c(sex, age, outcome, outbreak),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\", outbreak ~ \"Outbreak\")\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 2,7621\n\n\n\n\nSex\n\n\n\n\n    f\n1,365 (49%)\n\n\n    m\n1,397 (51%)\n\n\nAge (years)\n15 (8, 22)\n\n\nOutcome\n\n\n\n\n    died\n220 (8.0%)\n\n\n    recovered\n2,542 (92%)\n\n\nOutbreak\n\n\n\n\n    1st outbreak\n1,513 (55%)\n\n\n    2nd outbreak\n1,249 (45%)\n\n\n\n1 n (%); Median (Q1, Q3)\n\n\n\n\n\n\n\n\nNow, let’s correct the values:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    include = c(sex, age, outcome, outbreak),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\", outbreak ~ \"Outbreak\")\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 2,7621\n\n\n\n\nSex\n\n\n\n\n    Female\n1,365 (49%)\n\n\n    Male\n1,397 (51%)\n\n\nAge (years)\n15 (8, 22)\n\n\nOutcome\n\n\n\n\n    Died\n220 (8.0%)\n\n\n    Recovered\n2,542 (92%)\n\n\nOutbreak\n\n\n\n\n    1st outbreak\n1,513 (55%)\n\n\n    2nd outbreak\n1,249 (45%)\n\n\n\n1 n (%); Median (Q1, Q3)\n\n\n\n\n\n\n\n\nIt looks pretty good now, but your supervisor mentioned that the number of decimals in your tables should be consistent. For example, percentages and continuous variables should both have one decimal place. Let’s fix that:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    include = c(sex, age, outcome, outbreak),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\", outbreak ~ \"Outbreak\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1)\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 2,7621\n\n\n\n\nSex\n\n\n\n\n    Female\n1,365 (49.4%)\n\n\n    Male\n1,397 (50.6%)\n\n\nAge (years)\n15.0 (8.0, 22.0)\n\n\nOutcome\n\n\n\n\n    Died\n220 (8.0%)\n\n\n    Recovered\n2,542 (92.0%)\n\n\nOutbreak\n\n\n\n\n    1st outbreak\n1,513 (54.8%)\n\n\n    2nd outbreak\n1,249 (45.2%)\n\n\n\n1 n (%); Median (Q1, Q3)\n\n\n\n\n\n\n\n\nOkay, now the Age is displayed as the median with the quantile range, but your supervisor prefers it to be shown as the mean \\(\\pm\\) standard deviation. Let’s change it:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    include = c(sex, age, outcome, outbreak),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\", outbreak ~ \"Outbreak\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(\n      all_continuous() ~ \"{mean} \\u00b1 {sd}\"\n    )\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 2,7621\n\n\n\n\nSex\n\n\n\n\n    Female\n1,365 (49.4%)\n\n\n    Male\n1,397 (50.6%)\n\n\nAge (years)\n15.5 ± 9.1\n\n\nOutcome\n\n\n\n\n    Died\n220 (8.0%)\n\n\n    Recovered\n2,542 (92.0%)\n\n\nOutbreak\n\n\n\n\n    1st outbreak\n1,513 (54.8%)\n\n\n    2nd outbreak\n1,249 (45.2%)\n\n\n\n1 n (%); Mean ± SD\n\n\n\n\n\n\n\n\nExtra tip for Vietnamese theses: Change the decimal mark from . to ,.\n\ntheme_gtsummary_language(language = \"en\", big.mark = \".\", decimal.mark = \",\")\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    include = c(sex, age, outcome, outbreak),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\", outbreak ~ \"Outbreak\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(\n      all_continuous() ~ \"{mean} \\u00b1 {sd}\"\n    )\n  )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 2.7621\n\n\n\n\nSex\n\n\n\n\n    Female\n1.365 (49,4%)\n\n\n    Male\n1.397 (50,6%)\n\n\nAge (years)\n15,5 ± 9,1\n\n\nOutcome\n\n\n\n\n    Died\n220 (8,0%)\n\n\n    Recovered\n2.542 (92,0%)\n\n\nOutbreak\n\n\n\n\n    1st outbreak\n1.513 (54,8%)\n\n\n    2nd outbreak\n1.249 (45,2%)\n\n\n\n1 n (%); Mean ± SD"
  },
  {
    "objectID": "slides/gtsummary.html#statistical-inference",
    "href": "slides/gtsummary.html#statistical-inference",
    "title": "Reproducible tables",
    "section": "Statistical inference",
    "text": "Statistical inference\nThe most common goal is to compare two groups and make inferences. In gtsummary, you can do this by simply copying the code for the descriptive table and adding the by = group_variable argument. Just remember to remove the group_variable from include if you included it in the descriptive table.\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    by = outbreak,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(\n      all_continuous() ~ \"{mean} \\u00b1 {sd}\"\n    )\n  )\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n1st outbreak N = 1,5131\n2nd outbreak N = 1,2491\n\n\n\n\nSex\n\n\n\n\n\n\n    Female\n746 (49.3%)\n619 (49.6%)\n\n\n    Male\n767 (50.7%)\n630 (50.4%)\n\n\nAge (years)\n12.8 ± 7.6\n18.8 ± 9.6\n\n\nOutcome\n\n\n\n\n\n\n    Died\n110 (7.3%)\n110 (8.8%)\n\n\n    Recovered\n1,403 (92.7%)\n1,139 (91.2%)\n\n\n\n1 n (%); Mean ± SD\n\n\n\n\n\n\n\n\nLook good now! You probably need p-values. Add them using the add_p() function.\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    by = outbreak,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(\n      all_continuous() ~ \"{mean} \\u00b1 {sd}\"\n    )\n  ) %&gt;% \n  add_p()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n1st outbreak N = 1,5131\n2nd outbreak N = 1,2491\np-value2\n\n\n\n\nSex\n\n\n\n\n0.9\n\n\n    Female\n746 (49.3%)\n619 (49.6%)\n\n\n\n\n    Male\n767 (50.7%)\n630 (50.4%)\n\n\n\n\nAge (years)\n12.8 ± 7.6\n18.8 ± 9.6\n&lt;0.001\n\n\nOutcome\n\n\n\n\n0.14\n\n\n    Died\n110 (7.3%)\n110 (8.8%)\n\n\n\n\n    Recovered\n1,403 (92.7%)\n1,139 (91.2%)\n\n\n\n\n\n1 n (%); Mean ± SD\n\n\n2 Pearson’s Chi-squared test; Wilcoxon rank sum test\n\n\n\n\n\n\n\n\nAgain, your supervisor wants p-values displayed with three decimal digits. Let do it:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    by = outbreak,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(all_continuous() ~ \"{mean} \\u00b1 {sd}\")\n  ) %&gt;%\n  add_p(\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3)\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n1st outbreak N = 1,5131\n2nd outbreak N = 1,2491\np-value2\n\n\n\n\nSex\n\n\n\n\n0.894\n\n\n    Female\n746 (49.3%)\n619 (49.6%)\n\n\n\n\n    Male\n767 (50.7%)\n630 (50.4%)\n\n\n\n\nAge (years)\n12.8 ± 7.6\n18.8 ± 9.6\n&lt;0.001\n\n\nOutcome\n\n\n\n\n0.138\n\n\n    Died\n110 (7.3%)\n110 (8.8%)\n\n\n\n\n    Recovered\n1,403 (92.7%)\n1,139 (91.2%)\n\n\n\n\n\n1 n (%); Mean ± SD\n\n\n2 Pearson’s Chi-squared test; Wilcoxon rank sum test\n\n\n\n\n\n\n\n\nYou discovered that the default test is the Wilcoxon test, but now you want to use the t-test for age. Specify it in add_p() like this:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    by = outbreak,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(all_continuous() ~ \"{mean} \\u00b1 {sd}\")\n  ) %&gt;%\n  add_p(\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3),\n    test = list(age ~ \"t.test\")\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n1st outbreak N = 1,5131\n2nd outbreak N = 1,2491\np-value2\n\n\n\n\nSex\n\n\n\n\n0.894\n\n\n    Female\n746 (49.3%)\n619 (49.6%)\n\n\n\n\n    Male\n767 (50.7%)\n630 (50.4%)\n\n\n\n\nAge (years)\n12.8 ± 7.6\n18.8 ± 9.6\n&lt;0.001\n\n\nOutcome\n\n\n\n\n0.138\n\n\n    Died\n110 (7.3%)\n110 (8.8%)\n\n\n\n\n    Recovered\n1,403 (92.7%)\n1,139 (91.2%)\n\n\n\n\n\n1 n (%); Mean ± SD\n\n\n2 Pearson’s Chi-squared test; Welch Two Sample t-test\n\n\n\n\n\n\n\n\nWe’re nearly there. Your supervisor (yet again) wants an overall column. Simply add it using add_overall():\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    by = outbreak,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(all_continuous() ~ \"{mean} \\u00b1 {sd}\")\n  ) %&gt;%\n  add_p(\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3),\n    test = list(age ~ \"t.test\")\n  ) %&gt;% \n  add_overall()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOverall N = 2,7621\n1st outbreak N = 1,5131\n2nd outbreak N = 1,2491\np-value2\n\n\n\n\nSex\n\n\n\n\n\n\n0.894\n\n\n    Female\n1,365 (49.4%)\n746 (49.3%)\n619 (49.6%)\n\n\n\n\n    Male\n1,397 (50.6%)\n767 (50.7%)\n630 (50.4%)\n\n\n\n\nAge (years)\n15.5 ± 9.1\n12.8 ± 7.6\n18.8 ± 9.6\n&lt;0.001\n\n\nOutcome\n\n\n\n\n\n\n0.138\n\n\n    Died\n220 (8.0%)\n110 (7.3%)\n110 (8.8%)\n\n\n\n\n    Recovered\n2,542 (92.0%)\n1,403 (92.7%)\n1,139 (91.2%)\n\n\n\n\n\n1 n (%); Mean ± SD\n\n\n2 Pearson’s Chi-squared test; Welch Two Sample t-test\n\n\n\n\n\n\n\n\nGreat! Finally, we usually highlight small p-values to guide readers to the exciting findings. Just use bold_p() and set the threshold you want:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_summary(\n    by = outbreak,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    digits = c(all_categorical() ~ c(0, 1), all_continuous() ~ 1),\n    statistic = list(all_continuous() ~ \"{mean} \\u00b1 {sd}\")\n  ) %&gt;%\n  add_p(\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3),\n    test = list(age ~ \"t.test\")\n  ) %&gt;%\n  add_overall() %&gt;%\n  bold_p(t = 0.05)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOverall N = 2,7621\n1st outbreak N = 1,5131\n2nd outbreak N = 1,2491\np-value2\n\n\n\n\nSex\n\n\n\n\n\n\n0.894\n\n\n    Female\n1,365 (49.4%)\n746 (49.3%)\n619 (49.6%)\n\n\n\n\n    Male\n1,397 (50.6%)\n767 (50.7%)\n630 (50.4%)\n\n\n\n\nAge (years)\n15.5 ± 9.1\n12.8 ± 7.6\n18.8 ± 9.6\n&lt;0.001\n\n\nOutcome\n\n\n\n\n\n\n0.138\n\n\n    Died\n220 (8.0%)\n110 (7.3%)\n110 (8.8%)\n\n\n\n\n    Recovered\n2,542 (92.0%)\n1,403 (92.7%)\n1,139 (91.2%)\n\n\n\n\n\n1 n (%); Mean ± SD\n\n\n2 Pearson’s Chi-squared test; Welch Two Sample t-test"
  },
  {
    "objectID": "slides/gtsummary.html#univariate-analysis",
    "href": "slides/gtsummary.html#univariate-analysis",
    "title": "Reproducible tables",
    "section": "Univariate analysis",
    "text": "Univariate analysis\nThe next step in a typical analysis is to perform a univariate analysis and calculate the odds ratio (OR) for each variable:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_uvregression(\n    method = glm,\n    y = outbreak,\n    method.args = list(family = binomial),\n    exponentiate = TRUE,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3)\n  ) %&gt;%\n  bold_p(t = 0.05)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN\nOR1\n95% CI1\np-value\n\n\n\n\nSex\n2,762\n\n\n\n\n\n\n\n\n    Female\n\n\n—\n—\n\n\n\n\n    Male\n\n\n0.99\n0.85 – 1.15\n0.894\n\n\nAge (years)\n2,762\n1.08\n1.07 – 1.09\n&lt;0.001\n\n\nOutcome\n2,762\n\n\n\n\n\n\n\n\n    Died\n\n\n—\n—\n\n\n\n\n    Recovered\n\n\n0.81\n0.62 – 1.07\n0.138\n\n\n\n1 OR = Odds Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\nIf you want to hide the sample size, add hide_n = TRUE:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  tbl_uvregression(\n    method = glm,\n    y = outbreak,\n    method.args = list(family = binomial),\n    exponentiate = TRUE,\n    hide_n = TRUE,\n    include = c(sex, age, outcome),\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3)\n  ) %&gt;%\n  bold_p(t = 0.05)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOR1\n95% CI1\np-value\n\n\n\n\nSex\n\n\n\n\n\n\n\n\n    Female\n—\n—\n\n\n\n\n    Male\n0.99\n0.85 – 1.15\n0.894\n\n\nAge (years)\n1.08\n1.07 – 1.09\n&lt;0.001\n\n\nOutcome\n\n\n\n\n\n\n\n\n    Died\n—\n—\n\n\n\n\n    Recovered\n0.81\n0.62 – 1.07\n0.138\n\n\n\n1 OR = Odds Ratio, CI = Confidence Interval"
  },
  {
    "objectID": "slides/gtsummary.html#multivariate-analysis",
    "href": "slides/gtsummary.html#multivariate-analysis",
    "title": "Reproducible tables",
    "section": "Multivariate analysis",
    "text": "Multivariate analysis\nFinally, you might want to run a multivariate analysis to adjust these OR values for confounders:\n\ndf %&gt;%\n  mutate(sex = factor(\n    sex,\n    levels = c(\"f\", \"m\"),\n    labels = c(\"Female\", \"Male\")\n  ),\n  outcome = str_to_sentence(outcome)) %&gt;%\n  glm(outbreak ~ sex + age + outcome, data = ., family = binomial) %&gt;%\n  tbl_regression(\n    exponentiate = TRUE,\n    label = list(sex ~ \"Sex\", age ~ \"Age (years)\", outcome ~ \"Outcome\"),\n    pvalue_fun = function(x)\n      style_pvalue(x, digits = 3)\n  ) %&gt;% \n  bold_p(t = 0.05)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOR1\n95% CI1\np-value\n\n\n\n\nSex\n\n\n\n\n\n\n\n\n    Female\n—\n—\n\n\n\n\n    Male\n0.98\n0.84 – 1.15\n0.824\n\n\nAge (years)\n1.08\n1.07 – 1.09\n&lt;0.001\n\n\nOutcome\n\n\n\n\n\n\n\n\n    Died\n—\n—\n\n\n\n\n    Recovered\n0.85\n0.63 – 1.13\n0.265\n\n\n\n1 OR = Odds Ratio, CI = Confidence Interval"
  },
  {
    "objectID": "slides/capstone.html",
    "href": "slides/capstone.html",
    "title": "Capstone Exercise: Applying Lessons in a Mini-Project",
    "section": "",
    "text": "Get capstone project\n\n\n\nOn Github Desktop\n\nCloned R-cafe repository\nCreated your own branch on the repository\nCheckout your own branch\n\n\n\n\n\n\n\n\n\nAnswer script\n\n\n\nYou are expected to save your answer under R-cafe/capstone_exercises/capstone.R\n\n\n\n\n\n\n\n\nVariations in answers\n\n\n\nIt is expected that the exercise answers will vary, and any result that fulfills the objectives will be acceptable.\n\n\n\n\n\n\n\n\nSamples\n\n\n\nThe samples are provided in samples folder to illustrate what might be included in the results; you may add other elements or make changes based on your experience and needs."
  },
  {
    "objectID": "slides/capstone.html#notes-and-instructions",
    "href": "slides/capstone.html#notes-and-instructions",
    "title": "Capstone Exercise: Applying Lessons in a Mini-Project",
    "section": "",
    "text": "Get capstone project\n\n\n\nOn Github Desktop\n\nCloned R-cafe repository\nCreated your own branch on the repository\nCheckout your own branch\n\n\n\n\n\n\n\n\n\nAnswer script\n\n\n\nYou are expected to save your answer under R-cafe/capstone_exercises/capstone.R\n\n\n\n\n\n\n\n\nVariations in answers\n\n\n\nIt is expected that the exercise answers will vary, and any result that fulfills the objectives will be acceptable.\n\n\n\n\n\n\n\n\nSamples\n\n\n\nThe samples are provided in samples folder to illustrate what might be included in the results; you may add other elements or make changes based on your experience and needs."
  },
  {
    "objectID": "slides/capstone.html#a.-data-and-files",
    "href": "slides/capstone.html#a.-data-and-files",
    "title": "Capstone Exercise: Applying Lessons in a Mini-Project",
    "section": "A. Data and Files",
    "text": "A. Data and Files\nThis project uses real clinical trial data from OUCRU. The data includes:\n\nMain Dataset:\n\nFile: 2-10-2020-_03TS_V1_Data.xls\nContains most information. Variable explanations are in the statistical plan file (03TS analysis plan V1.5 November 2020 Accept changes.docx).\n\nTreatment Allocation:\n\nFile: 03TS_Randlist.xlsx\nIncludes treatment arm allocations and a dictionary sheet explaining the four arms.\n\nViolations, Exclusions, Withdrawals:\n\nFile: Protocol violations, exclusions, withdrawals.xlsx\nAny ids listed in the files will be excluded accordingly.\n\nAdverse events:\n\nFile: AE.SAE DATA SHEET.xls\nIncludes adverse events information.\n\nStatistical Plan:\n\nFile: 03TS analysis plan V1.5 November 2020 Accept changes.docx\nProvides guidance on specific variables. Read this for more details to fulfill your objectives."
  },
  {
    "objectID": "slides/capstone.html#b.-objectives",
    "href": "slides/capstone.html#b.-objectives",
    "title": "Capstone Exercise: Applying Lessons in a Mini-Project",
    "section": "B. Objectives",
    "text": "B. Objectives\n\nI. Data Preparation\nPrepare data for the following populations:\n\nIT-ITT, IM_ITT, IT_PP, IM_PP, IM_ALL.\nUse 03TS_Randlist.xlsx for allocation of the first 272 participants.\nUse Protocol violations, exclusions, withdrawals.xlsx for filtering data per population.\n\n\n\nII. Table Creation\n\n1. Baseline Characteristics:\nSummarize as follows:\n\nNumeric Data: Report median, 1st/3rd quartiles, lowest, and highest values.\nCategorical Data: Report count (n) and percentage (%).\nNo formal statistical comparisons between study arms.\n\nCharacteristics to summarize:\n\nPatient Details:\n\nSex, age, BMI (BMI = ADM.WEIGHT / (ADM.HEIGHT)^2).\n\nPast Medical History:\n\nVariables like ADM.HYPERTENSION, ADM.MYOCARDIALINFART, ADM.SEVERELIVER, etc.\n\nPatient History:\n\nDuration of illness, incubation period, respiratory rate, platelet count, etc.\n\nSpecific Severity Scores:\n\nTetanus Severity, SOFA, APACHE II (calculated from variables).\n\n\n\n\n2. Adverse Events (AE):\nSummarize proportions of individuals with AEs, categorized by grade (I-IV) and relation to treatment.\n\nExclude specific events (e.g., “Nasogastric tube”, “Tracheostomy”).\nUse chi-square or Fisher’s exact test for comparisons.\nSevere adverse events are summarized separately for each population.\n\n\n\n\nIII. Plots\n\n1. Create plots for:\n\nPipecuronium:\n\nTotal dose during hospital stay (ventilated patients).\nDuration of use (ventilated patients).\n\nDiazepam:\n\nTotal dose during hospital stay.\n\nMidazolam:\n\nTotal dose during hospital stay.\n\nBenzodiazepines:\n\nTotal dose as diazepam equivalent.\nTotal duration of use.\n\n\n\n\n\n\n\n\nTip: ggplot2, gridExtra\n\n\n\n\n\n\nggplot2 is a powerful package for creating plots, offering many functions that support various features. For example, it can create violin plots (geom_violin), boxplots (geom_boxplot), histograms (geom_histogram with the binwidth argument to adjust the bins), scatter plots (geom_point), and use geom_segment to display the mean and confidence intervals.\ngridExtra is a package used to arrange multiple plots in a single figure. Try using grid.arrange, or you may opt for another package that serves the same function.\n\n\n\n\n\n\n2. Create line plot for:\nCreate a line plot of the daily maximum temperature for each patient during the first 7 days after admission. Use one colour for each treatment arm and make the mean temperature for each day bold for each patient. Sample is not provided for this exercise.\n\n\n\n\n\n\nTip: Line plot\n\n\n\n\n\n\nCompute Mean: Use dplyr::group_by() and summarize() to calculate the mean temperature for each day and treatment arm.\nPlot Individual Lines: Use geom_line() with aes(group = usubjid) for individual patient data.\nAdd Bold Line for Mean: Use a second geom_line() with the computed mean data and adjust the size parameter for a bold line."
  },
  {
    "objectID": "additional_handouts/day_1/Rproject_renv/Rproject.html",
    "href": "additional_handouts/day_1/Rproject_renv/Rproject.html",
    "title": "Rproject setup",
    "section": "",
    "text": "1 Steps to setup Rproject\n\nOpen Rstudio\nIn the menu, File -&gt; New project...\n\n\n\n\nCreate New project\n\n\n\nChoose Existing Directory.\n\n\n\n\nExisting Directory\n\n\n\nCreate project at prefered directory\n\nClick Browse and select your project directory\nThen click Create project\n\n\n\n\n\nSelect the directory\n\n\n\nCheck your Rproject\n\nYour Rproject will be at your directory\n\n\n\n\n\nRproject"
  },
  {
    "objectID": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html",
    "href": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html",
    "title": "Commit, push and create issue",
    "section": "",
    "text": "Open Rstudio\nIn the menu, File -&gt; New File -&gt; R script\n\n\n\n\nCreate New R script\n\n\n\n\n\n\nType your work in Source code section -&gt; click on save icon or Ctrl + S\n\n\n\n\nWrite down your work\n\n\n\n\n\n\nClick Browse and select your project directory\nName your file in File name -&gt; click save\n\n\n\n\nSelect the directory\n\n\n\n\n\n\n\n\n\nOpen Github desktop.\nTick files which you would like to commit in the Changes section. You could view what changes has been made to any file by clicking on each file. The changes will appear on the right.\nFill in the summary of your commit in the Summary required. Add more details in the Description.\nClick on Commit to [your branch]. Always check whether you commit to correct branch.\n\n\n\n\nSelect files, add summary, description\n\n\n\n\n\n\nDouble check if your Current branch is correct. Now, click on Push origin to push to your branch.\n\n\n\n\nPush to your branch\n\n\n\n\n\n\nSelect your branch on Github\nYou will see a notification of your push from local repository\nShow you how many commit you ahead of or behind main\nYou can compare your branch with other branch or main and make pull request. You could ignore this for now.\nClick on day1 to view our example_commit_push_issue.R script\n\n\n\n\nView our push on Github branch\n\n\n\nView our example_commit_push_issue.R\n\n\n\n\nView our script on Github branch"
  },
  {
    "objectID": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#working-on-local-repository",
    "href": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#working-on-local-repository",
    "title": "Commit, push and create issue",
    "section": "",
    "text": "Open Rstudio\nIn the menu, File -&gt; New File -&gt; R script\n\n\n\n\nCreate New R script\n\n\n\n\n\n\nType your work in Source code section -&gt; click on save icon or Ctrl + S\n\n\n\n\nWrite down your work\n\n\n\n\n\n\nClick Browse and select your project directory\nName your file in File name -&gt; click save\n\n\n\n\nSelect the directory"
  },
  {
    "objectID": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#commit-and-push-your-work",
    "href": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#commit-and-push-your-work",
    "title": "Commit, push and create issue",
    "section": "",
    "text": "Open Github desktop.\nTick files which you would like to commit in the Changes section. You could view what changes has been made to any file by clicking on each file. The changes will appear on the right.\nFill in the summary of your commit in the Summary required. Add more details in the Description.\nClick on Commit to [your branch]. Always check whether you commit to correct branch.\n\n\n\n\nSelect files, add summary, description\n\n\n\n\n\n\nDouble check if your Current branch is correct. Now, click on Push origin to push to your branch.\n\n\n\n\nPush to your branch\n\n\n\n\n\n\nSelect your branch on Github\nYou will see a notification of your push from local repository\nShow you how many commit you ahead of or behind main\nYou can compare your branch with other branch or main and make pull request. You could ignore this for now.\nClick on day1 to view our example_commit_push_issue.R script\n\n\n\n\nView our push on Github branch\n\n\n\nView our example_commit_push_issue.R\n\n\n\n\nView our script on Github branch"
  },
  {
    "objectID": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#create-an-issue-on-github",
    "href": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#create-an-issue-on-github",
    "title": "Commit, push and create issue",
    "section": "2.1 Create an issue on Github",
    "text": "2.1 Create an issue on Github\n\n2.1.1 Select the reference in new issue\n\nClick on the number of the line in the code\nClick ... -&gt; select Reference in new issue\n\n\n\n\nSelect the place where you want to refer to\n\n\n\n\n2.1.2 Put more information to your issue and submit issue\n\nFill in the title in Add a title\nThe link to the error place will automatically appear in Add a description. You might write more detail about the errors in this section as below\nSelect the person you would like assign this issue by select Assignees or quickly assign it to yourself by assign yourself\nClassify the issue by Labels\nClick Submit new issue\n\n\n\n\nAdd information and submit issue\n\n\n\n\n2.1.3 View the open issues\n\nSelect Issues -&gt; Open. You might see the one who is responsible for this issue in Assignee tab.\nSelect the issue you would like to view Typo in example_push_commit_issue.R file.\n\n\n\n\nView the open issue\n\n\n\n\n2.1.4 View the detail of an issue\n\nYou might see the title of the issue, the reference links to the errors, and the detail of the issue.\nNavigate the place of error by clicking the reference link\n\n\n\n\nView the details of issue"
  },
  {
    "objectID": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#resolve-the-issue",
    "href": "additional_handouts/day_1/commit, push and create issue on github/commit_push_issue.html#resolve-the-issue",
    "title": "Commit, push and create issue",
    "section": "2.2 Resolve the issue",
    "text": "2.2 Resolve the issue\n\n2.2.1 Clone the branch you would like to fix the issue\n\nRefer to Steps to Clone a Repository on Github in Github note 1\n\n\n\n2.2.2 Fix the code locally\n\nOpen the example_push_commit_issue.R file\n\nMake correction to the code and make a comment.\n\n\n\n\nResolve issue in local cloned repository\n\n\n\n\n2.2.3 Commit the corrections using Github desktop\n\nOpen the Github desktop. You will see the changes now. The red lines are old version. The green lines are current version.\nCommit and push the corrections\n\n\n\n\nCommit and push the correction\n\n\n\n\n2.2.4 Check the branch again\n\n\n\nView the code on github\n\n\n\n\n2.2.5 Comment and close the issue\n\nGo back to the issue. Select Issues -&gt; Open -&gt; Typo in example_push_commit_issue.R file\nAdd comments in Add a comment -&gt; Click on Close with comment. (If the issue has not been resolved, we can click Comment to discuss with other collaborators)\n\n\n\n\nClose and comment issue on Github\n\n\n\n\n2.2.6 View closed issue\n\nWe can always view the old closed issue by clicking Issues -&gt; Closed\n\n\n\n\nView the closed issues on github"
  },
  {
    "objectID": "additional_handouts/day_1/Clone and push github/Clone a repository from Github.html",
    "href": "additional_handouts/day_1/Clone and push github/Clone a repository from Github.html",
    "title": "Github note 1",
    "section": "",
    "text": "1 Steps to Clone a Repository on GitHub\n\nVisit the GitHub repository you would like to clone\nFor example: https://github.com/OUCRU-Modelling/R-cafe.\nClick on Code → select HTTPS → copy the link in the URL.\n\n\n\n\nCopy the repository link\n\n\n\nOpen GitHub Desktop\nThen choose File → Clone repository.\n\n\n\n\nOpen cloning tab\n\n\n\nChoose URL\n\nPaste the copied link into the blank field below “Hub/cool-repo”.\n\nChange the local path to your preferred directory (or it will use the default directory).\n\nClick Clone.\n\n\n\n\n\nPaste the link\n\n\n\nVerify\nCheck if the repository has been cloned to the correct location.\n\n\n\n\nCheck local repository\n\n\n\n\n2 Steps to create a new branch\n\nCreate new branch\n\nClick on Current branch (main) -&gt; choose New branch\n\n\n\n\n\nCreate new branch\n\n\n\nName the new branch\n\nFill in the branch name (For example: “hungtt”) -&gt; choose Create branch\n\n\n\n\n\nName the new branch\n\n\n\nPublish your branch\n\nClick on Publish branch\n\n\n\n\n\nPublish branch\n\n\n\nCheck your branch on Github\n\nClick on main. You might see your branch name. If not, choose View all branches to find your branch.\n\n\n\n\n\nFind your branch"
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html",
    "href": "additional_handouts/day_1/outline/outline.html",
    "title": "Outline day 1",
    "section": "",
    "text": "Difference between Git and GitHub.\nWhy version control is important for collaboration.\nHands-on: Creating and cloning repositories.\n\n\n\n\n\nOverview of RStudio projects.\nBenefits of using a project environment.\nSetting up your first R project."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#git-vs-github",
    "href": "additional_handouts/day_1/outline/outline.html#git-vs-github",
    "title": "Outline day 1",
    "section": "",
    "text": "Difference between Git and GitHub.\nWhy version control is important for collaboration.\nHands-on: Creating and cloning repositories."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#rproject-project-environment",
    "href": "additional_handouts/day_1/outline/outline.html#rproject-project-environment",
    "title": "Outline day 1",
    "section": "",
    "text": "Overview of RStudio projects.\nBenefits of using a project environment.\nSetting up your first R project."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#rscript",
    "href": "additional_handouts/day_1/outline/outline.html#rscript",
    "title": "Outline day 1",
    "section": "2.1 Rscript",
    "text": "2.1 Rscript\n\nWhat is an R script?\nHow to create and run scripts in RStudio."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#variableclassesspecial-values",
    "href": "additional_handouts/day_1/outline/outline.html#variableclassesspecial-values",
    "title": "Outline day 1",
    "section": "2.2 Variable/Classes/Special Values",
    "text": "2.2 Variable/Classes/Special Values\n\nVariables and data types (numeric, character, logical, etc.).\nSpecial values (e.g., NA, NaN, Inf, NULL)."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#functions",
    "href": "additional_handouts/day_1/outline/outline.html#functions",
    "title": "Outline day 1",
    "section": "2.3 Functions",
    "text": "2.3 Functions\n\nCreating and using functions.\nBuilt-in vs custom functions."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#scope",
    "href": "additional_handouts/day_1/outline/outline.html#scope",
    "title": "Outline day 1",
    "section": "2.4 Scope",
    "text": "2.4 Scope\n\nLocal vs global scope.\nThe environment in R."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#packages",
    "href": "additional_handouts/day_1/outline/outline.html#packages",
    "title": "Outline day 1",
    "section": "2.5 Packages",
    "text": "2.5 Packages\n\nInstalling and loading packages.\nExploring CRAN, Bioconductor, and GitHub."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#data-importexport",
    "href": "additional_handouts/day_1/outline/outline.html#data-importexport",
    "title": "Outline day 1",
    "section": "4.1 Data Import/Export",
    "text": "4.1 Data Import/Export\n\nReading data from CSV, Excel, and other formats.\nWriting data to files."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#clean-column-names",
    "href": "additional_handouts/day_1/outline/outline.html#clean-column-names",
    "title": "Outline day 1",
    "section": "4.2 Clean Column Names",
    "text": "4.2 Clean Column Names\n\nStandardizing column names using janitor::clean_names()."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#simple-data-extraction",
    "href": "additional_handouts/day_1/outline/outline.html#simple-data-extraction",
    "title": "Outline day 1",
    "section": "4.3 Simple Data Extraction",
    "text": "4.3 Simple Data Extraction\n\nSelecting rows and columns."
  },
  {
    "objectID": "additional_handouts/day_1/outline/outline.html#data-summary",
    "href": "additional_handouts/day_1/outline/outline.html#data-summary",
    "title": "Outline day 1",
    "section": "4.4 Data Summary",
    "text": "4.4 Data Summary\n\nSummarizing data with summary and skim."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to R Café",
    "section": "",
    "text": "3 weeks of study + 1 week of extra content (if any) and closing remarks"
  },
  {
    "objectID": "index.html#duration",
    "href": "index.html#duration",
    "title": "Welcome to R Café",
    "section": "",
    "text": "3 weeks of study + 1 week of extra content (if any) and closing remarks"
  },
  {
    "objectID": "index.html#structure",
    "href": "index.html#structure",
    "title": "Welcome to R Café",
    "section": "Structure",
    "text": "Structure\n\n3-hour face-to-face sessions per day, 1 day per week\nTake home exercises given between face-to-face sessions"
  },
  {
    "objectID": "index.html#r-café-helpful-shortcuts",
    "href": "index.html#r-café-helpful-shortcuts",
    "title": "Welcome to R Café",
    "section": "R Café helpful shortcuts",
    "text": "R Café helpful shortcuts\n\nTeams Tech support channel\nMain GitHub repository\nTheoretical slides\nAdditional handouts and instructions\nCurrent instructor roster:\n\nThinh Ong Phuc (thinhop@oucru.org)\nAnh Phan Truong Quynh (anhptq@oucru.org)\nHung Tran Thai (hungtt@oucru.org)\nTuyen Huynh (tuyenhn@oucru.org)\nHai Ho Bich (haihb@oucru.org)"
  },
  {
    "objectID": "index.html#agenda",
    "href": "index.html#agenda",
    "title": "Welcome to R Café",
    "section": "Agenda",
    "text": "Agenda\n\nGetting started with R and Git (day 1)\n\nPart 1: Setup (45’) - Tuyen & QA\n\nWhat is R Café & Agenda (5’)\nBrief introduction to Git, GitHub, and GitHub Desktop\n\nGoal: Publish your own branch on R Café’s GitHub repository\n\nRstudio (20’)\n\nGoal: Create RStudio project\nGoal: Everyone create and push their first commit onto their own branch\n\nNavigate GitHub\n\nPart 2: Foundations of R (60’) - QA\n\nVariables & Functions & Packages (with outline)\nExercises\n\nGoal: Create a function and push to GitHub\nGoal: Create issues and comment on each other’s issues on GitHub\n\n\nBreak (15’)\nPart 3: Data manipulation in R (45’) - QA\n\nData management\nTake-home exercises setup\n\n\nR programming with tidyverse (day 2)\n\nInto the tidyverse\n\nWhat is tidyverse?\nWhy should we use it?\nHow do we use it?\nPiping with %&gt;%\n\nExercise\nVectorise R functions\n\nVectors and vectorisation\nVectorisation with map()\ntidyverse style vs. base R style\n\nggplot2 for data visualisation\n\nGrammar of graphics\n\nExercise\n\nQuarto & gtsummary (day 3)\n\nIntro to Quarto\nReproducible tables\n\nDescriptive tables\nStatistical inference\nUnivariate analysis\nMultivariate analysis"
  },
  {
    "objectID": "index.html#take-home-exercises",
    "href": "index.html#take-home-exercises",
    "title": "Welcome to R Café",
    "section": "Take-home exercises",
    "text": "Take-home exercises\n\nInitial Data Analysis - IDA (with skimr)\n\nGenerate questions around your data\nCustomize your summary table output\nSimple visualization data, e.g. histogram\nCalculate statistics, e.g. correlation, collinearity\n\nData transformation\n\nData cleaning and filtering\nData transformation\nFactor your data (with forcats)\nData visualization (with ggplot2)\n\nAnalysis with gtsummary\n\nDemographic summary\nStatistical tests, e.g. t-test, chi-sq, fisher-exact, OR, etc.\n\nGenerate report with Quarto\n\nCitation (inline footnote and reference)"
  },
  {
    "objectID": "index.html#capstone-hint",
    "href": "index.html#capstone-hint",
    "title": "Welcome to R Café",
    "section": "Capstone hint",
    "text": "Capstone hint\n\nCapstone hint 1"
  },
  {
    "objectID": "slides/capstone_hint_1.html",
    "href": "slides/capstone_hint_1.html",
    "title": "Capstone Hint 1",
    "section": "",
    "text": "#load library\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(data.table)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(gtsummary)\nlibrary(Hmisc)\nlibrary(gt)\nlibrary(tidyr)\nlibrary(stats)\n\n\n1. Load data\nImport all the sheets in raw data 2-10-2020-_03TS_V1_Data.xls. Convert “UNKNOWN” value to NA, and “Y”/“N” to standard factorized “yes”/“no” which will be convenient as later gtsummary will automatically detect dichotomous variables.\n\n\nImport raw data\n\n\n# Define file path\ndaily_file_path &lt;- here::here(\"data\", \"2-10-2020-_03TS_V1_Data.xls\")\n\n# Define sheets to import\nsheets &lt;- c(\n  \"ENR\",\n  \"ADM\",\n  \"VENT\",\n  \"VENT_VENTILATION\",\n  \"VENT_TracheSupp\",\n  \"DAILY\",\n  \"DAILY_DAILY\",\n  \"COMP\",\n  \"FU\",\n  \"DAILY_FU\",\n  \"DAILY_FU_GridFU\",\n  \"S_AE\"\n)\n\n# Read and store data in a named list\ndata_list &lt;- lapply(sheets, function(sheet) {\n  df &lt;- read_excel(daily_file_path, sheet = sheet)\n  \n  # Replace \"UNKNOWN\" with NA, convert \"Y\"/\"N\" to \"yes\"/\"no\"\n  df &lt;- df %&gt;%\n    mutate(across(\n      where(is.character),\n      ~ case_when(\n        .x == \"Y\" ~ \"yes\",\n        .x == \"N\" ~ \"no\",\n        .x == \"UNKNOWN\" ~ NA_character_,\n        TRUE ~ .x\n      )\n    )) %&gt;%\n    mutate(across(\n      where( ~ all(.x %in% c(\"yes\", \"no\", NA), na.rm = TRUE)),\n      ~ factor(\n        .x,\n        levels = c(\"no\", \"yes\"),\n        labels = c(0, 1),\n        exclude = NULL\n      )\n    ))  # Ensure both levels exist\n  \n  setNames(df, tolower(names(df)))\n})\n\n# Assign data frames to variables in the global environment\nlist2env(setNames(data_list, tolower(sheets)), envir = .GlobalEnv)\n\n&lt;environment: R_GlobalEnv&gt;\n\n# another method\n# for (sheet in sheets) {\n#   assign(tolower(sheet), read_excel(daily_file_path, sheet = sheet) %&gt;%\n#            setNames(tolower(names(.))))\n# }\n\n\nImport the allocation data of treatment arm 03TS_Randlist.xlsx and recode the values as being stated in the dictionary.\n\n\nImport random allocation data\n\n\nallocation_file_path &lt;- here::here(\"data\", \"03TS_Randlist.xlsx\")\n\n\n# Read and process allocation data\nallocation_data &lt;- read_excel(allocation_file_path, sheet = \"Allocation\") %&gt;%\n  setNames(tolower(names(.)))\n\nrandolist &lt;- allocation_data %&gt;%  filter(row_number() %in% c(1:272)) %&gt;%\n  rename(arm = r.arm) %&gt;%\n  mutate(\n    pat.id = str_replace(pat.id, \".*-\", \"\"),\n    usubjid = paste(\"003\", pat.id, sep = \"-\"),\n    arm = case_when(\n      arm == \"14 ampoules: TETANUS ANTITOXIN (IM) + 2 prefilled-syringes : TETAGAM®P (intrathecal))\" ~ \"equine and intrathecal\",\n      arm == \"14 ampoules: TETANUS ANTITOXIN (IM)\" ~ \"equine and sham\",\n      arm == \"12 prefilled-syringes : TETAGAM®P (IM) + 2 prefilled-syringes : TETAGAM®P (intrathecal))\" ~ \"human and intrathecal\",\n      arm == \"12 prefilled-syringes : TETAGAM®P (IM)\" ~ \"human and sham\"\n    )\n  )\n\n\nImport the inclusion and exclusion data Protocol violations, exclusions, withdrawals.xlsx. Fix the inconsistency in sheet IM ITT which used id instead of usubjid.\n\n\nImport inclusion and exclusion data\n\n\nviolations_file_path &lt;- here::here(\"data\", \"Protocol violations, exclusions, withdrawals.xlsx\")\n\n# Import all sheets from the Protocol violations file\nall_sheets &lt;- excel_sheets(violations_file_path)  # Get sheet names\nviolations_data &lt;- lapply(all_sheets, function(sheet) {\n  data &lt;- read_excel(violations_file_path, sheet = sheet)\n  colnames(data) &lt;- tolower(colnames(data))  # Convert column names to lowercase\n  data\n})\n\nNew names:\n• `` -&gt; `...3`\n\nnames(violations_data) &lt;- all_sheets  # Assign sheet names to the list\n\n\nfor (name in names(violations_data)) {\n  # Modify the name: make lowercase and replace spaces with underscores\n  modified_name &lt;- gsub(\" \", \"_\", tolower(name))\n  \n  # Assign the data frame to the modified name\n  assign(modified_name, violations_data[[name]])\n}\n\nim_itt &lt;- im_itt %&gt;%\n  rename(usubjid = \"id\")\n\n\nExclude all usubjid that were in pilot study and/or withdrew the consent.\n\n\nFilter data\n\n\nlibrary(dplyr)\nlibrary(purrr)\n\n\nAttaching package: 'purrr'\n\n\nThe following object is masked from 'package:data.table':\n\n    transpose\n\n# Identify subjects to be excluded\nexcluded_subjects &lt;- unique(c(pilot$usubjid, withdrawals$usubjid))\n\n# List of dataset names\ndataset_names &lt;- c(\n  \"vent\",\n  \"enr\",\n  \"adm\",\n  \"vent_ventilation\",\n  \"vent_trachesupp\",\n  \"daily\",\n  \"daily_daily\",\n  \"comp\",\n  \"fu\",\n  \"daily_fu\",\n  \"daily_fu_gridfu\",\n  \"s_ae\"\n)\n\n# Apply filtering to all datasets and reassign them\nfiltered_datasets &lt;- map(setNames(dataset_names, dataset_names), ~ {\n  get(.x) %&gt;% filter(!usubjid %in% excluded_subjects)\n})\n\n# Assign filtered datasets back to their original names\nlist2env(filtered_datasets, envir = .GlobalEnv)\n\n&lt;environment: R_GlobalEnv&gt;\n\n\n\nRelabel variable and add units. So they will appear nicely in the table later. You might notice that I have created a new variable bmi here too. You could try to compute APACHE II score, SOFA score and Tetanus Severity Score too.\n\n\nBaseline data\n\n\nbaseline_data &lt;- enr %&gt;%\n  select(-entry) %&gt;%\n  left_join(adm, by = \"usubjid\") %&gt;%\n  left_join(randolist %&gt;% select(usubjid, arm), by = \"usubjid\")\n\nbaseline_data_raw &lt;- upData(\n  baseline_data,\n  bmi = weight / ((height / 100) ^ 2),\n  #new variable derived from weight and height\n  labels = c(\n    age = \"Age (years)\",\n    icudays = \"Days in ICU\",\n    sex = \"Sex\",\n    weight = \"Weight (kg)\",\n    height = \"Height (cm)\",\n    bmi = \"BMI (kg/m2)\",\n    source = \"Source\",\n    tetanus = \"Tetanus\",\n    hypertension = \"Hypertension\",\n    myocardialinfart = \"Myocardial infarction\",\n    angina = \"Angina\",\n    perivascular = \"Perivascular\",\n    chronicpul = \"Chronic pulmonary\",\n    connectivetissue = \"Connective tissue\",\n    mildliver = \"Mild liver\",\n    hemiplegia = \"Hemiplegia\",\n    diawithchronic = \"Diabetes with chronic\",\n    severeliver = \"Severe liver\",\n    aids = \"AIDS\",\n    cardiacfailureiii = \"Cardiac failure III\",\n    cardiacfailureiv = \"Cardiac failure IV\",\n    cerebrovascular = \"Cerebrovascular\",\n    severeresp = \"Severe respiratory\",\n    pepticulcer = \"Peptic ulcer\",\n    diabetes = \"Diabetes\",\n    severekidney = \"Severe kidney\",\n    malignancy = \"Malignancy\",\n    tumour = \"Tumour\",\n    dementia = \"Dementia\",\n    comorbidityoth1 = \"Other comorbidity 1\",\n    comorbidityoth2 = \"Other comorbidity 2\",\n    electivesurgery = \"Elective surgery\",\n    emergencysurgery = \"Emergency surgery\",\n    timetoadm = \"Duration of illness (days)\",\n    incubationperiod = \"Incubation period (days)\",\n    incuperiodonset = \"Period of onset (days)\",\n    wound = \"Wound\",\n    diffbreath = \"Difficulty breathing on admission\",\n    ablettscore = \"Ablett Score on admission\",\n    asa = \"ASA score\",\n    maxtemp = \"Maximum temperature during 1st day\",\n    resp = \"Respiratory rate\",\n    fio2 = \"FiO2\",\n    spo2 = \"SpO2\",\n    pao2 = \"PAO2\",\n    ph = \"PH\",\n    plt = \"Platelet count\",\n    wbc = \"White blood cell count\",\n    hct = \"Haematocrit\",\n    maxhr = \"Max HR\",\n    minhr = \"Min HR\",\n    maxsbp = \"Max SBP\",\n    worstdbp = \"Worst DBP\",\n    worstsbp = \"Worst SBP\",\n    vaso = \"Vasopressors\",\n    bili = \"Bilirubin\",\n    na = \"Sodium\",\n    k = \"Potassium\",\n    creat = \"Creatinine\",\n    renalfailure = \"Acute Renal Failure\"\n  )\n)\n\nInput object size:   360160 bytes;   112 variables   271 observations\nAdded variable      bmi\nNew object size:    365688 bytes;   113 variables   271 observations\n\n\n\n\n\n2. Baseline table\nWhen we write the code to create baseline tables for 5 different populations, we might notice that they are just repeated except for a first few filtering steps. Therefore, it’s good to wrap those repeated codes in a function to make our code neat and if we would like to make any changes, we just need to change at one place. This example is not optimal. Let’s think some ways to improve it based on what you have learnt in Rcafe course.\n\n\nWrap repeated code in a function\n\n\ngenerate_baseline_summary &lt;- function(baseline_data) {\n  library(dplyr)\n  library(gtsummary)\n  \n  # Select relevant columns\n  baseline_data &lt;- baseline_data %&gt;%\n    select(usubjid, age, sex, bmi, source, tetanus, icudays, outcome, hypertension, \n           myocardialinfart, angina, perivascular, chronicpul, connectivetissue, \n           mildliver, hemiplegia, diawithchronic, severeliver, aids, cardiacfailureiii, \n           cerebrovascular, severeresp, pepticulcer, diabetes, severekidney, malignancy, \n           tumour, dementia, renalfailure, electivesurgery, emergencysurgery, timetoadm, \n           incubationperiod, incuperiodonset, wound, diffbreath, ablettscore, asa, \n           maxtemp, resp, fio2, spo2, pao2, ph, plt, wbc, hct, maxhr, minhr, maxsbp, \n           worstdbp, worstsbp, vaso, na, k, creat, Arm) %&gt;% \n    as.data.frame(stringsAsFactors = FALSE)\n  \n  # Identify factor variables, excluding \"Arm\"\n  factor_vars &lt;- setdiff(names(baseline_data)[sapply(baseline_data, is.factor)], \"Arm\")\n  \n  # Create a formula dynamically: c(var1, var2, ...) ~ \"1\"\n  value_formula &lt;- as.formula(paste(\"c(\", paste(factor_vars, collapse = \", \"), \") ~ '1'\"))\n  \n  # Generate the summary table\n  baseline_table &lt;- baseline_data %&gt;%\n    select(-usubjid) %&gt;%\n    tbl_summary(\n      by = Arm, \n      missing = \"no\", # Handle missing values\n      statistic = list(\n        all_continuous() ~ \"{median} ({p25}, {p75})\", \n        all_categorical() ~ \"{n}/{N} ({p}%)\"\n      ),\n      digits = list(all_continuous() ~ 1),\n      type = list(fio2 ~ \"continuous\"),\n      value = value_formula  # Apply \"1\" to all factor variables\n    ) %&gt;%\n    modify_header(label ~ \"Variable\") %&gt;%\n    bold_labels()\n  \n  return(baseline_table)\n}\n\n\n\nApply our generate_baseline_summary function to make tables for 5 different populations. Note how each population is filtered and grouped into treatment arms according to the Statistical analysis plan\n\nBaseline table IT_ITTBaseline table IM_ITTBaseline table IT_PPBaseline table IM_PPBaseline table IM_ALL\n\n\n\n\nClick to expand/collapse\n\n\n# Prepare baseline data\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  mutate( \n    Arm = recode(arm, \n                 \"equine and intrathecal\" = 0, \n                 \"human and intrathecal\" = 0,\n                 \"human and sham\" = 1,\n                 \"equine and sham\" = 1),\n    Arm = factor(Arm, levels = c(0,1), labels = c(\"Intrathecal treatment\", \"Sham procedure\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nIntrathecal treatment N = 1361\nSham procedure N = 1351\n\n\n\n\nAge (years)\n46.0 (38.0, 57.0)\n50.0 (41.0, 60.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/136 (16%)\n22/135 (16%)\n\n\n    M\n114/136 (84%)\n113/135 (84%)\n\n\nBMI (kg/m2)\n21.5 (19.9, 23.4)\n20.9 (19.5, 23.1)\n\n\nSource\n\n\n\n\n\n\n    1\n33/136 (24%)\n28/135 (21%)\n\n\n    2\n103/136 (76%)\n107/135 (79%)\n\n\nTetanus\n136/136 (100%)\n135/135 (100%)\n\n\nDays in ICU\n13.5 (8.0, 21.0)\n16.0 (8.0, 23.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n3/136 (2.2%)\n4/135 (3.0%)\n\n\n    3\n2/136 (1.5%)\n5/135 (3.7%)\n\n\n    4\n131/136 (96%)\n126/135 (93%)\n\n\nHypertension\n23/134 (17%)\n25/132 (19%)\n\n\nMyocardial infarction\n1/134 (0.7%)\n0/134 (0%)\n\n\nAngina\n0/134 (0%)\n0/135 (0%)\n\n\nPerivascular\n0/134 (0%)\n1/133 (0.8%)\n\n\nChronic pulmonary\n1/134 (0.7%)\n6/134 (4.5%)\n\n\nConnective tissue\n0/134 (0%)\n0/135 (0%)\n\n\nMild liver\n44/134 (33%)\n24/135 (18%)\n\n\nHemiplegia\n0/134 (0%)\n1/135 (0.7%)\n\n\nDiabetes with chronic\n2/134 (1.5%)\n3/133 (2.3%)\n\n\nSevere liver\n4/135 (3.0%)\n1/135 (0.7%)\n\n\nAIDS\n0/135 (0%)\n0/135 (0%)\n\n\nCardiac failure III\n0/135 (0%)\n0/135 (0%)\n\n\nCerebrovascular\n2/134 (1.5%)\n3/135 (2.2%)\n\n\nSevere respiratory\n0/135 (0%)\n0/135 (0%)\n\n\nPeptic ulcer\n3/135 (2.2%)\n0/135 (0%)\n\n\nDiabetes\n6/135 (4.4%)\n12/133 (9.0%)\n\n\nSevere kidney\n3/135 (2.2%)\n3/135 (2.2%)\n\n\nMalignancy\n1/135 (0.7%)\n1/135 (0.7%)\n\n\nTumour\n0/135 (0%)\n0/134 (0%)\n\n\nDementia\n1/135 (0.7%)\n0/135 (0%)\n\n\nAcute Renal Failure\n2/136 (1.5%)\n2/135 (1.5%)\n\n\nElective surgery\n1/136 (0.7%)\n1/135 (0.7%)\n\n\nEmergency surgery\n9/136 (6.6%)\n6/135 (4.4%)\n\n\nDuration of illness (days)\n3.0 (2.0, 5.0)\n3.0 (2.0, 5.0)\n\n\nIncubation period (days)\n8.0 (5.5, 14.0)\n9.0 (6.0, 14.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n2/136 (1.5%)\n0/135 (0%)\n\n\n    2\n134/136 (99%)\n135/135 (100%)\n\n\nDifficulty breathing on admission\n10/136 (7.4%)\n5/135 (3.7%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n23/136 (17%)\n24/135 (18%)\n\n\n    II\n100/136 (74%)\n100/135 (74%)\n\n\n    III\n13/136 (9.6%)\n11/135 (8.1%)\n\n\nASA score\n\n\n\n\n\n\n    1\n74/136 (54%)\n74/135 (55%)\n\n\n    2\n56/136 (41%)\n49/135 (36%)\n\n\n    3\n6/136 (4.4%)\n12/135 (8.9%)\n\n\nMaximum temperature during 1st day\n37.5 (37.4, 37.8)\n37.5 (37.0, 37.6)\n\n\nRespiratory rate\n22.0 (20.0, 24.0)\n20.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.0 (95.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n112.0 (98.0, 144.0)\n109.0 (98.0, 123.0)\n\n\nPH\n7.4 (7.4, 7.5)\n7.4 (7.3, 7.5)\n\n\nPlatelet count\n285.5 (224.5, 335.0)\n274.0 (227.0, 321.0)\n\n\nWhite blood cell count\n9.1 (7.5, 11.5)\n8.8 (7.4, 11.0)\n\n\nHaematocrit\n41.9 (38.4, 44.0)\n41.0 (38.0, 44.0)\n\n\nMax HR\n96.0 (88.0, 100.0)\n90.0 (82.0, 100.0)\n\n\nMin HR\n80.0 (72.0, 88.0)\n72.0 (68.0, 84.0)\n\n\nMax SBP\n140.0 (125.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n130.0 (120.0, 150.0)\n\n\nVasopressors\n0/136 (0%)\n1/135 (0.7%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.6 (3.4, 3.8)\n3.7 (3.5, 3.9)\n\n\nCreatinine\n77.5 (66.0, 87.5)\n75.0 (65.0, 87.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  filter(!usubjid %in% im_itt$usubjid) %&gt;% \n  mutate(\n    Arm=recode(arm, \"equine and intrathecal\" = 0, \n               \"equine and sham\" = 0,\n               \"human and sham\" = 1,\n               \"human and intrathecal\" = 1),\n    Arm=factor(Arm, levels=c(0,1), labels=c(\"Equine IM\",\"Human IM\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nEquine IM N = 1081\nHuman IM N = 1091\n\n\n\n\nAge (years)\n50.0 (40.5, 61.0)\n48.0 (39.0, 59.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/108 (20%)\n17/109 (16%)\n\n\n    M\n86/108 (80%)\n92/109 (84%)\n\n\nBMI (kg/m2)\n21.6 (19.9, 23.4)\n20.9 (19.5, 22.8)\n\n\nSource\n\n\n\n\n\n\n    1\n30/108 (28%)\n31/109 (28%)\n\n\n    2\n78/108 (72%)\n78/109 (72%)\n\n\nTetanus\n108/108 (100%)\n109/109 (100%)\n\n\nDays in ICU\n12.5 (7.0, 22.0)\n14.0 (8.0, 22.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n4/108 (3.7%)\n2/109 (1.8%)\n\n\n    3\n3/108 (2.8%)\n3/109 (2.8%)\n\n\n    4\n101/108 (94%)\n104/109 (95%)\n\n\nHypertension\n21/107 (20%)\n20/106 (19%)\n\n\nMyocardial infarction\n1/107 (0.9%)\n0/108 (0%)\n\n\nAngina\n0/107 (0%)\n0/108 (0%)\n\n\nPerivascular\n1/105 (1.0%)\n0/108 (0%)\n\n\nChronic pulmonary\n3/106 (2.8%)\n3/108 (2.8%)\n\n\nConnective tissue\n0/107 (0%)\n0/108 (0%)\n\n\nMild liver\n26/107 (24%)\n31/108 (29%)\n\n\nHemiplegia\n0/107 (0%)\n1/108 (0.9%)\n\n\nDiabetes with chronic\n3/106 (2.8%)\n2/108 (1.9%)\n\n\nSevere liver\n4/107 (3.7%)\n0/109 (0%)\n\n\nAIDS\n0/107 (0%)\n0/109 (0%)\n\n\nCardiac failure III\n0/107 (0%)\n0/109 (0%)\n\n\nCerebrovascular\n2/107 (1.9%)\n2/108 (1.9%)\n\n\nSevere respiratory\n0/107 (0%)\n0/109 (0%)\n\n\nPeptic ulcer\n2/107 (1.9%)\n1/109 (0.9%)\n\n\nDiabetes\n11/106 (10%)\n4/109 (3.7%)\n\n\nSevere kidney\n4/107 (3.7%)\n2/109 (1.8%)\n\n\nMalignancy\n1/107 (0.9%)\n1/109 (0.9%)\n\n\nTumour\n0/106 (0%)\n0/109 (0%)\n\n\nDementia\n0/107 (0%)\n1/109 (0.9%)\n\n\nAcute Renal Failure\n4/108 (3.7%)\n0/109 (0%)\n\n\nElective surgery\n1/108 (0.9%)\n0/109 (0%)\n\n\nEmergency surgery\n7/108 (6.5%)\n6/109 (5.5%)\n\n\nDuration of illness (days)\n3.0 (2.5, 5.0)\n3.0 (2.0, 6.0)\n\n\nIncubation period (days)\n8.0 (6.0, 14.0)\n8.0 (5.0, 12.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n1/108 (0.9%)\n1/109 (0.9%)\n\n\n    2\n107/108 (99%)\n108/109 (99%)\n\n\nDifficulty breathing on admission\n6/108 (5.6%)\n5/109 (4.6%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n22/108 (20%)\n21/109 (19%)\n\n\n    II\n79/108 (73%)\n77/109 (71%)\n\n\n    III\n7/108 (6.5%)\n11/109 (10%)\n\n\nASA score\n\n\n\n\n\n\n    1\n61/108 (56%)\n53/109 (49%)\n\n\n    2\n37/108 (34%)\n52/109 (48%)\n\n\n    3\n10/108 (9.3%)\n4/109 (3.7%)\n\n\nMaximum temperature during 1st day\n37.5 (37.1, 37.6)\n37.5 (37.4, 37.6)\n\n\nRespiratory rate\n20.0 (20.0, 23.5)\n22.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.5 (96.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n107.0 (79.0, 144.0)\n120.0 (101.0, 144.0)\n\n\nPH\n7.5 (7.3, 7.5)\n7.4 (7.4, 7.5)\n\n\nPlatelet count\n276.0 (228.5, 325.5)\n274.0 (217.0, 322.0)\n\n\nWhite blood cell count\n8.7 (7.3, 11.5)\n8.8 (7.2, 10.9)\n\n\nHaematocrit\n41.3 (37.9, 44.0)\n42.0 (39.0, 44.4)\n\n\nMax HR\n92.0 (85.0, 100.0)\n92.0 (86.0, 104.0)\n\n\nMin HR\n76.0 (68.0, 84.0)\n76.0 (70.0, 88.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (130.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nVasopressors\n0/108 (0%)\n1/109 (0.9%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.7 (3.4, 3.9)\n3.7 (3.4, 3.9)\n\n\nCreatinine\n80.0 (66.0, 89.0)\n75.0 (65.0, 86.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  filter(!usubjid %in% it_per_protocol$usubjid) %&gt;% \n  mutate( \n    Arm = recode(arm, \n                 \"equine and intrathecal\" = 0, \n                 \"human and intrathecal\" = 0,\n                 \"human and sham\" = 1,\n                 \"equine and sham\" = 1),\n    Arm = factor(Arm, levels = c(0,1), labels = c(\"Intrathecal treatment\", \"Sham procedure\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nIntrathecal treatment N = 1321\nSham procedure N = 1321\n\n\n\n\nAge (years)\n46.0 (38.0, 58.0)\n51.5 (41.0, 60.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/132 (17%)\n22/132 (17%)\n\n\n    M\n110/132 (83%)\n110/132 (83%)\n\n\nBMI (kg/m2)\n21.4 (19.9, 23.3)\n20.9 (19.5, 23.1)\n\n\nSource\n\n\n\n\n\n\n    1\n32/132 (24%)\n27/132 (20%)\n\n\n    2\n100/132 (76%)\n105/132 (80%)\n\n\nTetanus\n132/132 (100%)\n132/132 (100%)\n\n\nDays in ICU\n13.0 (8.0, 21.0)\n16.0 (8.0, 23.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n2/132 (1.5%)\n4/132 (3.0%)\n\n\n    3\n2/132 (1.5%)\n5/132 (3.8%)\n\n\n    4\n128/132 (97%)\n123/132 (93%)\n\n\nHypertension\n23/130 (18%)\n25/129 (19%)\n\n\nMyocardial infarction\n1/130 (0.8%)\n0/131 (0%)\n\n\nAngina\n0/130 (0%)\n0/132 (0%)\n\n\nPerivascular\n0/130 (0%)\n1/130 (0.8%)\n\n\nChronic pulmonary\n1/130 (0.8%)\n6/131 (4.6%)\n\n\nConnective tissue\n0/130 (0%)\n0/132 (0%)\n\n\nMild liver\n41/130 (32%)\n24/132 (18%)\n\n\nHemiplegia\n0/130 (0%)\n1/132 (0.8%)\n\n\nDiabetes with chronic\n2/130 (1.5%)\n3/130 (2.3%)\n\n\nSevere liver\n4/131 (3.1%)\n1/132 (0.8%)\n\n\nAIDS\n0/131 (0%)\n0/132 (0%)\n\n\nCardiac failure III\n0/131 (0%)\n0/132 (0%)\n\n\nCerebrovascular\n2/130 (1.5%)\n3/132 (2.3%)\n\n\nSevere respiratory\n0/131 (0%)\n0/132 (0%)\n\n\nPeptic ulcer\n3/131 (2.3%)\n0/132 (0%)\n\n\nDiabetes\n6/131 (4.6%)\n12/130 (9.2%)\n\n\nSevere kidney\n3/131 (2.3%)\n3/132 (2.3%)\n\n\nMalignancy\n1/131 (0.8%)\n1/132 (0.8%)\n\n\nTumour\n0/131 (0%)\n0/131 (0%)\n\n\nDementia\n1/131 (0.8%)\n0/132 (0%)\n\n\nAcute Renal Failure\n2/132 (1.5%)\n2/132 (1.5%)\n\n\nElective surgery\n1/132 (0.8%)\n1/132 (0.8%)\n\n\nEmergency surgery\n8/132 (6.1%)\n6/132 (4.5%)\n\n\nDuration of illness (days)\n3.0 (2.0, 5.0)\n3.0 (2.0, 5.0)\n\n\nIncubation period (days)\n8.0 (5.0, 13.5)\n9.0 (6.0, 14.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n2/132 (1.5%)\n0/132 (0%)\n\n\n    2\n130/132 (98%)\n132/132 (100%)\n\n\nDifficulty breathing on admission\n9/132 (6.8%)\n5/132 (3.8%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n23/132 (17%)\n24/132 (18%)\n\n\n    II\n97/132 (73%)\n97/132 (73%)\n\n\n    III\n12/132 (9.1%)\n11/132 (8.3%)\n\n\nASA score\n\n\n\n\n\n\n    1\n72/132 (55%)\n72/132 (55%)\n\n\n    2\n54/132 (41%)\n48/132 (36%)\n\n\n    3\n6/132 (4.5%)\n12/132 (9.1%)\n\n\nMaximum temperature during 1st day\n37.5 (37.4, 37.7)\n37.5 (37.0, 37.6)\n\n\nRespiratory rate\n22.0 (20.0, 24.0)\n20.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.0 (95.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n110.0 (98.0, 144.0)\n109.0 (98.0, 123.0)\n\n\nPH\n7.5 (7.4, 7.5)\n7.4 (7.3, 7.5)\n\n\nPlatelet count\n280.0 (223.5, 334.0)\n274.0 (229.0, 322.0)\n\n\nWhite blood cell count\n9.0 (7.5, 11.5)\n8.9 (7.4, 11.0)\n\n\nHaematocrit\n41.9 (38.4, 44.0)\n41.1 (38.0, 44.0)\n\n\nMax HR\n96.0 (88.0, 100.0)\n90.0 (83.0, 100.0)\n\n\nMin HR\n80.0 (72.0, 88.0)\n72.0 (68.0, 84.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n135.0 (120.0, 150.0)\n\n\nVasopressors\n0/132 (0%)\n1/132 (0.8%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.6 (3.4, 3.8)\n3.7 (3.5, 3.9)\n\n\nCreatinine\n77.0 (66.0, 88.0)\n75.0 (65.0, 86.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  filter(!usubjid %in% im_per_protocol$usubjid) %&gt;% \n  mutate( \n    Arm=recode(arm,\n               \"equine and intrathecal\" = 0, \n               \"equine and sham\" = 0,\n               \"human and sham\" = 1,\n               \"human and intrathecal\" = 1),\n    Arm=factor(Arm, levels=c(0,1), labels=c(\"Equine IM\",\"Human IM\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nEquine IM N = 1061\nHuman IM N = 1091\n\n\n\n\nAge (years)\n50.0 (41.0, 61.0)\n48.0 (39.0, 59.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/106 (21%)\n17/109 (16%)\n\n\n    M\n84/106 (79%)\n92/109 (84%)\n\n\nBMI (kg/m2)\n21.6 (19.8, 23.4)\n20.9 (19.5, 22.8)\n\n\nSource\n\n\n\n\n\n\n    1\n30/106 (28%)\n31/109 (28%)\n\n\n    2\n76/106 (72%)\n78/109 (72%)\n\n\nTetanus\n106/106 (100%)\n109/109 (100%)\n\n\nDays in ICU\n12.5 (7.0, 22.0)\n14.0 (8.0, 22.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n4/106 (3.8%)\n2/109 (1.8%)\n\n\n    3\n3/106 (2.8%)\n3/109 (2.8%)\n\n\n    4\n99/106 (93%)\n104/109 (95%)\n\n\nHypertension\n21/105 (20%)\n20/106 (19%)\n\n\nMyocardial infarction\n1/105 (1.0%)\n0/108 (0%)\n\n\nAngina\n0/105 (0%)\n0/108 (0%)\n\n\nPerivascular\n1/103 (1.0%)\n0/108 (0%)\n\n\nChronic pulmonary\n3/104 (2.9%)\n3/108 (2.8%)\n\n\nConnective tissue\n0/105 (0%)\n0/108 (0%)\n\n\nMild liver\n26/105 (25%)\n31/108 (29%)\n\n\nHemiplegia\n0/105 (0%)\n1/108 (0.9%)\n\n\nDiabetes with chronic\n3/104 (2.9%)\n2/108 (1.9%)\n\n\nSevere liver\n4/105 (3.8%)\n0/109 (0%)\n\n\nAIDS\n0/105 (0%)\n0/109 (0%)\n\n\nCardiac failure III\n0/105 (0%)\n0/109 (0%)\n\n\nCerebrovascular\n2/105 (1.9%)\n2/108 (1.9%)\n\n\nSevere respiratory\n0/105 (0%)\n0/109 (0%)\n\n\nPeptic ulcer\n2/105 (1.9%)\n1/109 (0.9%)\n\n\nDiabetes\n11/104 (11%)\n4/109 (3.7%)\n\n\nSevere kidney\n4/105 (3.8%)\n2/109 (1.8%)\n\n\nMalignancy\n1/105 (1.0%)\n1/109 (0.9%)\n\n\nTumour\n0/104 (0%)\n0/109 (0%)\n\n\nDementia\n0/105 (0%)\n1/109 (0.9%)\n\n\nAcute Renal Failure\n4/106 (3.8%)\n0/109 (0%)\n\n\nElective surgery\n1/106 (0.9%)\n0/109 (0%)\n\n\nEmergency surgery\n7/106 (6.6%)\n6/109 (5.5%)\n\n\nDuration of illness (days)\n3.0 (2.0, 5.0)\n3.0 (2.0, 6.0)\n\n\nIncubation period (days)\n8.0 (6.0, 13.0)\n8.0 (5.0, 12.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n1/106 (0.9%)\n1/109 (0.9%)\n\n\n    2\n105/106 (99%)\n108/109 (99%)\n\n\nDifficulty breathing on admission\n6/106 (5.7%)\n5/109 (4.6%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n22/106 (21%)\n21/109 (19%)\n\n\n    II\n77/106 (73%)\n77/109 (71%)\n\n\n    III\n7/106 (6.6%)\n11/109 (10%)\n\n\nASA score\n\n\n\n\n\n\n    1\n60/106 (57%)\n53/109 (49%)\n\n\n    2\n36/106 (34%)\n52/109 (48%)\n\n\n    3\n10/106 (9.4%)\n4/109 (3.7%)\n\n\nMaximum temperature during 1st day\n37.5 (37.1, 37.6)\n37.5 (37.4, 37.6)\n\n\nRespiratory rate\n20.0 (20.0, 24.0)\n22.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.0 (96.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n107.0 (79.0, 144.0)\n120.0 (101.0, 144.0)\n\n\nPH\n7.5 (7.3, 7.5)\n7.4 (7.4, 7.5)\n\n\nPlatelet count\n279.5 (230.0, 326.0)\n274.0 (217.0, 322.0)\n\n\nWhite blood cell count\n8.8 (7.3, 11.5)\n8.8 (7.2, 10.9)\n\n\nHaematocrit\n41.3 (37.9, 44.0)\n42.0 (39.0, 44.4)\n\n\nMax HR\n92.0 (86.0, 100.0)\n92.0 (86.0, 104.0)\n\n\nMin HR\n76.0 (68.0, 84.0)\n76.0 (70.0, 88.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (130.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nVasopressors\n0/106 (0%)\n1/109 (0.9%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.7 (3.4, 3.9)\n3.7 (3.4, 3.9)\n\n\nCreatinine\n80.0 (66.0, 88.0)\n75.0 (65.0, 86.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;%\n  mutate(\n    Arm = recode(\n      arm,\n      \"equine and intrathecal\" = 0,\n      \"equine and sham\" = 0,\n      \"human and sham\" = 1,\n      \"human and intrathecal\" = 1\n    ),\n    Arm = ifelse(prehtig == 1, 2, Arm),\n    Arm = factor(\n      Arm,\n      levels = c(0, 1, 2),\n      labels = c(\"Equine IM\", \"Human IM\", \"Equine IM pre hospital\")\n    )\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nEquine IM N = 1081\nHuman IM N = 1091\nEquine IM pre hospital N = 541\n\n\n\n\nAge (years)\n50.0 (40.5, 61.0)\n48.0 (39.0, 59.0)\n48.5 (39.0, 56.0)\n\n\nSex\n\n\n\n\n\n\n\n\n    F\n22/108 (20%)\n17/109 (16%)\n5/54 (9.3%)\n\n\n    M\n86/108 (80%)\n92/109 (84%)\n49/54 (91%)\n\n\nBMI (kg/m2)\n21.6 (19.9, 23.4)\n20.9 (19.5, 22.8)\n21.5 (20.2, 23.5)\n\n\nSource\n\n\n\n\n\n\n\n\n    1\n30/108 (28%)\n31/109 (28%)\n0/54 (0%)\n\n\n    2\n78/108 (72%)\n78/109 (72%)\n54/54 (100%)\n\n\nTetanus\n108/108 (100%)\n109/109 (100%)\n54/54 (100%)\n\n\nDays in ICU\n12.5 (7.0, 22.0)\n14.0 (8.0, 22.0)\n17.5 (12.0, 23.0)\n\n\noutcome\n\n\n\n\n\n\n\n\n    2\n4/108 (3.7%)\n2/109 (1.8%)\n1/54 (1.9%)\n\n\n    3\n3/108 (2.8%)\n3/109 (2.8%)\n1/54 (1.9%)\n\n\n    4\n101/108 (94%)\n104/109 (95%)\n52/54 (96%)\n\n\nHypertension\n21/107 (20%)\n20/106 (19%)\n7/53 (13%)\n\n\nMyocardial infarction\n1/107 (0.9%)\n0/108 (0%)\n0/53 (0%)\n\n\nAngina\n0/107 (0%)\n0/108 (0%)\n0/54 (0%)\n\n\nPerivascular\n1/105 (1.0%)\n0/108 (0%)\n0/54 (0%)\n\n\nChronic pulmonary\n3/106 (2.8%)\n3/108 (2.8%)\n1/54 (1.9%)\n\n\nConnective tissue\n0/107 (0%)\n0/108 (0%)\n0/54 (0%)\n\n\nMild liver\n26/107 (24%)\n31/108 (29%)\n11/54 (20%)\n\n\nHemiplegia\n0/107 (0%)\n1/108 (0.9%)\n0/54 (0%)\n\n\nDiabetes with chronic\n3/106 (2.8%)\n2/108 (1.9%)\n0/53 (0%)\n\n\nSevere liver\n4/107 (3.7%)\n0/109 (0%)\n1/54 (1.9%)\n\n\nAIDS\n0/107 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nCardiac failure III\n0/107 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nCerebrovascular\n2/107 (1.9%)\n2/108 (1.9%)\n1/54 (1.9%)\n\n\nSevere respiratory\n0/107 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nPeptic ulcer\n2/107 (1.9%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nDiabetes\n11/106 (10%)\n4/109 (3.7%)\n3/53 (5.7%)\n\n\nSevere kidney\n4/107 (3.7%)\n2/109 (1.8%)\n0/54 (0%)\n\n\nMalignancy\n1/107 (0.9%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nTumour\n0/106 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nDementia\n0/107 (0%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nAcute Renal Failure\n4/108 (3.7%)\n0/109 (0%)\n0/54 (0%)\n\n\nElective surgery\n1/108 (0.9%)\n0/109 (0%)\n1/54 (1.9%)\n\n\nEmergency surgery\n7/108 (6.5%)\n6/109 (5.5%)\n2/54 (3.7%)\n\n\nDuration of illness (days)\n3.0 (2.5, 5.0)\n3.0 (2.0, 6.0)\n3.0 (2.0, 4.0)\n\n\nIncubation period (days)\n8.0 (6.0, 14.0)\n8.0 (5.0, 12.0)\n10.0 (6.0, 14.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n48.0 (24.0, 92.0)\n\n\nWound\n\n\n\n\n\n\n\n\n    1\n1/108 (0.9%)\n1/109 (0.9%)\n0/54 (0%)\n\n\n    2\n107/108 (99%)\n108/109 (99%)\n54/54 (100%)\n\n\nDifficulty breathing on admission\n6/108 (5.6%)\n5/109 (4.6%)\n4/54 (7.4%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n\n\n    I\n22/108 (20%)\n21/109 (19%)\n4/54 (7.4%)\n\n\n    II\n79/108 (73%)\n77/109 (71%)\n44/54 (81%)\n\n\n    III\n7/108 (6.5%)\n11/109 (10%)\n6/54 (11%)\n\n\nASA score\n\n\n\n\n\n\n\n\n    1\n61/108 (56%)\n53/109 (49%)\n34/54 (63%)\n\n\n    2\n37/108 (34%)\n52/109 (48%)\n16/54 (30%)\n\n\n    3\n10/108 (9.3%)\n4/109 (3.7%)\n4/54 (7.4%)\n\n\nMaximum temperature during 1st day\n37.5 (37.1, 37.6)\n37.5 (37.4, 37.6)\n37.4 (37.0, 37.6)\n\n\nRespiratory rate\n20.0 (20.0, 23.5)\n22.0 (20.0, 24.0)\n22.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.5 (96.0, 97.0)\n96.0 (95.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n107.0 (79.0, 144.0)\n120.0 (101.0, 144.0)\n105.0 (98.0, 127.0)\n\n\nPH\n7.5 (7.3, 7.5)\n7.4 (7.4, 7.5)\n7.4 (7.3, 7.5)\n\n\nPlatelet count\n276.0 (228.5, 325.5)\n274.0 (217.0, 322.0)\n293.5 (246.0, 346.0)\n\n\nWhite blood cell count\n8.7 (7.3, 11.5)\n8.8 (7.2, 10.9)\n9.8 (8.2, 11.2)\n\n\nHaematocrit\n41.3 (37.9, 44.0)\n42.0 (39.0, 44.4)\n41.0 (38.0, 42.8)\n\n\nMax HR\n92.0 (85.0, 100.0)\n92.0 (86.0, 104.0)\n93.0 (80.0, 100.0)\n\n\nMin HR\n76.0 (68.0, 84.0)\n76.0 (70.0, 88.0)\n76.0 (68.0, 84.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (130.0, 150.0)\n130.0 (120.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n130.0 (120.0, 150.0)\n\n\nVasopressors\n0/108 (0%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.7 (3.4, 3.9)\n3.7 (3.4, 3.9)\n3.6 (3.4, 3.8)\n\n\nCreatinine\n80.0 (66.0, 89.0)\n75.0 (65.0, 86.0)\n74.0 (63.0, 82.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3. Compute Apache II score\nThe appendix of how Tetanus Severity, SOFA, APACHE II calculated is available here\n\n\nPrepare data for Apache II scoring\n\n\n## Calculate scores\n\n### Create the data table for apache.ii\n\napache.ii_data &lt;-\n  adm %&gt;% select(usubjid, maxtemp, gcs, resp, fio2, spo2, pao2, ph, plt, wbc, hct, maxhr, minhr, maxsbp, worstsbp, worstdbp, bili, na, k, creat, electivesurgery, emergencysurgery, immunocompromised, severeresp, cardiacfailureiv, diawithchronic, severeliver) %&gt;%\n   left_join(enr, by=\"usubjid\") %&gt;% select (usubjid, age, randtc, maxtemp, gcs, resp, fio2, spo2, pao2, ph, plt, wbc, hct, maxhr, minhr, maxsbp, worstsbp, worstdbp, bili, na, k, creat, electivesurgery, emergencysurgery, immunocompromised, severeresp, cardiacfailureiv, diawithchronic, severeliver) %&gt;%\n  mutate(\n    temp = structure(maxtemp, label=\"Maximum temperature during 1st day\"),\n    worstdbp = structure(worstdbp, label=\"Worst DBP\"),\n    worstsbp = structure(worstsbp, label=\"Worst SBP\"),\n    rr = structure(resp, label=\"Respiratory rate\"),\n    fio2 = structure(fio2, label=\"FiO2\"),\n    spo2 = structure(spo2, label=\"SpO2\"),\n    pao2 = structure(pao2, label=\"PAO2\"),\n    ph = structure(ph, label=\"PH\"),\n    plt = structure(plt, label=\"Platelet count\"),\n    wbc = structure(wbc, label=\"White blood cell count\"),\n    hct = structure(hct, label=\"Haematorcrit\"),\n    hr = pmax(maxhr, minhr),\n    hr = structure(hr, label=\"HR\"),\n    maxsbp = structure(maxsbp, label=\"Max SBP\"),\n    sodium = structure(na, label=\"Sodium\"),\n    potassium = structure(k, label=\"Potassium\"),\n    creatinine = structure(creat, label=\"Creatinine\"),\n    map = worstdbp + (worstsbp-worstdbp)/3,\n    map = structure(map, label=\"Mean Arterial Pressure\"),\n    gcs = structure(gcs, label=\"GCS\"),\n    age = structure(age, label=\"Age\", unit=\"years\"),\n    elective = electivesurgery,\n    emergency = emergencysurgery,\n    chronic = case_when(\n      immunocompromised == \"1\" ~ 1,\n      severeresp == \"1\" ~ 1,\n      cardiacfailureiv == \"1\" ~ 1,\n      diawithchronic == \"1\" ~ 1,\n      severeliver == \"1\" ~ 1,\n      TRUE ~ 0\n    )\n,\n    chronic = factor(chronic, levels=c(0,1), labels=c(\"0\",\"1\"))\n  ) %&gt;% \n  select(usubjid, temp, map, hr, rr, fio2, pao2, ph, sodium, potassium, creatinine, hct, wbc, gcs, age, elective, emergency, chronic)\n\n\n\n\nWrite function to compute Apache II score\n\n\ncalculate_apache_ii &lt;- function(data) {\n  data &lt;- data %&gt;%\n    mutate(\n      temp_score = case_when(\n        temp &gt;= 41 ~ 4,\n        temp &gt;= 39 ~ 3,\n        temp &gt;= 38.5 ~ 1,\n        TRUE ~ 0\n      ),\n      map_score = case_when(\n        map &gt;= 160 | map &lt; 40 ~ 4,\n        map &gt;= 130 | map &lt; 50 ~ 3,\n        map &gt;= 110 | map &lt; 70 ~ 2,\n        TRUE ~ 0\n      ),\n      hr_score = case_when(\n        hr &gt;= 180 | hr &lt; 40 ~ 4,\n        hr &gt;= 140 | hr &lt; 55 ~ 3,\n        hr &gt;= 110 | hr &lt; 70 ~ 2,\n        TRUE ~ 0\n      ),\n      rr_score = case_when(\n        rr &gt;= 50 | rr &lt; 6 ~ 4,\n        rr &gt;= 35 ~ 3,\n        rr &lt; 10 ~ 2,\n        rr &gt;= 25 | rr &lt; 12 ~ 1,\n        TRUE ~ 0\n      ),\n      pao2_score = case_when(\n        fio2 &gt; 0.5 ~ 0,\n        pao2 &lt; 55 ~ 4,\n        pao2 &lt;= 60 ~ 2,\n        pao2 &lt;= 70 ~ 1,\n        TRUE ~ 0\n      ),\n      ph_score = case_when(\n        ph &gt;= 7.7 | ph &lt; 7.15 ~ 4,\n        ph &gt;= 7.6 | ph &lt; 7.25 ~ 3,\n        ph &lt; 7.33 ~ 2,\n        ph &gt;= 7.5 ~ 1,\n        TRUE ~ 0\n      ),\n      sodium_score = case_when(\n        sodium &gt;= 180 | sodium &lt;= 110 ~ 4,\n        sodium &gt;= 160 | sodium &lt; 120 ~ 3,\n        sodium &gt;= 155 | sodium &lt; 130 ~ 2,\n        sodium &gt;= 150 ~ 1,\n        TRUE ~ 0\n      ),\n      potassium_score = case_when(\n        potassium &gt;= 7 | potassium &lt; 2.5 ~ 4,\n        potassium &gt;= 6 ~ 3,\n        potassium &lt; 3 ~ 2,\n        potassium &gt;= 5.5 | potassium &lt; 3.5 ~ 1,\n        TRUE ~ 0\n      ),\n      creatinine_score = case_when(\n        creatinine &gt;= 210 ~ 4,\n        creatinine &gt;= 178 ~ 3,\n        creatinine &gt;= 133 | creatinine &lt; 54 ~ 2,\n        TRUE ~ 0\n      ),\n      hct_score = case_when(\n        hct &gt;= 60 | hct &lt; 20 ~ 4,\n        hct &gt;= 50 | hct &lt; 30 ~ 2,\n        hct &gt;= 46 ~ 1,\n        TRUE ~ 0\n      ),\n      wbc_score = case_when(\n        wbc &gt;= 40 | wbc &lt; 1 ~ 4,\n        wbc &gt;= 20 | wbc &lt; 3 ~ 2,\n        wbc &gt;= 15 ~ 1,\n        TRUE ~ 0\n      ),\n      gcs_score = 15 - gcs,\n      age_score = case_when(\n        age &gt;= 75 ~ 6,\n        age &gt;= 65 ~ 5,\n        age &gt;= 55 ~ 3,\n        age &gt;= 45 ~ 2,\n        TRUE ~ 0\n      ),\n      elective_score = case_when(\n        elective == \"1\" ~ 5,\n        TRUE ~ 0\n      ),\n      emergency_score = case_when(\n        emergency == \"1\" ~ 5,\n        TRUE ~ 0\n      ),\n      chronic_score = case_when(\n        chronic == \"1\" ~ 5,\n        TRUE ~ 0\n      ),\n      apache_ii_score = temp_score + map_score + hr_score + rr_score +\n        pao2_score + ph_score + sodium_score + potassium_score + creatinine_score +\n        hct_score + wbc_score + gcs_score + age_score + elective_score + emergency_score + chronic_score,\n      apache_ii_score = structure(apache_ii_score, label = \"Apache II score\")\n    )\n  return(data)\n}\n\n\n\n\nApply the calculate_apache_ii to apache.ii_data and update the score to baseline_data_raw\n\n\napache.ii.score &lt;- calculate_apache_ii(apache.ii_data)\nbaseline_data_raw &lt;- baseline_data_raw %&gt;% left_join(apache.ii.score %&gt;% select(usubjid, apache_ii_score), by = \"usubjid\")\n\n\nBecause we has wrapped the repeated code to create baseline table into generate_baseline_summary function, we just need to add the apache_ii_score variable in the select part of generate_baseline_summary once and then apply it to our subset data.\n\n\nUpdate generate_baseline_summary function\n\n\ngenerate_baseline_summary &lt;- function(baseline_data) {\n  library(dplyr)\n  library(gtsummary)\n  \n  # Select relevant columns\n  baseline_data &lt;- baseline_data %&gt;%\n    select(usubjid, age, sex, bmi, source, tetanus, icudays, outcome, hypertension, \n           myocardialinfart, angina, perivascular, chronicpul, connectivetissue, \n           mildliver, hemiplegia, diawithchronic, severeliver, aids, cardiacfailureiii, \n           cerebrovascular, severeresp, pepticulcer, diabetes, severekidney, malignancy, \n           tumour, dementia, renalfailure, electivesurgery, emergencysurgery, timetoadm, \n           incubationperiod, incuperiodonset, wound, diffbreath, ablettscore, asa, \n           maxtemp, resp, fio2, spo2, pao2, ph, plt, wbc, hct, maxhr, minhr, maxsbp, \n           worstdbp, worstsbp, vaso, na, k, creat, apache_ii_score, Arm) %&gt;% #add apache_ii_score\n    as.data.frame(stringsAsFactors = FALSE)\n  \n  # Identify factor variables, excluding \"Arm\"\n  factor_vars &lt;- setdiff(names(baseline_data)[sapply(baseline_data, is.factor)], \"Arm\")\n  \n  # Create a formula dynamically: c(var1, var2, ...) ~ \"1\"\n  value_formula &lt;- as.formula(paste(\"c(\", paste(factor_vars, collapse = \", \"), \") ~ '1'\"))\n  \n  # Generate the summary table\n  baseline_table &lt;- baseline_data %&gt;%\n    select(-usubjid) %&gt;%\n    tbl_summary(\n      by = Arm, \n      missing = \"no\", # Handle missing values\n      statistic = list(\n        all_continuous() ~ \"{median} ({p25}, {p75})\", \n        all_categorical() ~ \"{n}/{N} ({p}%)\"\n      ),\n      digits = list(all_continuous() ~ 1),\n      type = list(fio2 ~ \"continuous\"),\n      value = value_formula  # Apply \"1\" to all factor variables\n    ) %&gt;%\n    modify_header(label ~ \"Variable\") %&gt;%\n    bold_labels()\n  \n  return(baseline_table)\n}\n\n\n\nIf we repeat our codes, we have to repeat our changes too. However, if we wrap them in a function, we only need to make changes in that function.\n\nBaseline table IT_ITTBaseline table IM_ITTBaseline table IT_PPBaseline table IM_PPBaseline table IM_ALL\n\n\n\n\nClick to expand/collapse\n\n\n# Prepare baseline data\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  mutate( \n    Arm = recode(arm, \n                 \"equine and intrathecal\" = 0, \n                 \"human and intrathecal\" = 0,\n                 \"human and sham\" = 1,\n                 \"equine and sham\" = 1),\n    Arm = factor(Arm, levels = c(0,1), labels = c(\"Intrathecal treatment\", \"Sham procedure\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nIntrathecal treatment N = 1361\nSham procedure N = 1351\n\n\n\n\nAge (years)\n46.0 (38.0, 57.0)\n50.0 (41.0, 60.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/136 (16%)\n22/135 (16%)\n\n\n    M\n114/136 (84%)\n113/135 (84%)\n\n\nBMI (kg/m2)\n21.5 (19.9, 23.4)\n20.9 (19.5, 23.1)\n\n\nSource\n\n\n\n\n\n\n    1\n33/136 (24%)\n28/135 (21%)\n\n\n    2\n103/136 (76%)\n107/135 (79%)\n\n\nTetanus\n136/136 (100%)\n135/135 (100%)\n\n\nDays in ICU\n13.5 (8.0, 21.0)\n16.0 (8.0, 23.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n3/136 (2.2%)\n4/135 (3.0%)\n\n\n    3\n2/136 (1.5%)\n5/135 (3.7%)\n\n\n    4\n131/136 (96%)\n126/135 (93%)\n\n\nHypertension\n23/134 (17%)\n25/132 (19%)\n\n\nMyocardial infarction\n1/134 (0.7%)\n0/134 (0%)\n\n\nAngina\n0/134 (0%)\n0/135 (0%)\n\n\nPerivascular\n0/134 (0%)\n1/133 (0.8%)\n\n\nChronic pulmonary\n1/134 (0.7%)\n6/134 (4.5%)\n\n\nConnective tissue\n0/134 (0%)\n0/135 (0%)\n\n\nMild liver\n44/134 (33%)\n24/135 (18%)\n\n\nHemiplegia\n0/134 (0%)\n1/135 (0.7%)\n\n\nDiabetes with chronic\n2/134 (1.5%)\n3/133 (2.3%)\n\n\nSevere liver\n4/135 (3.0%)\n1/135 (0.7%)\n\n\nAIDS\n0/135 (0%)\n0/135 (0%)\n\n\nCardiac failure III\n0/135 (0%)\n0/135 (0%)\n\n\nCerebrovascular\n2/134 (1.5%)\n3/135 (2.2%)\n\n\nSevere respiratory\n0/135 (0%)\n0/135 (0%)\n\n\nPeptic ulcer\n3/135 (2.2%)\n0/135 (0%)\n\n\nDiabetes\n6/135 (4.4%)\n12/133 (9.0%)\n\n\nSevere kidney\n3/135 (2.2%)\n3/135 (2.2%)\n\n\nMalignancy\n1/135 (0.7%)\n1/135 (0.7%)\n\n\nTumour\n0/135 (0%)\n0/134 (0%)\n\n\nDementia\n1/135 (0.7%)\n0/135 (0%)\n\n\nAcute Renal Failure\n2/136 (1.5%)\n2/135 (1.5%)\n\n\nElective surgery\n1/136 (0.7%)\n1/135 (0.7%)\n\n\nEmergency surgery\n9/136 (6.6%)\n6/135 (4.4%)\n\n\nDuration of illness (days)\n3.0 (2.0, 5.0)\n3.0 (2.0, 5.0)\n\n\nIncubation period (days)\n8.0 (5.5, 14.0)\n9.0 (6.0, 14.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n2/136 (1.5%)\n0/135 (0%)\n\n\n    2\n134/136 (99%)\n135/135 (100%)\n\n\nDifficulty breathing on admission\n10/136 (7.4%)\n5/135 (3.7%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n23/136 (17%)\n24/135 (18%)\n\n\n    II\n100/136 (74%)\n100/135 (74%)\n\n\n    III\n13/136 (9.6%)\n11/135 (8.1%)\n\n\nASA score\n\n\n\n\n\n\n    1\n74/136 (54%)\n74/135 (55%)\n\n\n    2\n56/136 (41%)\n49/135 (36%)\n\n\n    3\n6/136 (4.4%)\n12/135 (8.9%)\n\n\nMaximum temperature during 1st day\n37.5 (37.4, 37.8)\n37.5 (37.0, 37.6)\n\n\nRespiratory rate\n22.0 (20.0, 24.0)\n20.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.0 (95.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n112.0 (98.0, 144.0)\n109.0 (98.0, 123.0)\n\n\nPH\n7.4 (7.4, 7.5)\n7.4 (7.3, 7.5)\n\n\nPlatelet count\n285.5 (224.5, 335.0)\n274.0 (227.0, 321.0)\n\n\nWhite blood cell count\n9.1 (7.5, 11.5)\n8.8 (7.4, 11.0)\n\n\nHaematocrit\n41.9 (38.4, 44.0)\n41.0 (38.0, 44.0)\n\n\nMax HR\n96.0 (88.0, 100.0)\n90.0 (82.0, 100.0)\n\n\nMin HR\n80.0 (72.0, 88.0)\n72.0 (68.0, 84.0)\n\n\nMax SBP\n140.0 (125.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n130.0 (120.0, 150.0)\n\n\nVasopressors\n0/136 (0%)\n1/135 (0.7%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.6 (3.4, 3.8)\n3.7 (3.5, 3.9)\n\n\nCreatinine\n77.5 (66.0, 87.5)\n75.0 (65.0, 87.0)\n\n\nApache II score\n4.0 (2.0, 7.0)\n4.0 (2.0, 7.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  filter(!usubjid %in% im_itt$usubjid) %&gt;% \n  mutate(\n    Arm=recode(arm, \"equine and intrathecal\" = 0, \n               \"equine and sham\" = 0,\n               \"human and sham\" = 1,\n               \"human and intrathecal\" = 1),\n    Arm=factor(Arm, levels=c(0,1), labels=c(\"Equine IM\",\"Human IM\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nEquine IM N = 1081\nHuman IM N = 1091\n\n\n\n\nAge (years)\n50.0 (40.5, 61.0)\n48.0 (39.0, 59.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/108 (20%)\n17/109 (16%)\n\n\n    M\n86/108 (80%)\n92/109 (84%)\n\n\nBMI (kg/m2)\n21.6 (19.9, 23.4)\n20.9 (19.5, 22.8)\n\n\nSource\n\n\n\n\n\n\n    1\n30/108 (28%)\n31/109 (28%)\n\n\n    2\n78/108 (72%)\n78/109 (72%)\n\n\nTetanus\n108/108 (100%)\n109/109 (100%)\n\n\nDays in ICU\n12.5 (7.0, 22.0)\n14.0 (8.0, 22.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n4/108 (3.7%)\n2/109 (1.8%)\n\n\n    3\n3/108 (2.8%)\n3/109 (2.8%)\n\n\n    4\n101/108 (94%)\n104/109 (95%)\n\n\nHypertension\n21/107 (20%)\n20/106 (19%)\n\n\nMyocardial infarction\n1/107 (0.9%)\n0/108 (0%)\n\n\nAngina\n0/107 (0%)\n0/108 (0%)\n\n\nPerivascular\n1/105 (1.0%)\n0/108 (0%)\n\n\nChronic pulmonary\n3/106 (2.8%)\n3/108 (2.8%)\n\n\nConnective tissue\n0/107 (0%)\n0/108 (0%)\n\n\nMild liver\n26/107 (24%)\n31/108 (29%)\n\n\nHemiplegia\n0/107 (0%)\n1/108 (0.9%)\n\n\nDiabetes with chronic\n3/106 (2.8%)\n2/108 (1.9%)\n\n\nSevere liver\n4/107 (3.7%)\n0/109 (0%)\n\n\nAIDS\n0/107 (0%)\n0/109 (0%)\n\n\nCardiac failure III\n0/107 (0%)\n0/109 (0%)\n\n\nCerebrovascular\n2/107 (1.9%)\n2/108 (1.9%)\n\n\nSevere respiratory\n0/107 (0%)\n0/109 (0%)\n\n\nPeptic ulcer\n2/107 (1.9%)\n1/109 (0.9%)\n\n\nDiabetes\n11/106 (10%)\n4/109 (3.7%)\n\n\nSevere kidney\n4/107 (3.7%)\n2/109 (1.8%)\n\n\nMalignancy\n1/107 (0.9%)\n1/109 (0.9%)\n\n\nTumour\n0/106 (0%)\n0/109 (0%)\n\n\nDementia\n0/107 (0%)\n1/109 (0.9%)\n\n\nAcute Renal Failure\n4/108 (3.7%)\n0/109 (0%)\n\n\nElective surgery\n1/108 (0.9%)\n0/109 (0%)\n\n\nEmergency surgery\n7/108 (6.5%)\n6/109 (5.5%)\n\n\nDuration of illness (days)\n3.0 (2.5, 5.0)\n3.0 (2.0, 6.0)\n\n\nIncubation period (days)\n8.0 (6.0, 14.0)\n8.0 (5.0, 12.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n1/108 (0.9%)\n1/109 (0.9%)\n\n\n    2\n107/108 (99%)\n108/109 (99%)\n\n\nDifficulty breathing on admission\n6/108 (5.6%)\n5/109 (4.6%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n22/108 (20%)\n21/109 (19%)\n\n\n    II\n79/108 (73%)\n77/109 (71%)\n\n\n    III\n7/108 (6.5%)\n11/109 (10%)\n\n\nASA score\n\n\n\n\n\n\n    1\n61/108 (56%)\n53/109 (49%)\n\n\n    2\n37/108 (34%)\n52/109 (48%)\n\n\n    3\n10/108 (9.3%)\n4/109 (3.7%)\n\n\nMaximum temperature during 1st day\n37.5 (37.1, 37.6)\n37.5 (37.4, 37.6)\n\n\nRespiratory rate\n20.0 (20.0, 23.5)\n22.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.5 (96.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n107.0 (79.0, 144.0)\n120.0 (101.0, 144.0)\n\n\nPH\n7.5 (7.3, 7.5)\n7.4 (7.4, 7.5)\n\n\nPlatelet count\n276.0 (228.5, 325.5)\n274.0 (217.0, 322.0)\n\n\nWhite blood cell count\n8.7 (7.3, 11.5)\n8.8 (7.2, 10.9)\n\n\nHaematocrit\n41.3 (37.9, 44.0)\n42.0 (39.0, 44.4)\n\n\nMax HR\n92.0 (85.0, 100.0)\n92.0 (86.0, 104.0)\n\n\nMin HR\n76.0 (68.0, 84.0)\n76.0 (70.0, 88.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (130.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nVasopressors\n0/108 (0%)\n1/109 (0.9%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.7 (3.4, 3.9)\n3.7 (3.4, 3.9)\n\n\nCreatinine\n80.0 (66.0, 89.0)\n75.0 (65.0, 86.0)\n\n\nApache II score\n4.0 (2.0, 8.0)\n4.0 (2.0, 7.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  filter(!usubjid %in% it_per_protocol$usubjid) %&gt;% \n  mutate( \n    Arm = recode(arm, \n                 \"equine and intrathecal\" = 0, \n                 \"human and intrathecal\" = 0,\n                 \"human and sham\" = 1,\n                 \"equine and sham\" = 1),\n    Arm = factor(Arm, levels = c(0,1), labels = c(\"Intrathecal treatment\", \"Sham procedure\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nIntrathecal treatment N = 1321\nSham procedure N = 1321\n\n\n\n\nAge (years)\n46.0 (38.0, 58.0)\n51.5 (41.0, 60.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/132 (17%)\n22/132 (17%)\n\n\n    M\n110/132 (83%)\n110/132 (83%)\n\n\nBMI (kg/m2)\n21.4 (19.9, 23.3)\n20.9 (19.5, 23.1)\n\n\nSource\n\n\n\n\n\n\n    1\n32/132 (24%)\n27/132 (20%)\n\n\n    2\n100/132 (76%)\n105/132 (80%)\n\n\nTetanus\n132/132 (100%)\n132/132 (100%)\n\n\nDays in ICU\n13.0 (8.0, 21.0)\n16.0 (8.0, 23.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n2/132 (1.5%)\n4/132 (3.0%)\n\n\n    3\n2/132 (1.5%)\n5/132 (3.8%)\n\n\n    4\n128/132 (97%)\n123/132 (93%)\n\n\nHypertension\n23/130 (18%)\n25/129 (19%)\n\n\nMyocardial infarction\n1/130 (0.8%)\n0/131 (0%)\n\n\nAngina\n0/130 (0%)\n0/132 (0%)\n\n\nPerivascular\n0/130 (0%)\n1/130 (0.8%)\n\n\nChronic pulmonary\n1/130 (0.8%)\n6/131 (4.6%)\n\n\nConnective tissue\n0/130 (0%)\n0/132 (0%)\n\n\nMild liver\n41/130 (32%)\n24/132 (18%)\n\n\nHemiplegia\n0/130 (0%)\n1/132 (0.8%)\n\n\nDiabetes with chronic\n2/130 (1.5%)\n3/130 (2.3%)\n\n\nSevere liver\n4/131 (3.1%)\n1/132 (0.8%)\n\n\nAIDS\n0/131 (0%)\n0/132 (0%)\n\n\nCardiac failure III\n0/131 (0%)\n0/132 (0%)\n\n\nCerebrovascular\n2/130 (1.5%)\n3/132 (2.3%)\n\n\nSevere respiratory\n0/131 (0%)\n0/132 (0%)\n\n\nPeptic ulcer\n3/131 (2.3%)\n0/132 (0%)\n\n\nDiabetes\n6/131 (4.6%)\n12/130 (9.2%)\n\n\nSevere kidney\n3/131 (2.3%)\n3/132 (2.3%)\n\n\nMalignancy\n1/131 (0.8%)\n1/132 (0.8%)\n\n\nTumour\n0/131 (0%)\n0/131 (0%)\n\n\nDementia\n1/131 (0.8%)\n0/132 (0%)\n\n\nAcute Renal Failure\n2/132 (1.5%)\n2/132 (1.5%)\n\n\nElective surgery\n1/132 (0.8%)\n1/132 (0.8%)\n\n\nEmergency surgery\n8/132 (6.1%)\n6/132 (4.5%)\n\n\nDuration of illness (days)\n3.0 (2.0, 5.0)\n3.0 (2.0, 5.0)\n\n\nIncubation period (days)\n8.0 (5.0, 13.5)\n9.0 (6.0, 14.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n2/132 (1.5%)\n0/132 (0%)\n\n\n    2\n130/132 (98%)\n132/132 (100%)\n\n\nDifficulty breathing on admission\n9/132 (6.8%)\n5/132 (3.8%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n23/132 (17%)\n24/132 (18%)\n\n\n    II\n97/132 (73%)\n97/132 (73%)\n\n\n    III\n12/132 (9.1%)\n11/132 (8.3%)\n\n\nASA score\n\n\n\n\n\n\n    1\n72/132 (55%)\n72/132 (55%)\n\n\n    2\n54/132 (41%)\n48/132 (36%)\n\n\n    3\n6/132 (4.5%)\n12/132 (9.1%)\n\n\nMaximum temperature during 1st day\n37.5 (37.4, 37.7)\n37.5 (37.0, 37.6)\n\n\nRespiratory rate\n22.0 (20.0, 24.0)\n20.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.0 (95.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n110.0 (98.0, 144.0)\n109.0 (98.0, 123.0)\n\n\nPH\n7.5 (7.4, 7.5)\n7.4 (7.3, 7.5)\n\n\nPlatelet count\n280.0 (223.5, 334.0)\n274.0 (229.0, 322.0)\n\n\nWhite blood cell count\n9.0 (7.5, 11.5)\n8.9 (7.4, 11.0)\n\n\nHaematocrit\n41.9 (38.4, 44.0)\n41.1 (38.0, 44.0)\n\n\nMax HR\n96.0 (88.0, 100.0)\n90.0 (83.0, 100.0)\n\n\nMin HR\n80.0 (72.0, 88.0)\n72.0 (68.0, 84.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n135.0 (120.0, 150.0)\n\n\nVasopressors\n0/132 (0%)\n1/132 (0.8%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.6 (3.4, 3.8)\n3.7 (3.5, 3.9)\n\n\nCreatinine\n77.0 (66.0, 88.0)\n75.0 (65.0, 86.0)\n\n\nApache II score\n4.0 (2.0, 7.0)\n4.0 (2.0, 7.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  filter(!usubjid %in% im_per_protocol$usubjid) %&gt;% \n  mutate( \n    Arm=recode(arm,\n               \"equine and intrathecal\" = 0, \n               \"equine and sham\" = 0,\n               \"human and sham\" = 1,\n               \"human and intrathecal\" = 1),\n    Arm=factor(Arm, levels=c(0,1), labels=c(\"Equine IM\",\"Human IM\"))\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nEquine IM N = 1061\nHuman IM N = 1091\n\n\n\n\nAge (years)\n50.0 (41.0, 61.0)\n48.0 (39.0, 59.0)\n\n\nSex\n\n\n\n\n\n\n    F\n22/106 (21%)\n17/109 (16%)\n\n\n    M\n84/106 (79%)\n92/109 (84%)\n\n\nBMI (kg/m2)\n21.6 (19.8, 23.4)\n20.9 (19.5, 22.8)\n\n\nSource\n\n\n\n\n\n\n    1\n30/106 (28%)\n31/109 (28%)\n\n\n    2\n76/106 (72%)\n78/109 (72%)\n\n\nTetanus\n106/106 (100%)\n109/109 (100%)\n\n\nDays in ICU\n12.5 (7.0, 22.0)\n14.0 (8.0, 22.0)\n\n\noutcome\n\n\n\n\n\n\n    2\n4/106 (3.8%)\n2/109 (1.8%)\n\n\n    3\n3/106 (2.8%)\n3/109 (2.8%)\n\n\n    4\n99/106 (93%)\n104/109 (95%)\n\n\nHypertension\n21/105 (20%)\n20/106 (19%)\n\n\nMyocardial infarction\n1/105 (1.0%)\n0/108 (0%)\n\n\nAngina\n0/105 (0%)\n0/108 (0%)\n\n\nPerivascular\n1/103 (1.0%)\n0/108 (0%)\n\n\nChronic pulmonary\n3/104 (2.9%)\n3/108 (2.8%)\n\n\nConnective tissue\n0/105 (0%)\n0/108 (0%)\n\n\nMild liver\n26/105 (25%)\n31/108 (29%)\n\n\nHemiplegia\n0/105 (0%)\n1/108 (0.9%)\n\n\nDiabetes with chronic\n3/104 (2.9%)\n2/108 (1.9%)\n\n\nSevere liver\n4/105 (3.8%)\n0/109 (0%)\n\n\nAIDS\n0/105 (0%)\n0/109 (0%)\n\n\nCardiac failure III\n0/105 (0%)\n0/109 (0%)\n\n\nCerebrovascular\n2/105 (1.9%)\n2/108 (1.9%)\n\n\nSevere respiratory\n0/105 (0%)\n0/109 (0%)\n\n\nPeptic ulcer\n2/105 (1.9%)\n1/109 (0.9%)\n\n\nDiabetes\n11/104 (11%)\n4/109 (3.7%)\n\n\nSevere kidney\n4/105 (3.8%)\n2/109 (1.8%)\n\n\nMalignancy\n1/105 (1.0%)\n1/109 (0.9%)\n\n\nTumour\n0/104 (0%)\n0/109 (0%)\n\n\nDementia\n0/105 (0%)\n1/109 (0.9%)\n\n\nAcute Renal Failure\n4/106 (3.8%)\n0/109 (0%)\n\n\nElective surgery\n1/106 (0.9%)\n0/109 (0%)\n\n\nEmergency surgery\n7/106 (6.6%)\n6/109 (5.5%)\n\n\nDuration of illness (days)\n3.0 (2.0, 5.0)\n3.0 (2.0, 6.0)\n\n\nIncubation period (days)\n8.0 (6.0, 13.0)\n8.0 (5.0, 12.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n\n\nWound\n\n\n\n\n\n\n    1\n1/106 (0.9%)\n1/109 (0.9%)\n\n\n    2\n105/106 (99%)\n108/109 (99%)\n\n\nDifficulty breathing on admission\n6/106 (5.7%)\n5/109 (4.6%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n    I\n22/106 (21%)\n21/109 (19%)\n\n\n    II\n77/106 (73%)\n77/109 (71%)\n\n\n    III\n7/106 (6.6%)\n11/109 (10%)\n\n\nASA score\n\n\n\n\n\n\n    1\n60/106 (57%)\n53/109 (49%)\n\n\n    2\n36/106 (34%)\n52/109 (48%)\n\n\n    3\n10/106 (9.4%)\n4/109 (3.7%)\n\n\nMaximum temperature during 1st day\n37.5 (37.1, 37.6)\n37.5 (37.4, 37.6)\n\n\nRespiratory rate\n20.0 (20.0, 24.0)\n22.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.0 (96.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n107.0 (79.0, 144.0)\n120.0 (101.0, 144.0)\n\n\nPH\n7.5 (7.3, 7.5)\n7.4 (7.4, 7.5)\n\n\nPlatelet count\n279.5 (230.0, 326.0)\n274.0 (217.0, 322.0)\n\n\nWhite blood cell count\n8.8 (7.3, 11.5)\n8.8 (7.2, 10.9)\n\n\nHaematocrit\n41.3 (37.9, 44.0)\n42.0 (39.0, 44.4)\n\n\nMax HR\n92.0 (86.0, 100.0)\n92.0 (86.0, 104.0)\n\n\nMin HR\n76.0 (68.0, 84.0)\n76.0 (70.0, 88.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (130.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n\n\nVasopressors\n0/106 (0%)\n1/109 (0.9%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.7 (3.4, 3.9)\n3.7 (3.4, 3.9)\n\n\nCreatinine\n80.0 (66.0, 88.0)\n75.0 (65.0, 86.0)\n\n\nApache II score\n4.0 (2.0, 8.0)\n4.0 (2.0, 7.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\nClick to expand/collapse\n\n\nbaseline_data &lt;- baseline_data_raw %&gt;%\n  mutate(\n    Arm = recode(\n      arm,\n      \"equine and intrathecal\" = 0,\n      \"equine and sham\" = 0,\n      \"human and sham\" = 1,\n      \"human and intrathecal\" = 1\n    ),\n    Arm = ifelse(prehtig == 1, 2, Arm),\n    Arm = factor(\n      Arm,\n      levels = c(0, 1, 2),\n      labels = c(\"Equine IM\", \"Human IM\", \"Equine IM pre hospital\")\n    )\n  )\n\ngenerate_baseline_summary(baseline_data)\n\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nEquine IM N = 1081\nHuman IM N = 1091\nEquine IM pre hospital N = 541\n\n\n\n\nAge (years)\n50.0 (40.5, 61.0)\n48.0 (39.0, 59.0)\n48.5 (39.0, 56.0)\n\n\nSex\n\n\n\n\n\n\n\n\n    F\n22/108 (20%)\n17/109 (16%)\n5/54 (9.3%)\n\n\n    M\n86/108 (80%)\n92/109 (84%)\n49/54 (91%)\n\n\nBMI (kg/m2)\n21.6 (19.9, 23.4)\n20.9 (19.5, 22.8)\n21.5 (20.2, 23.5)\n\n\nSource\n\n\n\n\n\n\n\n\n    1\n30/108 (28%)\n31/109 (28%)\n0/54 (0%)\n\n\n    2\n78/108 (72%)\n78/109 (72%)\n54/54 (100%)\n\n\nTetanus\n108/108 (100%)\n109/109 (100%)\n54/54 (100%)\n\n\nDays in ICU\n12.5 (7.0, 22.0)\n14.0 (8.0, 22.0)\n17.5 (12.0, 23.0)\n\n\noutcome\n\n\n\n\n\n\n\n\n    2\n4/108 (3.7%)\n2/109 (1.8%)\n1/54 (1.9%)\n\n\n    3\n3/108 (2.8%)\n3/109 (2.8%)\n1/54 (1.9%)\n\n\n    4\n101/108 (94%)\n104/109 (95%)\n52/54 (96%)\n\n\nHypertension\n21/107 (20%)\n20/106 (19%)\n7/53 (13%)\n\n\nMyocardial infarction\n1/107 (0.9%)\n0/108 (0%)\n0/53 (0%)\n\n\nAngina\n0/107 (0%)\n0/108 (0%)\n0/54 (0%)\n\n\nPerivascular\n1/105 (1.0%)\n0/108 (0%)\n0/54 (0%)\n\n\nChronic pulmonary\n3/106 (2.8%)\n3/108 (2.8%)\n1/54 (1.9%)\n\n\nConnective tissue\n0/107 (0%)\n0/108 (0%)\n0/54 (0%)\n\n\nMild liver\n26/107 (24%)\n31/108 (29%)\n11/54 (20%)\n\n\nHemiplegia\n0/107 (0%)\n1/108 (0.9%)\n0/54 (0%)\n\n\nDiabetes with chronic\n3/106 (2.8%)\n2/108 (1.9%)\n0/53 (0%)\n\n\nSevere liver\n4/107 (3.7%)\n0/109 (0%)\n1/54 (1.9%)\n\n\nAIDS\n0/107 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nCardiac failure III\n0/107 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nCerebrovascular\n2/107 (1.9%)\n2/108 (1.9%)\n1/54 (1.9%)\n\n\nSevere respiratory\n0/107 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nPeptic ulcer\n2/107 (1.9%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nDiabetes\n11/106 (10%)\n4/109 (3.7%)\n3/53 (5.7%)\n\n\nSevere kidney\n4/107 (3.7%)\n2/109 (1.8%)\n0/54 (0%)\n\n\nMalignancy\n1/107 (0.9%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nTumour\n0/106 (0%)\n0/109 (0%)\n0/54 (0%)\n\n\nDementia\n0/107 (0%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nAcute Renal Failure\n4/108 (3.7%)\n0/109 (0%)\n0/54 (0%)\n\n\nElective surgery\n1/108 (0.9%)\n0/109 (0%)\n1/54 (1.9%)\n\n\nEmergency surgery\n7/108 (6.5%)\n6/109 (5.5%)\n2/54 (3.7%)\n\n\nDuration of illness (days)\n3.0 (2.5, 5.0)\n3.0 (2.0, 6.0)\n3.0 (2.0, 4.0)\n\n\nIncubation period (days)\n8.0 (6.0, 14.0)\n8.0 (5.0, 12.0)\n10.0 (6.0, 14.0)\n\n\nPeriod of onset (days)\n48.0 (24.0, 72.0)\n48.0 (24.0, 72.0)\n48.0 (24.0, 92.0)\n\n\nWound\n\n\n\n\n\n\n\n\n    1\n1/108 (0.9%)\n1/109 (0.9%)\n0/54 (0%)\n\n\n    2\n107/108 (99%)\n108/109 (99%)\n54/54 (100%)\n\n\nDifficulty breathing on admission\n6/108 (5.6%)\n5/109 (4.6%)\n4/54 (7.4%)\n\n\nAblett Score on admission\n\n\n\n\n\n\n\n\n    I\n22/108 (20%)\n21/109 (19%)\n4/54 (7.4%)\n\n\n    II\n79/108 (73%)\n77/109 (71%)\n44/54 (81%)\n\n\n    III\n7/108 (6.5%)\n11/109 (10%)\n6/54 (11%)\n\n\nASA score\n\n\n\n\n\n\n\n\n    1\n61/108 (56%)\n53/109 (49%)\n34/54 (63%)\n\n\n    2\n37/108 (34%)\n52/109 (48%)\n16/54 (30%)\n\n\n    3\n10/108 (9.3%)\n4/109 (3.7%)\n4/54 (7.4%)\n\n\nMaximum temperature during 1st day\n37.5 (37.1, 37.6)\n37.5 (37.4, 37.6)\n37.4 (37.0, 37.6)\n\n\nRespiratory rate\n20.0 (20.0, 23.5)\n22.0 (20.0, 24.0)\n22.0 (20.0, 24.0)\n\n\nFiO2\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n21.0 (21.0, 21.0)\n\n\nSpO2\n96.5 (96.0, 97.0)\n96.0 (95.0, 97.0)\n96.0 (95.0, 97.0)\n\n\nPAO2\n107.0 (79.0, 144.0)\n120.0 (101.0, 144.0)\n105.0 (98.0, 127.0)\n\n\nPH\n7.5 (7.3, 7.5)\n7.4 (7.4, 7.5)\n7.4 (7.3, 7.5)\n\n\nPlatelet count\n276.0 (228.5, 325.5)\n274.0 (217.0, 322.0)\n293.5 (246.0, 346.0)\n\n\nWhite blood cell count\n8.7 (7.3, 11.5)\n8.8 (7.2, 10.9)\n9.8 (8.2, 11.2)\n\n\nHaematocrit\n41.3 (37.9, 44.0)\n42.0 (39.0, 44.4)\n41.0 (38.0, 42.8)\n\n\nMax HR\n92.0 (85.0, 100.0)\n92.0 (86.0, 104.0)\n93.0 (80.0, 100.0)\n\n\nMin HR\n76.0 (68.0, 84.0)\n76.0 (70.0, 88.0)\n76.0 (68.0, 84.0)\n\n\nMax SBP\n140.0 (120.0, 150.0)\n140.0 (130.0, 150.0)\n130.0 (120.0, 150.0)\n\n\nWorst DBP\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n80.0 (80.0, 90.0)\n\n\nWorst SBP\n140.0 (120.0, 150.0)\n140.0 (120.0, 150.0)\n130.0 (120.0, 150.0)\n\n\nVasopressors\n0/108 (0%)\n1/109 (0.9%)\n0/54 (0%)\n\n\nSodium\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n139.0 (137.0, 141.0)\n\n\nPotassium\n3.7 (3.4, 3.9)\n3.7 (3.4, 3.9)\n3.6 (3.4, 3.8)\n\n\nCreatinine\n80.0 (66.0, 89.0)\n75.0 (65.0, 86.0)\n74.0 (63.0, 82.0)\n\n\nApache II score\n4.0 (2.0, 8.0)\n4.0 (2.0, 7.0)\n3.0 (1.0, 6.0)\n\n\n\n1 Median (Q1, Q3); n/N (%)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4. Adverse event table\n\n\nImport adverse event data\n\n\n# Define file path\nae_file_path &lt;- here::here(\"data\", \"AE.SAE DATA SHEET.xls\")\n\n#Import AEs and SAEs data\n\nsae_gridae &lt;- read_excel(ae_file_path,sheet = \"S_AE_GridAE\")\nsae_gridsae &lt;- read_excel(ae_file_path,sheet = \"S_AE_GridSAE\")\n\nNew names:\n• `` -&gt; `...3`\n\nnames(sae_gridae) &lt;- tolower(names(sae_gridae))\nnames(sae_gridsae) &lt;- tolower(names(sae_gridsae))\n\nsae_gridae &lt;- sae_gridae %&gt;%\n  filter(!usubjid %in% excluded_subjects)\n\nsae_gridsae &lt;- sae_gridsae %&gt;%\n  filter(!usubjid %in% excluded_subjects)\n\n\nAccording to the protocol, the following events will be excluded from adverse event reporting AE.SAE DATA SHEET: SAE_GRID_AE.CTCAENAME = “Nasogastric tube”; “Urinary Catheter”; “Tracheostomy”; “Mechanical ventilation” and “ANSD”.\nUse filter function\n\n\nFilter events that do not belong to adverse event\n\n\nany_ae &lt;- sae_gridae %&gt;% \n  filter(ctcaename!=\"Nasogastric tube\" & ctcaename!=\"Urinary Catheter\" & ctcaename!=\"Tracheostomy\" & ctcaename!=\"Mechanical ventilation\" & ctcaename!=\"ANSD\") \n\nany_ae &lt;- upData(\n  any_ae,\n  labels = c(\n    ctcaename = \"Adverse event names\",\n    posrelunrel = \"Relatedness to treatment\",\n    unexp = \"Unexpected AEs\"\n  )\n)\n\nInput object size:   131048 bytes;   17 variables    534 observations\nNew object size:    126280 bytes;   17 variables    534 observations\n\n\n\nIn this exercise, I will create the adverse event for the IT_ITT only. You can filter the data to create tables for other populations. Let’s first add the Arm information from baseline data to the any_ae by left_join\n\n\nPrepare population for IT_ITT and add Arm to any_ae\n\n\n# Prepare baseline data\nbaseline_data &lt;- baseline_data_raw %&gt;% \n  mutate( \n    Arm = recode(arm, \n                 \"equine and intrathecal\" = 0, \n                 \"human and intrathecal\" = 0,\n                 \"human and sham\" = 1,\n                 \"equine and sham\" = 1),\n    Arm = factor(Arm, levels = c(0,1), labels = c(\"Intrathecal treatment\", \"Sham procedure\"))\n  )\n\ndata_ae &lt;- any_ae %&gt;% left_join(select(baseline_data, c(usubjid, Arm)))\n\nJoining with `by = join_by(usubjid)`\n\n\n\nAs I mentioned in the capstone exercise, you can adjust the tables format based on your experience and needs. In this section, I use the format that looks like a published paper from OUCRU’s project in NEJM (link).\n\nIf you’re unsure where to start, don’t worry—let’s break it down step by step.\n\nCount occurrences: Create two separate data frames—one for the number of participants and another for the number of events for each type of adverse event, stratified by study arm.\n\nCalculate percentages: Determine the total number of participants (full IDs) and compute the percentage for each adverse event.\n\nMerge data: Join the two data frames into a single table.\n\n(Optional) Statistical test: Compute the p-value using a chi-square or Fisher’s exact test. While p-values are generally not recommended for adverse event tables, some journals require them.\n\nFormat the table: Use the gt package to convert the final data frame into a customized, publication-ready table.\n\n\n\n1. Create two counting tables\n\n\ncreate_summary_table &lt;- function(data, arm_name, total_subjects) {\n  summary_table &lt;- data %&gt;%\n    filter(Arm == arm_name) %&gt;%\n    count(ctcaename, name = \"n episode\") %&gt;%\n    left_join(\n      data %&gt;%\n        filter(Arm == arm_name) %&gt;%\n        distinct(ctcaename, usubjid) %&gt;%  # Ensure unique patient-event pairs\n        count(ctcaename, name = \"n patient\"),\n      by = \"ctcaename\"\n    ) %&gt;%\n    arrange(desc(`n episode`)) %&gt;%\n    mutate(ctcaename = as.character(ctcaename))\n\n  # **Fix total row:**\n  total_unique_patients &lt;- data %&gt;%\n    filter(Arm == arm_name) %&gt;%\n    distinct(usubjid) %&gt;%\n    nrow()  # Count unique patients with any adverse event\n\n  total_row &lt;- tibble(\n    ctcaename = \"Total\",\n    `n episode` = sum(summary_table$`n episode`, na.rm = TRUE),\n    `n patient` = total_unique_patients  # Correct total count of affected patients\n  )\n\n  bind_rows(total_row, summary_table) %&gt;%\n    mutate(`n patient (%)` = sprintf(\"%d (%.1f%%)\", `n patient`, `n patient` / total_subjects * 100))\n}\n\n# Get total subjects per arm\ntotal_subjects &lt;- baseline_data %&gt;%\n  group_by(Arm) %&gt;%\n  summarise(total = n_distinct(usubjid), .groups = \"drop\")\n\n# Create tables for both arms\nsummary_intrathecal &lt;- create_summary_table(data_ae, \"Intrathecal treatment\", total_subjects$total[total_subjects$Arm == \"Intrathecal treatment\"])\nsummary_sham &lt;- create_summary_table(data_ae, \"Sham procedure\", total_subjects$total[total_subjects$Arm == \"Sham procedure\"])\n\n\n\n\n2&3. Calculate percentage and merge table\n\n\nfinal_summary &lt;- full_join(summary_intrathecal, summary_sham, by = \"ctcaename\", suffix = c(\" (Intrathecal)\", \" (Sham)\")) %&gt;%\n  mutate(across(where(is.numeric) & (contains(\"n episode\") | contains(\"n patient\")), ~ replace_na(., 0))) %&gt;%\n  mutate(\n    `n patient (%) (Sham)` = sprintf(\"%d (%.1f%%)\", `n patient (Sham)`, `n patient (Sham)` / total_subjects$total[total_subjects$Arm == \"Sham procedure\"] * 100),\n    `n patient (%) (Intrathecal)` = sprintf(\"%d (%.1f%%)\", `n patient (Intrathecal)`, `n patient (Intrathecal)` / total_subjects$total[total_subjects$Arm == \"Intrathecal treatment\"] * 100)\n  )\n\n\n\n\n4. Calculate p-values\n\n\n# Calculate p-values\ncompute_p_value &lt;- function(sham, intrathecal, sham_total, intrathecal_total) {\n  if (sham + intrathecal &gt; 0) {\n    matrix_data &lt;- matrix(c(sham, sham_total - sham, intrathecal, intrathecal_total - intrathecal), nrow = 2, byrow = TRUE)\n    format.pval(fisher.test(matrix_data)$p.value, digits = 3, eps = 0.001)\n  } else {\n    NA\n  }\n}\n\nfinal_summary &lt;- final_summary %&gt;%\n  rowwise() %&gt;%\n  mutate(`p value` = compute_p_value(`n patient (Sham)`, `n patient (Intrathecal)`,\n                                     total_subjects$total[total_subjects$Arm == \"Sham procedure\"],\n                                     total_subjects$total[total_subjects$Arm == \"Intrathecal treatment\"])) %&gt;%\n  ungroup()\n\n# Keep relevant columns\nfinal_summary &lt;- final_summary %&gt;%\n  select(\n    ctcaename,\n    `n episode (Sham)`, `n patient (%) (Sham)`,\n    `n episode (Intrathecal)`, `n patient (%) (Intrathecal)`,\n    `p value`\n  )\n\n\n\n\n5. Turn data frame to customized formatted table\n\n\n# Convert to gt table with grouped headers\nfinal_summary_gt &lt;- final_summary %&gt;%\n  gt() %&gt;%\n  tab_header(title = md(\"**Comparison of Adverse Events by Arm**\")) %&gt;%\n  cols_label(\n    ctcaename = md(\"**Type of adverse event**\"),\n    `n episode (Sham)` = md(\"**n episode**\"),\n    `n patient (%) (Sham)` = md(\"**n patient**\"),\n    `n episode (Intrathecal)` = md(\"**n episode**\"),\n    `n patient (%) (Intrathecal)` = md(\"**n patient**\"),\n    `p value` = md(\"**p value**\")\n  ) %&gt;%\n  tab_spanner(\n    label = md(sprintf(\"**Sham procedure (N=%d)**\", total_subjects$total[total_subjects$Arm == \"Sham procedure\"])),\n    columns = c(`n episode (Sham)`, `n patient (%) (Sham)`)\n  ) %&gt;%\n  tab_spanner(\n    label = md(sprintf(\"**Intrathecal treatment (N=%d)**\", total_subjects$total[total_subjects$Arm == \"Intrathecal treatment\"])),\n    columns = c(`n episode (Intrathecal)`, `n patient (%) (Intrathecal)`)\n  ) %&gt;%\n  fmt_number(columns = starts_with(\"n episode\"), decimals = 0) %&gt;%\n  tab_options(table.font.size = \"medium\") %&gt;%\n  tab_style(\n    style = list(cell_text(weight = \"bold\")),\n    locations = cells_body(rows = 1)  # Bold the total row\n  )\n\n# Print the table\nfinal_summary_gt\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nComparison of Adverse Events by Arm\n\n\nType of adverse event\n\nSham procedure (N=135)\n\n\nIntrathecal treatment (N=136)\n\np value\n\n\nn episode\nn patient\nn episode\nn patient\n\n\n\n\nTotal\n283\n88 (65.2%)\n251\n84 (61.8%)\n0.614\n\n\nVentilator associated pneumonia\n36\n30 (22.2%)\n28\n23 (16.9%)\n0.287\n\n\nHypokalemia\n30\n29 (21.5%)\n21\n21 (15.4%)\n0.214\n\n\nUTI\n34\n31 (23.0%)\n20\n18 (13.2%)\n0.041\n\n\nConstipation\n19\n18 (13.3%)\n19\n19 (14.0%)\n1\n\n\nHypocalcemia\n17\n17 (12.6%)\n15\n15 (11.0%)\n0.711\n\n\nHyponatremia\n13\n13 (9.6%)\n14\n14 (10.3%)\n1\n\n\nTracheal hemorrhage\n3\n3 (2.2%)\n13\n13 (9.6%)\n0.018\n\n\nUpper gastrointestinal hemorrhage\n11\n11 (8.1%)\n11\n9 (6.6%)\n0.651\n\n\nBlood stream infection\n8\n8 (5.9%)\n9\n9 (6.6%)\n1\n\n\nHeadache\n0\n0 (0.0%)\n8\n8 (5.9%)\n0.007\n\n\nSkin allergy\n9\n9 (6.7%)\n6\n6 (4.4%)\n0.441\n\n\nFever\n0\n0 (0.0%)\n5\n5 (3.7%)\n0.06\n\n\nNose bleed\n2\n2 (1.5%)\n5\n5 (3.7%)\n0.447\n\n\nArthritis\n1\n1 (0.7%)\n4\n3 (2.2%)\n0.622\n\n\nGastritis\n1\n1 (0.7%)\n4\n4 (2.9%)\n0.37\n\n\nHypomagnesemia\n4\n4 (3.0%)\n4\n4 (2.9%)\n1\n\n\nDizziness\n1\n1 (0.7%)\n3\n3 (2.2%)\n0.622\n\n\nOral infection\n1\n1 (0.7%)\n3\n3 (2.2%)\n0.622\n\n\nUpper respiratory infection\n1\n1 (0.7%)\n3\n3 (2.2%)\n0.622\n\n\nAnemia\n9\n7 (5.2%)\n2\n2 (1.5%)\n0.103\n\n\nArterial thromboembolism\n0\n0 (0.0%)\n2\n2 (1.5%)\n0.498\n\n\nAspiration pneumonia\n6\n6 (4.4%)\n2\n2 (1.5%)\n0.172\n\n\nConjunctivitis\n3\n3 (2.2%)\n2\n2 (1.5%)\n0.684\n\n\nFailed extubation\n0\n0 (0.0%)\n2\n2 (1.5%)\n0.498\n\n\nHemorrhoids\n1\n1 (0.7%)\n2\n2 (1.5%)\n1\n\n\nHospital acquired pneumonia\n2\n2 (1.5%)\n2\n2 (1.5%)\n1\n\n\nMyocardial ischaemia\n1\n1 (0.7%)\n2\n2 (1.5%)\n1\n\n\nPhlebitis\n6\n6 (4.4%)\n2\n2 (1.5%)\n0.172\n\n\nUrinary retention\n1\n1 (0.7%)\n2\n2 (1.5%)\n1\n\n\nWound bleed\n0\n0 (0.0%)\n2\n2 (1.5%)\n0.498\n\n\nWound infection\n1\n1 (0.7%)\n2\n2 (1.5%)\n1\n\n\narthralgia\n1\n1 (0.7%)\n2\n2 (1.5%)\n1\n\n\nAcute renal failure\n3\n3 (2.2%)\n1\n1 (0.7%)\n0.37\n\n\nAdrenal insufficiency\n2\n2 (1.5%)\n1\n1 (0.7%)\n0.622\n\n\nAllergy\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nAtrial thrombosis\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nBack pain\n1\n1 (0.7%)\n1\n1 (0.7%)\n1\n\n\nBruising\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nCellulitis\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nCerebral hemorrhage\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nChills\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nChronic venous insufficiency\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nCreatinine increase\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nDeep vein thrombosis\n3\n3 (2.2%)\n1\n1 (0.7%)\n0.37\n\n\nDysphagia\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nHematuria\n2\n2 (1.5%)\n1\n1 (0.7%)\n0.622\n\n\nHiccup\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nHyperglycaemia\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nHyperpyrexia\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nHypotension\n6\n5 (3.7%)\n1\n1 (0.7%)\n0.12\n\n\nInsomnia\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nLow weight, muscle wasting\n2\n2 (1.5%)\n1\n1 (0.7%)\n0.622\n\n\nMyocarditis\n1\n1 (0.7%)\n1\n1 (0.7%)\n1\n\n\nNausea\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nNecrotic wound\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nOtitis\n2\n2 (1.5%)\n1\n1 (0.7%)\n0.622\n\n\nPostoperative hemorrage\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nPressure ulcer\n4\n4 (3.0%)\n1\n1 (0.7%)\n0.214\n\n\nPyloric stenosis\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nSpinal disc herniation\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nTorticolis\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\npharyngitis\n0\n0 (0.0%)\n1\n1 (0.7%)\n1\n\n\nCardiac arrest\n3\n3 (2.2%)\n0\n0 (0.0%)\n0.122\n\n\nVoice alteration\n3\n3 (2.2%)\n0\n0 (0.0%)\n0.122\n\n\nAtrial fibrillation\n2\n2 (1.5%)\n0\n0 (0.0%)\n0.247\n\n\nHypernatremia\n2\n2 (1.5%)\n0\n0 (0.0%)\n0.247\n\n\nPlatelet count decreased\n2\n2 (1.5%)\n0\n0 (0.0%)\n0.247\n\n\nSinus bradycardia\n2\n2 (1.5%)\n0\n0 (0.0%)\n0.247\n\n\nViral infection\n2\n2 (1.5%)\n0\n0 (0.0%)\n0.247\n\n\nAppendicitis\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nArthralgia\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nCerbral infarction\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nCholangitis\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nGastrointestinal disorder\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nHeat stroke\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nHypertension\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nHypoalbuminemia\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nMyalgia\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nNeuralgia\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nPleural abscess\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nPneumothorax\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nPruritus\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nRecurrent tetanus\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nRhabdomyolysis\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nSinusitis\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nSubcutaneous emphysema\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nTracheal stenosis\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\nfacial nerve disorder\n1\n1 (0.7%)\n0\n0 (0.0%)\n0.498\n\n\n\n\n\n\n\n\nNow, let’s wrap our code into a single function so it can be applied to other populations. However, turning these code snippets into a function might be challenging. Even if you successfully write the function, it could take a significant amount of time.\n\n\n6. Wrap all codes into a function\n\n\ncreate_summary_table &lt;- function(data_ae, baseline_data, arm_var, ae_var, id_var) {\n  # Get unique treatment arms\n  treatment_arms &lt;- unique(baseline_data[[arm_var]])\n  \n  # Get total subjects per arm\n  total_subjects &lt;- baseline_data %&gt;%\n    group_by(across(all_of(arm_var))) %&gt;%\n    summarise(total = n_distinct(across(all_of(id_var))), .groups = \"drop\")\n  \n  # Function to create summary for each arm\n  summarize_arm &lt;- function(arm_name) {\n    summary_table &lt;- data_ae %&gt;%\n      filter(.data[[arm_var]] == arm_name) %&gt;%\n      count(.data[[ae_var]], name = \"n episode\") %&gt;%\n      left_join(\n        data_ae %&gt;%\n          filter(.data[[arm_var]] == arm_name) %&gt;%\n          distinct(across(all_of(ae_var)), across(all_of(id_var))) %&gt;%\n          count(.data[[ae_var]], name = \"n patient\"),\n        by = ae_var\n      ) %&gt;%\n      arrange(desc(`n episode`)) %&gt;%\n      mutate(across(all_of(ae_var), as.character))\n    \n    total_unique_patients &lt;- data_ae %&gt;%\n      filter(.data[[arm_var]] == arm_name) %&gt;%\n      distinct(across(all_of(id_var))) %&gt;%\n      nrow()\n    \n    total_row &lt;- tibble(\n      !!ae_var := \"Total\",\n      `n episode` = sum(summary_table$`n episode`, na.rm = TRUE),\n      `n patient` = total_unique_patients\n    )\n    \n    summary_table &lt;- bind_rows(total_row, summary_table) %&gt;%\n      mutate(`n patient (%)` = sprintf(\"%d (%.1f%%)\", `n patient`, `n patient` / total_subjects$total[total_subjects[[arm_var]] == arm_name] * 100)) %&gt;%\n      select(-`n patient`)  # Remove \"n patient\" column\n    \n    return(summary_table)\n  }\n  \n  # Create summary tables for each arm\n  summaries &lt;- lapply(treatment_arms, summarize_arm)\n  names(summaries) &lt;- treatment_arms\n  \n  # Merge summaries dynamically\n  final_summary &lt;- Reduce(function(x, y) {\n    full_join(x, y, by = ae_var, suffix = c(\"_1\", \"_2\"))  # Use _1 and _2 instead of arm names\n  }, summaries)\n  \n  # Replace NA values **after** full_join()\n  final_summary &lt;- final_summary %&gt;%\n    mutate(\n      across(where(is.numeric) & contains(\"n episode\"), ~ replace_na(., 0)), # Replace NA in \"n episode\" with 0\n      across(where(is.character) & contains(\"n patient (%)\"), ~ replace_na(., \"0 (0%)\")) # Replace NA in \"n patient (%)\" with \"0 (0%)\"\n    )\n  \n  # Compute p-values\n  compute_p_value &lt;- function(arm1, arm2, total1, total2) {\n    if (!is.na(arm1) && !is.na(arm2) && arm1 + arm2 &gt; 0) {\n      matrix_data &lt;- matrix(c(arm1, total1 - arm1, arm2, total2 - arm2), nrow = 2, byrow = TRUE)\n      format.pval(fisher.test(matrix_data)$p.value, digits = 3, eps = 0.001)\n    } else {\n      NA\n    }\n  }\n  \n  if (length(treatment_arms) == 2) {\n    final_summary &lt;- final_summary %&gt;%\n      rowwise() %&gt;%\n      mutate(`p value` = compute_p_value(\n        as.numeric(str_extract(.data[[\"n patient (%)_1\"]], \"^\\\\d+\")),\n        as.numeric(str_extract(.data[[\"n patient (%)_2\"]], \"^\\\\d+\")),\n        total_subjects$total[total_subjects[[arm_var]] == treatment_arms[1]],\n        total_subjects$total[total_subjects[[arm_var]] == treatment_arms[2]]\n      )) %&gt;%\n      ungroup()\n  }\n  \n  # Generate the base table\n  final_summary_gt &lt;- final_summary %&gt;%\n    gt() %&gt;%\n    tab_header(title = md(\"**Comparison of Adverse Events by Arm**\")) %&gt;%\n    cols_label(\n      !!ae_var := md(\"**Type of adverse event**\"),\n      `n episode_1` = \"n episode\",\n      `n patient (%)_1` = \"n patient (%)\",\n      `n episode_2` = \"n episode\",\n      `n patient (%)_2` = \"n patient (%)\",\n      `p value` = md(\"**p value**\")\n    ) %&gt;%\n    fmt_number(columns = starts_with(\"n episode\"), decimals = 0) %&gt;%\n    tab_options(table.font.size = \"medium\") %&gt;%\n    tab_style(\n      style = list(cell_text(weight = \"bold\")),\n      locations = cells_body(rows = 1)  # Bold the total row\n    )\n\n  # Dynamically add tab_spanner() for each unique arm\n  for (i in seq_along(treatment_arms)) {\n    arm &lt;- treatment_arms[i]\n    arm_total &lt;- total_subjects$total[total_subjects[[arm_var]] == arm]\n    \n    # Find column names that belong to this arm\n    arm_cols &lt;- colnames(final_summary)[grepl(paste0(\"_\", i), colnames(final_summary))]\n    \n    # Add the spanner dynamically\n    final_summary_gt &lt;- final_summary_gt %&gt;%\n      tab_spanner(\n        label = md(sprintf(\"**%s (N=%d)**\", arm, arm_total)),\n        columns = all_of(arm_cols)\n      )\n  }\n\n  # Display the table\n  return(final_summary_gt)\n}\n\n\ncreate_summary_table(data_ae = data_ae, baseline_data = baseline_data, arm_var = \"Arm\", ae_var = \"ctcaename\", id_var = \"usubjid\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nComparison of Adverse Events by Arm\n\n\nType of adverse event\n\nIntrathecal treatment (N=136)\n\n\nSham procedure (N=135)\n\np value\n\n\nn episode\nn patient (%)\nn episode\nn patient (%)\n\n\n\n\nTotal\n251\n84 (61.8%)\n283\n88 (65.2%)\n0.614\n\n\nVentilator associated pneumonia\n28\n23 (16.9%)\n36\n30 (22.2%)\n0.287\n\n\nHypokalemia\n21\n21 (15.4%)\n30\n29 (21.5%)\n0.214\n\n\nUTI\n20\n18 (13.2%)\n34\n31 (23.0%)\n0.041\n\n\nConstipation\n19\n19 (14.0%)\n19\n18 (13.3%)\n1\n\n\nHypocalcemia\n15\n15 (11.0%)\n17\n17 (12.6%)\n0.711\n\n\nHyponatremia\n14\n14 (10.3%)\n13\n13 (9.6%)\n1\n\n\nTracheal hemorrhage\n13\n13 (9.6%)\n3\n3 (2.2%)\n0.018\n\n\nUpper gastrointestinal hemorrhage\n11\n9 (6.6%)\n11\n11 (8.1%)\n0.651\n\n\nBlood stream infection\n9\n9 (6.6%)\n8\n8 (5.9%)\n1\n\n\nHeadache\n8\n8 (5.9%)\n0\n0 (0%)\n0.007\n\n\nSkin allergy\n6\n6 (4.4%)\n9\n9 (6.7%)\n0.441\n\n\nFever\n5\n5 (3.7%)\n0\n0 (0%)\n0.06\n\n\nNose bleed\n5\n5 (3.7%)\n2\n2 (1.5%)\n0.447\n\n\nArthritis\n4\n3 (2.2%)\n1\n1 (0.7%)\n0.622\n\n\nGastritis\n4\n4 (2.9%)\n1\n1 (0.7%)\n0.37\n\n\nHypomagnesemia\n4\n4 (2.9%)\n4\n4 (3.0%)\n1\n\n\nDizziness\n3\n3 (2.2%)\n1\n1 (0.7%)\n0.622\n\n\nOral infection\n3\n3 (2.2%)\n1\n1 (0.7%)\n0.622\n\n\nUpper respiratory infection\n3\n3 (2.2%)\n1\n1 (0.7%)\n0.622\n\n\nAnemia\n2\n2 (1.5%)\n9\n7 (5.2%)\n0.103\n\n\nArterial thromboembolism\n2\n2 (1.5%)\n0\n0 (0%)\n0.498\n\n\nAspiration pneumonia\n2\n2 (1.5%)\n6\n6 (4.4%)\n0.172\n\n\nConjunctivitis\n2\n2 (1.5%)\n3\n3 (2.2%)\n0.684\n\n\nFailed extubation\n2\n2 (1.5%)\n0\n0 (0%)\n0.498\n\n\nHemorrhoids\n2\n2 (1.5%)\n1\n1 (0.7%)\n1\n\n\nHospital acquired pneumonia\n2\n2 (1.5%)\n2\n2 (1.5%)\n1\n\n\nMyocardial ischaemia\n2\n2 (1.5%)\n1\n1 (0.7%)\n1\n\n\nPhlebitis\n2\n2 (1.5%)\n6\n6 (4.4%)\n0.172\n\n\nUrinary retention\n2\n2 (1.5%)\n1\n1 (0.7%)\n1\n\n\nWound bleed\n2\n2 (1.5%)\n0\n0 (0%)\n0.498\n\n\nWound infection\n2\n2 (1.5%)\n1\n1 (0.7%)\n1\n\n\narthralgia\n2\n2 (1.5%)\n1\n1 (0.7%)\n1\n\n\nAcute renal failure\n1\n1 (0.7%)\n3\n3 (2.2%)\n0.37\n\n\nAdrenal insufficiency\n1\n1 (0.7%)\n2\n2 (1.5%)\n0.622\n\n\nAllergy\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nAtrial thrombosis\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nBack pain\n1\n1 (0.7%)\n1\n1 (0.7%)\n1\n\n\nBruising\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nCellulitis\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nCerebral hemorrhage\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nChills\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nChronic venous insufficiency\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nCreatinine increase\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nDeep vein thrombosis\n1\n1 (0.7%)\n3\n3 (2.2%)\n0.37\n\n\nDysphagia\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nHematuria\n1\n1 (0.7%)\n2\n2 (1.5%)\n0.622\n\n\nHiccup\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nHyperglycaemia\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nHyperpyrexia\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nHypotension\n1\n1 (0.7%)\n6\n5 (3.7%)\n0.12\n\n\nInsomnia\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nLow weight, muscle wasting\n1\n1 (0.7%)\n2\n2 (1.5%)\n0.622\n\n\nMyocarditis\n1\n1 (0.7%)\n1\n1 (0.7%)\n1\n\n\nNausea\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nNecrotic wound\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nOtitis\n1\n1 (0.7%)\n2\n2 (1.5%)\n0.622\n\n\nPostoperative hemorrage\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nPressure ulcer\n1\n1 (0.7%)\n4\n4 (3.0%)\n0.214\n\n\nPyloric stenosis\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nSpinal disc herniation\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nTorticolis\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\npharyngitis\n1\n1 (0.7%)\n0\n0 (0%)\n1\n\n\nCardiac arrest\n0\n0 (0%)\n3\n3 (2.2%)\n0.122\n\n\nVoice alteration\n0\n0 (0%)\n3\n3 (2.2%)\n0.122\n\n\nAtrial fibrillation\n0\n0 (0%)\n2\n2 (1.5%)\n0.247\n\n\nHypernatremia\n0\n0 (0%)\n2\n2 (1.5%)\n0.247\n\n\nPlatelet count decreased\n0\n0 (0%)\n2\n2 (1.5%)\n0.247\n\n\nSinus bradycardia\n0\n0 (0%)\n2\n2 (1.5%)\n0.247\n\n\nViral infection\n0\n0 (0%)\n2\n2 (1.5%)\n0.247\n\n\nAppendicitis\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nArthralgia\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nCerbral infarction\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nCholangitis\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nGastrointestinal disorder\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nHeat stroke\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nHypertension\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nHypoalbuminemia\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nMyalgia\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nNeuralgia\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nPleural abscess\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nPneumothorax\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nPruritus\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nRecurrent tetanus\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nRhabdomyolysis\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nSinusitis\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nSubcutaneous emphysema\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nTracheal stenosis\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\nfacial nerve disorder\n0\n0 (0%)\n1\n1 (0.7%)\n0.498\n\n\n\n\n\n\n\n\nIf you’ve already invested time in creating your function, why not share it with others by publishing it on GitHub? This way, others can save time by adapting your work. Alternatively, as a user, you might save time by finding an existing package that meets your needs.\nIn fact, OUCRU Biostat has an in-house package C306 designed for this task—let’s take a look at it. Take a note that sstable.ae function from C306 has many arguments for many additional features in the table. There are many other useful functions in C306 such as: sstable.baseline to make the baseline table and sstable.survcomp to create survival comparison table.\n\n\nAlternative method: use OUCRU Biostat in-house package\n\n\n# library(devtools)\n# devtools::install_github(\"oucru-biostats/C306@feature-rmst\")\nlibrary(C306)\n\nae_table &lt;- sstable.ae(\n  ae_data = any_ae,\n  fullid_data = baseline_data,\n  id.var = \"usubjid\",\n  aetype.var = c(\"ctcaename\", \"posrelunrel\", \"unexp\"), # can combine three different tables into one\n  grade.var = \"original_ctcaegrade\", \n  arm.var = \"Arm\",\n  sort.by = ~ +p -ep -pt, # arrange in order of ascending for p_value and descending for episodes and patients.\n  digits = 2,\n  test = TRUE, # switch on and off the p-value\n  test.anyae.only = FALSE, #show p value for all of the rows\n  pdigits = 3,\n  pcutoff = 0.001,\n  chisq.test = F,\n  footer = c(\"Example footnote for adverse event summary table.\"),\n  flextable = T,\n  bg = \"#F2EFEE\"\n)\n\nae_table\n\nSham procedure (N=135)Intrathecal treatment (N=136)p valueType of adverse eventn episoden patientn episoden patientAny selected adverse event28388 (65.19%)25184 (61.76%)0.614- Grade I2423 (17.04%)3125 (18.38%)0.874- Grade II10255 (40.74%)10755 (40.44%)1- Grade III3523 (17.04%)1917 (12.50%)0.309- Grade IV55 (3.70%)55 (3.68%)1- Grade NA11762 (45.93%)8958 (42.65%)0.626Adverse event names28388 (65.19%)25184 (61.76%)0.614Headache00 (0.00%)88 (5.88%)0.00703Tracheal hemorrhage33 (2.22%)1313 (9.56%)0.0177UTI3431 (22.96%)2018 (13.24%)0.0411Fever00 (0.00%)55 (3.68%)0.0602Anemia97 (5.19%)22 (1.47%)0.103Hypotension65 (3.70%)11 (0.74%)0.12Cardiac arrest33 (2.22%)00 (0.00%)0.122Voice alteration33 (2.22%)00 (0.00%)0.122Phlebitis66 (4.44%)22 (1.47%)0.172Aspiration pneumonia66 (4.44%)22 (1.47%)0.172Hypokalemia3029 (21.48%)2121 (15.44%)0.214Pressure ulcer44 (2.96%)11 (0.74%)0.214Viral infection22 (1.48%)00 (0.00%)0.247Atrial fibrillation22 (1.48%)00 (0.00%)0.247Hypernatremia22 (1.48%)00 (0.00%)0.247Sinus bradycardia22 (1.48%)00 (0.00%)0.247Platelet count decreased22 (1.48%)00 (0.00%)0.247Ventilator associated pneumonia3630 (22.22%)2823 (16.91%)0.287Gastritis11 (0.74%)44 (2.94%)0.37Deep vein thrombosis33 (2.22%)11 (0.74%)0.37Acute renal failure33 (2.22%)11 (0.74%)0.37Skin allergy99 (6.67%)66 (4.41%)0.441Nose bleed22 (1.48%)55 (3.68%)0.447Failed extubation00 (0.00%)22 (1.47%)0.498Wound bleed00 (0.00%)22 (1.47%)0.498Arterial thromboembolism00 (0.00%)22 (1.47%)0.498Neuralgia11 (0.74%)00 (0.00%)0.498Sinusitis11 (0.74%)00 (0.00%)0.498facial nerve disorder11 (0.74%)00 (0.00%)0.498Arthralgia11 (0.74%)00 (0.00%)0.498Subcutaneous emphysema11 (0.74%)00 (0.00%)0.498Heat stroke11 (0.74%)00 (0.00%)0.498Appendicitis11 (0.74%)00 (0.00%)0.498Tracheal stenosis11 (0.74%)00 (0.00%)0.498Recurrent tetanus11 (0.74%)00 (0.00%)0.498Gastrointestinal disorder11 (0.74%)00 (0.00%)0.498Pneumothorax11 (0.74%)00 (0.00%)0.498Hypertension11 (0.74%)00 (0.00%)0.498Cholangitis11 (0.74%)00 (0.00%)0.498Pleural abscess11 (0.74%)00 (0.00%)0.498Pruritus11 (0.74%)00 (0.00%)0.498Myalgia11 (0.74%)00 (0.00%)0.498Rhabdomyolysis11 (0.74%)00 (0.00%)0.498Hypoalbuminemia11 (0.74%)00 (0.00%)0.498Cerbral infarction11 (0.74%)00 (0.00%)0.498Arthritis11 (0.74%)43 (2.21%)0.622Oral infection11 (0.74%)33 (2.21%)0.622Dizziness11 (0.74%)33 (2.21%)0.622Upper respiratory infection11 (0.74%)33 (2.21%)0.622Otitis22 (1.48%)11 (0.74%)0.622Hematuria22 (1.48%)11 (0.74%)0.622Adrenal insufficiency22 (1.48%)11 (0.74%)0.622Low weight, muscle wasting22 (1.48%)11 (0.74%)0.622Upper gastrointestinal hemorrhage1111 (8.15%)119 (6.62%)0.651Conjunctivitis33 (2.22%)22 (1.47%)0.684Hypocalcemia1717 (12.59%)1515 (11.03%)0.711Constipation1918 (13.33%)1919 (13.97%)1Hyponatremia1313 (9.63%)1414 (10.29%)1Blood stream infection88 (5.93%)99 (6.62%)1Hypomagnesemia44 (2.96%)44 (2.94%)1Hospital acquired pneumonia22 (1.48%)22 (1.47%)1Hemorrhoids11 (0.74%)22 (1.47%)1Myocardial ischaemia11 (0.74%)22 (1.47%)1Urinary retention11 (0.74%)22 (1.47%)1Wound infection11 (0.74%)22 (1.47%)1arthralgia11 (0.74%)22 (1.47%)1Back pain11 (0.74%)11 (0.74%)1Myocarditis11 (0.74%)11 (0.74%)1Nausea00 (0.00%)11 (0.74%)1pharyngitis00 (0.00%)11 (0.74%)1Hiccup00 (0.00%)11 (0.74%)1Atrial thrombosis00 (0.00%)11 (0.74%)1Spinal disc herniation00 (0.00%)11 (0.74%)1Hyperglycaemia00 (0.00%)11 (0.74%)1Chills00 (0.00%)11 (0.74%)1Allergy00 (0.00%)11 (0.74%)1Cellulitis00 (0.00%)11 (0.74%)1Torticolis00 (0.00%)11 (0.74%)1Insomnia00 (0.00%)11 (0.74%)1Necrotic wound00 (0.00%)11 (0.74%)1Bruising00 (0.00%)11 (0.74%)1Chronic venous insufficiency00 (0.00%)11 (0.74%)1Hyperpyrexia00 (0.00%)11 (0.74%)1Creatinine increase00 (0.00%)11 (0.74%)1Dysphagia00 (0.00%)11 (0.74%)1Cerebral hemorrhage00 (0.00%)11 (0.74%)1Pyloric stenosis00 (0.00%)11 (0.74%)1Postoperative hemorrage00 (0.00%)11 (0.74%)1Relatedness to treatment28388 (65.19%)25184 (61.76%)0.614UNREL26884 (62.22%)22472 (52.94%)0.141POSREL1313 (9.63%)2320 (14.71%)0.265REL22 (1.48%)42 (1.47%)1Unexpected AEs28288 (65.19%)25184 (61.76%)0.614N24584 (62.22%)21479 (58.09%)0.536Y3724 (17.78%)3727 (19.85%)0.756(Missing)11 (0.74%)00 (0.00%)0.498n episode refers to the number of adverse events in each study arm.n patient refers to the number of patients with at least one event in each study arm.p-values were based on Fisher's exact testExample footnote for adverse event summary table.\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nTake-home message: Before writing your own function for a complex task, search for existing packages that match your needs. You might find one that does the job perfectly or requires only minimal adjustments, saving you a lot of time."
  },
  {
    "objectID": "slides/intro.html#about-the-course",
    "href": "slides/intro.html#about-the-course",
    "title": "Welcome to R Café",
    "section": "About the course",
    "text": "About the course\nWelcome to “R-cafe: R for reproducible research”\nIn this course, the following topics will be covered\n\nGetting started with R and Git - Introduction to working with RStudio, R and Github\nR programming with tidyverse - Introduce important tools for data science in R\nMarkdown/Quarto and `gtsummary` - introduce gtsummary for analysis and creating report with Markdown/Quarto"
  },
  {
    "objectID": "slides/intro.html#about-the-course-1",
    "href": "slides/intro.html#about-the-course-1",
    "title": "Welcome to R Café",
    "section": "About the course",
    "text": "About the course\nBy the end of this course, you will be able to conduct an end-to-end data analysis process on a practical dummy dataset, and create a report using R and RMarkdown/Quarto\nTeaching team:\n\nHai Ho Bich (haihb@oucru.org)\nThinh Ong Phuc (thinhop@oucru.org)\nTuyen Huynh Ngoc (tuyenhn@oucru.org)\nAnh Phan Truong Quynh (anhptq@oucru.org)\nHung Tran Thai (hungtt@oucru.org)"
  },
  {
    "objectID": "slides/intro.html#prerequisites",
    "href": "slides/intro.html#prerequisites",
    "title": "Welcome to R Café",
    "section": "Prerequisites",
    "text": "Prerequisites\n\n\n\n\n\n\nBefore this lesson, you should have:\n\n\n\nR and RStudio installed\na Github account, Github Desktop installed"
  },
  {
    "objectID": "slides/intro.html#overview",
    "href": "slides/intro.html#overview",
    "title": "Welcome to R Café",
    "section": "Overview",
    "text": "Overview\n\n\n\n\n\n\nNote\n\n\n\nBrief introduction to Git, GitHub, and GitHub Desktop\nIntro to RStudio\nR project (create R project, set up renv)\nIntro to R"
  },
  {
    "objectID": "slides/intro.html#git-vs.-github",
    "href": "slides/intro.html#git-vs.-github",
    "title": "Welcome to R Café",
    "section": "Git  vs. GitHub ",
    "text": "Git  vs. GitHub \n\n\nGit is a version control system, its purpose is to keep track of changes of files within a repository and provide the capability to revert to previous version\nGitHub is a cloud-based service to host Git repository, its main purpose is to store and/or share your Git project with collaborators"
  },
  {
    "objectID": "slides/intro.html#local-vs.-remote",
    "href": "slides/intro.html#local-vs.-remote",
    "title": "Welcome to R Café",
    "section": "Local vs. Remote",
    "text": "Local vs. Remote\n\n\nLocal means your physical computer. When we say local we are talking about what’s happening directly on your computer\nRemote can mean a computing cloud, a server, or someone else’s computer. When we say remote we are talking about what’s happening not on your computer, i.e. remotely."
  },
  {
    "objectID": "slides/intro.html#git-and-github-1",
    "href": "slides/intro.html#git-and-github-1",
    "title": "Welcome to R Café",
    "section": "Git  and GitHub ",
    "text": "Git  and GitHub \n\n\nGit is a software that works locally. You don’t need GitHub for Git to work. You can use Git as-is\nGitHub acts as a remote server for Git, so that you can share your project and collaborate with others remotely\nA repository is a place where Git tracks all of your changes to files and folders. GitHub stores a copy of your repository whenever you push to it"
  },
  {
    "objectID": "slides/intro.html#git-and-github-2",
    "href": "slides/intro.html#git-and-github-2",
    "title": "Welcome to R Café",
    "section": "Git  and GitHub ",
    "text": "Git  and GitHub \n\n\n\n\n\n\nTerminologies\n\n\n\nBranch: a separate environment, identical copy of where and when you branch from\nCommit: packaging all the changes you made into a “version”\nPush: pushing a commit (a “version”) to remote, e.g. GitHub\nPull: updating your local repository with changes from remote\nAdd: chosing which changes you want to commit"
  },
  {
    "objectID": "slides/intro.html#git-and-github-3",
    "href": "slides/intro.html#git-and-github-3",
    "title": "Welcome to R Café",
    "section": "Git  and GitHub ",
    "text": "Git  and GitHub"
  },
  {
    "objectID": "slides/intro.html#git-and-github-4",
    "href": "slides/intro.html#git-and-github-4",
    "title": "Welcome to R Café",
    "section": "Git  and GitHub ",
    "text": "Git  and GitHub \n\n\n\n\n\n\nTakeaway points\n\n\n\nGit is a standalone software, which works fully locally. You can use Git without GitHub\nGitHub is a platform for collaboration. It uses Git as the version control system"
  },
  {
    "objectID": "slides/intro.html#github-desktop-1",
    "href": "slides/intro.html#github-desktop-1",
    "title": "Welcome to R Café",
    "section": "GitHub Desktop ",
    "text": "GitHub Desktop \n\nGit is a command-line interface (CLI) software.\n\n\n\n\n\n\n\n\nCaution\n\n\nWe strongly recommend to not use Git through its CLI. It is not fun and you will lose your work because of a typo."
  },
  {
    "objectID": "slides/intro.html#github-desktop-2",
    "href": "slides/intro.html#github-desktop-2",
    "title": "Welcome to R Café",
    "section": "GitHub Desktop ",
    "text": "GitHub Desktop \n\n\nGitHub Desktop is a software that makes it easier for you to use Git. It is a software built by GitHub, again, separate from Git\nAdvantages:\n\nSimplifies everything and only provide commonly used functionalities of Git\nReduces the chances that you will make errors in using Git\nDirect integration to GitHub, makes it easier for authentication"
  },
  {
    "objectID": "slides/intro.html#setting-up-github-desktop",
    "href": "slides/intro.html#setting-up-github-desktop",
    "title": "Welcome to R Café",
    "section": "Setting up GitHub Desktop ",
    "text": "Setting up GitHub Desktop \n\n\n\n\n\n\nChecklist\n\n\n\nSign in to your account in GitHub Desktop\nClone R Cafe into your computer/laptop. Link\nCreate your own branch\nPublish (push) your branch\n\n\n\n\nRefer to the handouts for instructions"
  },
  {
    "objectID": "slides/intro.html#r-and-rstudio-1",
    "href": "slides/intro.html#r-and-rstudio-1",
    "title": "Welcome to R Café",
    "section": "R and RStudio",
    "text": "R and RStudio\n\nR is a programming language for statistical computing and data visualization.\n\n\nRStudio is a software designed to make working with R easier by helping you create, edit, and manage R code and projects. More formally, it is known as an Integrated Development Environment (IDE)."
  },
  {
    "objectID": "slides/intro.html#r-and-rstudio-2",
    "href": "slides/intro.html#r-and-rstudio-2",
    "title": "Welcome to R Café",
    "section": "R and RStudio",
    "text": "R and RStudio\nWhy use R?\n\n\nCost: R is free and cross-platform.\nReproducibility: Programming in R (as opposed to point-click tools such as Excel/Access) enhances reproducibility, error detection, and reduces manual workload.\nCommunity: R has a large, collaborative user base, with new tools and packages for analysis developed constantly."
  },
  {
    "objectID": "slides/intro.html#create-project-in-rstudio",
    "href": "slides/intro.html#create-project-in-rstudio",
    "title": "Welcome to R Café",
    "section": "Create Project in RStudio",
    "text": "Create Project in RStudio\nAn R project is a directory with .Rproj file, signaling RStudio to manage the project settings accordingly.\n\nThe process of creating an R project is as followed\n\nIn the menu File &gt; New Project…\nClick Existing Directory &gt; Browse\nClick Browse and click on your project directory\nClick Create Project"
  },
  {
    "objectID": "slides/intro.html#rstudio-interface",
    "href": "slides/intro.html#rstudio-interface",
    "title": "Welcome to R Café",
    "section": "RStudio interface",
    "text": "RStudio interface"
  },
  {
    "objectID": "slides/intro.html#rstudio-interface-1",
    "href": "slides/intro.html#rstudio-interface-1",
    "title": "Welcome to R Café",
    "section": "RStudio interface",
    "text": "RStudio interface\n\nConsists of 4 main panes\n\nSource code: Show the content of a source code file\nConsole: Show the executed code lines and their output\nDefined variables: Show the currently defined variables\nFiles/Plot/Package/Help:\n\nFiles: for files nagivation\nPlots: show plot output\nPackages: show all the installed packages and packages being used (packages in use will have a ✓)\nHelp: show documentations for functions or packages"
  },
  {
    "objectID": "slides/intro.html#project-structure",
    "href": "slides/intro.html#project-structure",
    "title": "Welcome to R Café",
    "section": "Project structure",
    "text": "Project structure\nA minimal R project structure will have the following format\n└── my_project\n    ├── output\n    ├── data\n    │   ├── raw\n    │   └── processed\n    └── analysis.R \nWhere\n\ndata folder contains data to be analyzed\noutput stores code output (plot, figures, etc.)\nanalysis.R is the file containing R code. There can be multiple .R files under 1 project."
  },
  {
    "objectID": "slides/intro.html#sec-file-naming",
    "href": "slides/intro.html#sec-file-naming",
    "title": "Welcome to R Café",
    "section": "Naming convention",
    "text": "Naming convention\n\n\n\n\n\n\n\nNote\n\n\nSome rules of thumb for naming files and folders:\n\nDo not use diacritics (e.g. Vietnamese accent marks).\nDo not use overly long names, keep it short but meaningful.\nDo not include special characters such as /, \\, &, ,, (, )... in names. It’s best to use only letters and numbers.\nAvoid mixing uppercase and lowercase letters arbitrarily. If necessary, use naming conventions like camelCase (capitalize the first letter of each word after the first one, e.g., dataSoiHcm) or PascalCase (capitalize the first letter of all words, e.g., DataSoiHcm).\nDo not include spaces (\" \") in names. Instead, you can use camelCase, or replace spaces with - or _. For example, instead of naming a file data soi HCM 2023.xlsx, you could name it dataSoiHcm2023.xlsx, data-soi-hcm-2023.xlsx, or data_soi_hcm_2023.xlsx."
  },
  {
    "objectID": "slides/intro.html#set-up-renv",
    "href": "slides/intro.html#set-up-renv",
    "title": "Welcome to R Café",
    "section": "Set up renv",
    "text": "Set up renv\nTo use renv for your project. Run the following line of code in your console\n\nrenv::init()\n\nWhich will create renv.lock and renv folder under your project"
  },
  {
    "objectID": "slides/intro.html#why-use-renv",
    "href": "slides/intro.html#why-use-renv",
    "title": "Welcome to R Café",
    "section": "Why use renv?",
    "text": "Why use renv?\n\n\n\nEncapsulate the development environment of your R projects (R version, packages used and their versions) in a file called renv.lock\nEnsure collaborators to replicate your R project’s development environment by simply running renv::restore()\nIsolate installed packages under project directory for more convenient management. With renv set up, the installed packages are stored under\n\npath_to_project/renv/library/{R-version}/{device-architecture}/\n\n\n\n\n\n\n\n\n\n\nWhat are packages?\n\n\nAn R package is a shareable bundle of functions. We will frequently use available packages to assist us during coding process."
  },
  {
    "objectID": "slides/intro.html#r-script",
    "href": "slides/intro.html#r-script",
    "title": "Welcome to R Café",
    "section": "R script",
    "text": "R script\nTo create an R script in RStudio, in the menu section, click File &gt; New File &gt; R Script\nR script is where you store your R code and comments.\nComments are notes to explain your code to other developers (or your future self, when you revisit the code). To comment in R simply add # at the start of your note."
  },
  {
    "objectID": "slides/intro.html#r-script-1",
    "href": "slides/intro.html#r-script-1",
    "title": "Welcome to R Café",
    "section": "R script",
    "text": "R script\nExample: Some R codes and comment\n\n# this is a comment, and the following code will print Hello world in the console\nprint(\"Hello world\")\n\n[1] \"Hello world\"\n\n# you can also perform computations in R\n# In R, you can denote \n# - multiplication as *\n# - power as **\n# - devision as /\n# - e5 is the shorthand notation for *10**5\n12*10e5 + 313**2 - 11890/2\n\n[1] 12092024"
  },
  {
    "objectID": "slides/intro.html#variable",
    "href": "slides/intro.html#variable",
    "title": "Welcome to R Café",
    "section": "Variable",
    "text": "Variable\n\nIn R, a variable is a name used to store an object, such as a dataset, vector, number, or graph. Once assigned to a variable, the object can be easily referenced and reused in future commands.\nIn R, a variable can be created by assigning an object to it using &lt;-\nAs previously mentioned, an object can be a number, string, vector of characters, etc.\n\n# assigning 3.14 to the variable pi_numb\npi_numb &lt;- 3.14\n# which can then be referenced \npi_numb\n\n[1] 3.14\n\n# object can also be a text/characters\ngreeting &lt;- \"Hello World\" # note that it must be contained within quotation marks\ngreeting\n\n[1] \"Hello World\""
  },
  {
    "objectID": "slides/intro.html#variable-1",
    "href": "slides/intro.html#variable-1",
    "title": "Welcome to R Café",
    "section": "Variable",
    "text": "Variable\nValue of a variable can also be overridden\n\nvar &lt;- 5\nvar\n\n[1] 5\n\n# override variable\nvar &lt;- \"new value\"\nvar\n\n[1] \"new value\"\n\n\n\n\n\n\n\n\nNaming variable\n\n\nThe rule for naming variable is similar to that of naming file/folder names (See Section 6.5)\nAdditionally, variable name needs to be concise and beware of overriding values"
  },
  {
    "objectID": "slides/intro.html#classes",
    "href": "slides/intro.html#classes",
    "title": "Welcome to R Café",
    "section": "Classes",
    "text": "Classes\n\nAll the objects stored in R have a class which tells R how to handle the object (to check the class of a variable, run class(variable)).\nThere are many possible classes, but common ones include\n\n\n\n\n\n\n\n\nClasses\nExplanation\nExamples\n\n\n\n\nnumeric\nfor numerical data, including decimals\n3.14, -1000, 10, 2e6, etc.\n\n\nlogical\nfor boolean data (TRUE/FALSE) without quotation marks\nTRUE or FALSE\n\n\ncharacter\nfor text/characters data (also referred to as string)\n\"Hello world\", \"R Cafe\", etc.\n\n\nDate\ndata classified as Date can be displayed and manipulated in special ways\n2024-12-09 , s, etc.\n\n\nfactor\nfor categorical data\ngender: female or male,\neconomic status,\ndistrict, ethnicity, etc.\n\n\ndata.frame\ncommon way for R to store dataset.\nConsists of vectors (columns, each column must be of a specific class) of data bounded together.\n\n\n\ntibble\nan “enhanced” version of data.frame which is less prone to error and printed more nicely in the console"
  },
  {
    "objectID": "slides/intro.html#special-values",
    "href": "slides/intro.html#special-values",
    "title": "Welcome to R Café",
    "section": "Special values",
    "text": "Special values\n\n\n\n\n\n\n\n\nValue\nDescription\n\n\n\n\nNA\nStands for Not Available. Indicates missing values.\n\n\nNULL\nIndicates undefined/abscence of value. (e.g. numb &lt;- NULL indicates value for variable numb is undefined)\n\n\nNaN\nStands for Not a Number. Indicates unrepresentable number (e.g. result for 0/0 )\n\n\nInf/-Inf\nInfinity/Negative infinity"
  },
  {
    "objectID": "slides/intro.html#functions",
    "href": "slides/intro.html#functions",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\nA function is a reusable sequence of code.\nIt can be created using the syntax\n\nfunction_name &lt;- function(){\n\n# function content\n\n}"
  },
  {
    "objectID": "slides/intro.html#functions-1",
    "href": "slides/intro.html#functions-1",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\nExample: a simple function\n\nprint_hello &lt;- function(){\n  print(\"Hello world\")\n  print(\"This is R Cafe course\")\n}\n\n# defined function can then be called as followed\nprint_hello()\n\n[1] \"Hello world\"\n[1] \"This is R Cafe course\""
  },
  {
    "objectID": "slides/intro.html#functions-2",
    "href": "slides/intro.html#functions-2",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\nFunctions can also have arguments, which creates reusable code with dynamic inputs and outputs\nA function with arguments as followed. Note that you can include as many arguments as you want\n\nfunction_name &lt;- function(argument_1, argument_2){\n  # function content\n  # values of argument can be accessed simply calling argument name\n}"
  },
  {
    "objectID": "slides/intro.html#functions-3",
    "href": "slides/intro.html#functions-3",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\nExample: simple function\n\ncompute_power &lt;- function(base, power){\n  # return `base` raised to the power of `power`\n  base**power\n}\n\n# output can be assigned to a variable\noutput &lt;- compute_power(base = 5, power = 2)\noutput\n\n[1] 25"
  },
  {
    "objectID": "slides/intro.html#functions-4",
    "href": "slides/intro.html#functions-4",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\n\nImplicit vs. explicit return\n\nBy default, R will implicitly return the result of the last line of code in the function\nYou can also explicitly specify the returned value using return()\n\n\n\ncompute_power &lt;- function(base, power){\n\n  # explicit return statement\n  return(base**power)\n}\n\n# output can be assigned to a variable\noutput &lt;- compute_power(base = 5, power = 2)\noutput\n\n[1] 25"
  },
  {
    "objectID": "slides/intro.html#functions-5",
    "href": "slides/intro.html#functions-5",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\n\n\n\n\n\n\nNote\n\n\nYou can provide value for each argument without specifying the name but it must follow the same order in the function definition.\nHowever, it is generally recommended to include the name of the argument for better readability. When argument name is specified, order no longer matter.\n\ncompute_power(5, 2) \n\n[1] 25\n\ncompute_power(2, 5) # expect different result (2^5)\n\n[1] 32\n\ncompute_power(base = 5, power = 2)\n\n[1] 25\n\ncompute_power(power = 2, base = 5) # expect same result\n\n[1] 25"
  },
  {
    "objectID": "slides/intro.html#functions-6",
    "href": "slides/intro.html#functions-6",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\n\nWhen to create a function?\nA general rule is when you start to copy-paste a sequence of code multiple times (usually &gt;3), you should make a function for it\nThe in-class excercise (Section 9) will demonstrate one use case for function"
  },
  {
    "objectID": "slides/intro.html#functions-7",
    "href": "slides/intro.html#functions-7",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\n\nSome criteria for a good function\n\n\nModularity - each function should focus on one task (e.g. you can have a function to import data, another to model the data, another to visualize data but not a function doing all of those 3 tasks)\nConcise - the content of a function should not be too lengthy. If a function starts to have &gt; 30 lines of code, it may be an indication that the modularity rule is violated.\nReadability - function’s name should clearly describe its purpose (e.g. compute_min, plot_case, etc.), and the content should be properly commented and documented."
  },
  {
    "objectID": "slides/intro.html#functions-8",
    "href": "slides/intro.html#functions-8",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\n\nR is a functional programming language, which means you will encounter a lot of functions while coding in R.\nTo assist users, R also include a built-in documentation system that explains the purpose and usage of each function. To look up a function, use ? or help()\n\n# look up documentation for `sqrt` function\n?sqrt\nhelp(sqrt)\n\n\nNote that the built-in documentation only helps when you already know which function you want to ask about. If you are looking for a function to achieve a specific task, it is better to start with search engine (Google, Bing, etc.), forums/Q&A sites (Github discussions, StackOverflow, etc.) or even ChatGPT."
  },
  {
    "objectID": "slides/intro.html#functions-9",
    "href": "slides/intro.html#functions-9",
    "title": "Welcome to R Café",
    "section": "Functions",
    "text": "Functions\n\nThe documentation that show up when calling help() or ? are usually generated from something called roxygen documentation.\nTo create a roxygen documentation, place the cursor within the function and from the menu, click Code &gt; Insert Roxygen Skeleton\n\n#' Compute power\n#' \n#' Takes two arguments, `base` and `power` then return base raised to given power\n#'\n#' @param base - a numeric value for base number\n#' @param power - a numeric value for power\n#'\n#' @return numeric value for base^power\n#' @examples\n#' compute_power(3,4)\ncompute_power &lt;- function(base, power){\n  # return `base` raised to the power of `power`\n  base**power\n}\n\ncompute_power(5, 2)\n\n[1] 25"
  },
  {
    "objectID": "slides/intro.html#scope",
    "href": "slides/intro.html#scope",
    "title": "Welcome to R Café",
    "section": "Scope",
    "text": "Scope\n\nDiscussion Read the code and guess the answer for 3 Questions below\n\n\nexample_var &lt;- 10\n\nexample_func &lt;- function(arg){\n  print(paste0(\"Value of variable example_var: \", example_var))\n  \n  example_var &lt;- 20\n  \n  print(paste0(\"Value of variable example_var after assignment: \", example_var))\n  print(paste0(\"Value of function argument: \", arg)) \n}\n\n# Q1: What will the 2 print statements show?\nexample_func(60) \n# Q2: What will be the value for example_var here?\npaste0(\"Value of variable example_var: \", example_var)\n# Q3: What will be the value for arg here?\narg"
  },
  {
    "objectID": "slides/intro.html#scope-1",
    "href": "slides/intro.html#scope-1",
    "title": "Welcome to R Café",
    "section": "Scope",
    "text": "Scope\nOutput\n\nexample_var &lt;- 10\n\nexample_func &lt;- function(arg){\n  print(paste0(\"Value of variable example_var: \", example_var))\n  \n  example_var &lt;- 20\n  \n  print(paste0(\"Value of variable example_var after assignment: \", example_var))\n  print(paste0(\"Value of function argument: \", arg)) \n}\n\n# Q1: What will the 2 print statements show?\nexample_func(60) \n\n[1] \"Value of variable example_var: 10\"\n[1] \"Value of variable example_var after assignment: 20\"\n[1] \"Value of function argument: 60\"\n\n# Q2: What will be the value for example_var here?\npaste0(\"Value of variable example_var: \", example_var)\n\n[1] \"Value of variable example_var: 10\"\n\n# Q3: What will be the value for arg here?\narg  \n\nError: object 'arg' not found"
  },
  {
    "objectID": "slides/intro.html#scope-2",
    "href": "slides/intro.html#scope-2",
    "title": "Welcome to R Café",
    "section": "Scope",
    "text": "Scope"
  },
  {
    "objectID": "slides/intro.html#scope-3",
    "href": "slides/intro.html#scope-3",
    "title": "Welcome to R Café",
    "section": "Scope",
    "text": "Scope\nExplanation\n\n# this is a global variable since it is not created in any local environment\nexample_var &lt;- 10\n\nexample_func &lt;- function(arg){\n  # global_var\n  print(paste0(\"Global variable can be accessed within function \", example_var))\n  \n  # this is creating a local variable named example_var\n  # it will not affect the global variable example_var\n  example_var &lt;- 20\n  \n  # this example_var refers to the local variable example_var\n  print(paste0(\"Value of variable example_var after assignment: \", example_var))\n  # note that argument is also only accessible within the function\n  print(paste0(\"Function argument: \", arg))\n}\n\nexample_func(60) \n\n[1] \"Global variable can be accessed within function 10\"\n[1] \"Value of variable example_var after assignment: 20\"\n[1] \"Function argument: 60\"\n\n# value for argument should only accessible within function \narg  \n\nError: object 'arg' not found\n\n# refers to global variable example_var here \npaste0(\"Value of variable example_var: \", example_var)\n\n[1] \"Value of variable example_var: 10\""
  },
  {
    "objectID": "slides/intro.html#scope-4",
    "href": "slides/intro.html#scope-4",
    "title": "Welcome to R Café",
    "section": "Scope",
    "text": "Scope\n\nScope refers to where variables can be accessed or modified.\nTo put simply\n\n\nBy default, variables can be modified only in the environment in which it was created (unless they were forced to, but it is not recommended).\nglobal variables can be accessed from both outside and inside the function (i.e. from global or local environment).\nlocal variables are variables defined in a local environment and can only be accessed within that local environment. The most common local environment you will encounter is environment within a function."
  },
  {
    "objectID": "slides/intro.html#packages",
    "href": "slides/intro.html#packages",
    "title": "Welcome to R Café",
    "section": "Packages",
    "text": "Packages\n\n\nPackages are shareable bundle of functions (and sometimes include built-in dataset). We will frequently use available packages to assist us during coding process.\n\n\n2 options to install an R packages\n\nVia RStudio interface.\n\nIn the File/Plots/Packages/Help panel\nClick Packages &gt; Install\nType name of the packages to be installed separated by ,\nClick install\n\nUsing R code install.packages(\"package_name\")"
  },
  {
    "objectID": "slides/intro.html#packages-1",
    "href": "slides/intro.html#packages-1",
    "title": "Welcome to R Café",
    "section": "Packages",
    "text": "Packages\n\nExample: Download package for reading Excel files\n\ninstall.packages(\"readxl\")\n\n\n\n\n\n\n\nUpdate renv.lock\n\n\nTo update your renv.lock after changing development environment, run the code renv::snapshot()"
  },
  {
    "objectID": "slides/intro.html#packages-2",
    "href": "slides/intro.html#packages-2",
    "title": "Welcome to R Café",
    "section": "Packages",
    "text": "Packages\nTo use a package, you must first load it to R using library() function\n\nlibrary(readxl)\ndata &lt;- read_excel(\"../data/linelist_raw.xlsx\")\nhead(data)"
  },
  {
    "objectID": "slides/intro.html#packages-3",
    "href": "slides/intro.html#packages-3",
    "title": "Welcome to R Café",
    "section": "Packages",
    "text": "Packages\nSimilar to functions, you can also look up documentation for packages using ? or help()\n\n# --- look up documentation for package ---\n?readxl\nhelp(readxl)\n\n# --- look up documentation for function of the package ---\n?readxl::read_excel\nhelp(read_excel, package= readxl)"
  },
  {
    "objectID": "slides/intro.html#goal",
    "href": "slides/intro.html#goal",
    "title": "Welcome to R Café",
    "section": "Goal",
    "text": "Goal\n\n\n\n\n\n\nNote\n\n\nIn this exercise, you will:\n\nCreate a function from the given code\nPush your code to Github\nCommenting collaborators’ code on Github"
  },
  {
    "objectID": "slides/intro.html#code-file",
    "href": "slides/intro.html#code-file",
    "title": "Welcome to R Café",
    "section": "Code file",
    "text": "Code file\nIn your R project, navigate to the template code file day1/inclass.R.\nThen run all the code in the file, this should create a dataset covid_cases.\nThis is also where you will write the solution for in-class exercise."
  },
  {
    "objectID": "slides/intro.html#create-function",
    "href": "slides/intro.html#create-function",
    "title": "Welcome to R Café",
    "section": "Create function",
    "text": "Create function\n\nDataset Given a dataset with number of reported cases for 211 countries and archipelagos\nWhere each column following the format cases_{country_code} represents the number of newly reported Covid cases on the day shown in date columns\n\nhead(covid_cases)"
  },
  {
    "objectID": "slides/intro.html#create-function-1",
    "href": "slides/intro.html#create-function-1",
    "title": "Welcome to R Café",
    "section": "Create function",
    "text": "Create function\n\nGoal Create a function that allow users to choose compute basic statistics (min, max, mean, quartiles) for number cases of each country.\nGiven the code to compute basic stats for case reports in China (cases_chn) is as followed\n\ncase_col &lt;- \"cases_chn\"\n\nbasic_stats &lt;- c(\n  min =  min(covid_cases[[case_col]]),\n  q1 = quantile(covid_cases[[case_col]], 0.25, names=FALSE),\n  median = median(covid_cases[[case_col]]),\n  q3 = quantile(covid_cases[[case_col]], 0.75, names=FALSE),\n  max = max(covid_cases[[case_col]])\n)\n\nbasic_stats\n\n    min      q1  median      q3     max \n    0.0    65.5   128.0   950.5 19461.0 \n\n\n\n\n\n\n\n\nNote\n\n\nThe syntax data[[column_name]] is used for extracting values in a column"
  },
  {
    "objectID": "slides/intro.html#suggested-solution",
    "href": "slides/intro.html#suggested-solution",
    "title": "Welcome to R Café",
    "section": "Suggested solution",
    "text": "Suggested solution\nExercise: Suggested solution\n\n\nCode\ncompute_stats &lt;- function(data, colname){\n  return(\n    c(\n      min = min(data[[colname]]),\n      q1 = quantile(data[[colname]], 0.25, names=FALSE),\n      median = median(data[[colname]]),\n      q3 = quantile(data[[colname]], 0.75, names=FALSE),\n      max = max(data[[colname]])\n    )\n  )\n}\ncompute_stats(covid_cases, colname = \"cases_chn\")"
  },
  {
    "objectID": "slides/intro.html#navigating-github-desktop-github",
    "href": "slides/intro.html#navigating-github-desktop-github",
    "title": "Welcome to R Café",
    "section": "Navigating Github Desktop & Github",
    "text": "Navigating Github Desktop & Github\nOnce you have created the function, complete the following tasks on Github Desktop and Github (refer to the handout for detailed instructions)\n\n\n\n\n\n\nNote\n\n\n\nPush your code to Github using Github Desktop\nCreate an issue on Github to comment on at least 1 other participant’s code"
  },
  {
    "objectID": "slides/intro.html#data-import",
    "href": "slides/intro.html#data-import",
    "title": "Welcome to R Café",
    "section": "Data import",
    "text": "Data import\nSome useful import functions\n\n\n\nFunction\nPackage\nDescription\n\n\n\n\nread_excel()\nreadxl\nimport Excel (.xlsx, .xls) files\n\n\nread_csv()\nreadr\nimport .csv files\n\n\nreadRDS()\nbase\nimport .rds files\n\n\nload()\nbase\nimport .rda files"
  },
  {
    "objectID": "slides/intro.html#data-import-1",
    "href": "slides/intro.html#data-import-1",
    "title": "Welcome to R Café",
    "section": "Data import",
    "text": "Data import\n\nrio - support data import for multiple data format\n\n\nlibrary(rio)\ndata &lt;- import(\"../data/linelist_raw.xlsx\")"
  },
  {
    "objectID": "slides/intro.html#data-export",
    "href": "slides/intro.html#data-export",
    "title": "Welcome to R Café",
    "section": "Data export",
    "text": "Data export\nSome useful export function in R\n\n\n\nFunction\nPackage\nDescription\n\n\n\n\nwrite_xlsx()\nwritexl\nexport data as Excel files\n\n\nwrite.csv()\nutils\nexport data as .csv files\n\n\nsaveRDS()\nbase\nexport data as .rds files\n\n\nsave()\nbase\nexport data .rda files"
  },
  {
    "objectID": "slides/intro.html#clean-column-names",
    "href": "slides/intro.html#clean-column-names",
    "title": "Welcome to R Café",
    "section": "Clean column names",
    "text": "Clean column names\nThe thing we usually do first after importing data is check the column names, to do that we use function colnames()\n\ncolnames(data)\n\n [1] \"case_id\"         \"generation\"      \"infection date\"  \"date onset\"     \n [5] \"hosp date\"       \"date_of_outcome\" \"outcome\"         \"gender\"         \n [9] \"hospital\"        \"lon\"             \"lat\"             \"infector\"       \n[13] \"source\"          \"age\"             \"age_unit\"        \"row_num\"        \n[17] \"wt_kg\"           \"ht_cm\"           \"ct_blood\"        \"fever\"          \n[21] \"chills\"          \"cough\"           \"aches\"           \"vomit\"          \n[25] \"temp\"            \"time_admission\"  \"merged_header\"   \"...28\""
  },
  {
    "objectID": "slides/intro.html#clean-column-names-1",
    "href": "slides/intro.html#clean-column-names-1",
    "title": "Welcome to R Café",
    "section": "Clean column names",
    "text": "Clean column names\n\nYou may notice some names go against the “rule of thumb” for naming\nTo quickly resolve this, package janitor offers clean_names() function to automatically fix the naming\n\n\nlibrary(janitor)\ndata &lt;- clean_names(data)\nhead(data)"
  },
  {
    "objectID": "slides/intro.html#simple-data-extraction",
    "href": "slides/intro.html#simple-data-extraction",
    "title": "Welcome to R Café",
    "section": "Simple data extraction",
    "text": "Simple data extraction\n\nData cell(s) can be extracted using the syntax data[row, col]\n\nTo extract all rows, left col blank\nTo extract all cols, left row blank\n\n\n# get the cell at row 5, column 2\ndata[5 ,2]\n\n[1] 3"
  },
  {
    "objectID": "slides/intro.html#simple-data-extraction-1",
    "href": "slides/intro.html#simple-data-extraction-1",
    "title": "Welcome to R Café",
    "section": "Simple data extraction",
    "text": "Simple data extraction\n\nData cell(s) can be extracted using the syntax data[row, col]\n\nTo extract all rows, left col blank\nTo extract all cols, left row blank\n\n\n# column can also be accessed using column name\ndata[5 , \"hosp_date\"]\n\n[1] \"2014-05-22 UTC\""
  },
  {
    "objectID": "slides/intro.html#simple-data-extraction-2",
    "href": "slides/intro.html#simple-data-extraction-2",
    "title": "Welcome to R Café",
    "section": "Simple data extraction",
    "text": "Simple data extraction\n\nData cell(s) can be extracted using the syntax data[row, col]\n\nTo extract all rows, left col blank\nTo extract all cols, left row blank\n\n\n# get all values in the 5th row\ndata[5, ]"
  },
  {
    "objectID": "slides/intro.html#simple-data-extraction-3",
    "href": "slides/intro.html#simple-data-extraction-3",
    "title": "Welcome to R Café",
    "section": "Simple data extraction",
    "text": "Simple data extraction\n\nData cell(s) can be extracted using the syntax data[row, col]\n\nTo extract all rows, left col blank\nTo extract all cols, left row blank\n\n\n# extract specific columns\ndata[, c(\"case_id\", \"infection_date\", \"date_onset\", \"hosp_date\")]"
  },
  {
    "objectID": "slides/intro.html#simple-data-extraction-4",
    "href": "slides/intro.html#simple-data-extraction-4",
    "title": "Welcome to R Café",
    "section": "Simple data extraction",
    "text": "Simple data extraction\n\nData cell(s) can be extracted using the syntax data[row, col]\n\nTo extract all rows, left col blank\nTo extract all cols, left row blank\n\n\n# extract first 10 rows from specific columns\ndata[1:10, c(\"case_id\", \"infection_date\", \"date_onset\", \"hosp_date\")]"
  },
  {
    "objectID": "slides/intro.html#data-summary",
    "href": "slides/intro.html#data-summary",
    "title": "Welcome to R Café",
    "section": "Data summary",
    "text": "Data summary\nIn base R, function summary() is used to have the basic statistics of each variables in the dataset\n\nsummary(data)\n\n   case_id            generation   infection_date                  \n Length:6611        Min.   : 0.0   Min.   :2012-04-09 00:00:00.00  \n Class :character   1st Qu.:13.0   1st Qu.:2014-08-25 00:00:00.00  \n Mode  :character   Median :16.0   Median :2014-10-04 00:00:00.00  \n                    Mean   :16.6   Mean   :2014-08-17 15:30:00.42  \n                    3rd Qu.:20.0   3rd Qu.:2014-11-26 00:00:00.00  \n                    Max.   :37.0   Max.   :2015-04-27 00:00:00.00  \n                    NA's   :7      NA's   :2322                    \n  date_onset          hosp_date                     \n Length:6611        Min.   :2012-04-20 00:00:00.00  \n Class :character   1st Qu.:2014-09-07 00:00:00.00  \n Mode  :character   Median :2014-10-15 00:00:00.00  \n                    Mean   :2014-08-31 05:10:56.32  \n                    3rd Qu.:2014-12-10 00:00:00.00  \n                    Max.   :2015-04-30 00:00:00.00  \n                    NA's   :7                       \n date_of_outcome                   outcome             gender         \n Min.   :2012-05-14 00:00:00.0   Length:6611        Length:6611       \n 1st Qu.:2014-09-14 00:00:00.0   Class :character   Class :character  \n Median :2014-10-26 00:00:00.0   Mode  :character   Mode  :character  \n Mean   :2014-09-11 00:04:09.4                                        \n 3rd Qu.:2014-12-21 00:00:00.0                                        \n Max.   :2015-06-04 00:00:00.0                                        \n NA's   :1068                                                         \n   hospital              lon              lat          infector        \n Length:6611        Min.   :-13.27   Min.   :8.446   Length:6611       \n Class :character   1st Qu.:-13.25   1st Qu.:8.461   Class :character  \n Mode  :character   Median :-13.23   Median :8.469   Mode  :character  \n                    Mean   :-13.23   Mean   :8.470                     \n                    3rd Qu.:-13.22   3rd Qu.:8.480                     \n                    Max.   :-13.21   Max.   :8.492                     \n                    NA's   :7        NA's   :7                         \n    source              age              age_unit            row_num    \n Length:6611        Length:6611        Length:6611        Min.   :   1  \n Class :character   Class :character   Class :character   1st Qu.:1648  \n Mode  :character   Mode  :character   Mode  :character   Median :3241  \n                                                          Mean   :3241  \n                                                          3rd Qu.:4836  \n                                                          Max.   :6481  \n                                                                        \n     wt_kg            ht_cm          ct_blood        fever          \n Min.   :-11.00   Min.   :  4.0   Min.   :16.00   Length:6611       \n 1st Qu.: 41.00   1st Qu.: 91.0   1st Qu.:20.00   Class :character  \n Median : 54.00   Median :130.0   Median :22.00   Mode  :character  \n Mean   : 52.69   Mean   :125.2   Mean   :21.26                     \n 3rd Qu.: 66.00   3rd Qu.:159.0   3rd Qu.:22.00                     \n Max.   :111.00   Max.   :295.0   Max.   :26.00                     \n NA's   :7        NA's   :7       NA's   :7                         \n    chills             cough              aches              vomit          \n Length:6611        Length:6611        Length:6611        Length:6611       \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n      temp      time_admission     merged_header          x28           \n Min.   :35.2   Length:6611        Length:6611        Length:6611       \n 1st Qu.:38.3   Class :character   Class :character   Class :character  \n Median :38.8   Mode  :character   Mode  :character   Mode  :character  \n Mean   :38.6                                                           \n 3rd Qu.:39.2                                                           \n Max.   :40.8                                                           \n NA's   :158"
  },
  {
    "objectID": "slides/intro.html#data-summary-1",
    "href": "slides/intro.html#data-summary-1",
    "title": "Welcome to R Café",
    "section": "Data summary",
    "text": "Data summary\n\nHowever, function skim() from package skimr can return a better table output with tables grouped by class of data\n\nlibrary(skimr)\nskim(data)\n\n\nData summary\n\n\nName\ndata\n\n\nNumber of rows\n6611\n\n\nNumber of columns\n28\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n17\n\n\nnumeric\n8\n\n\nPOSIXct\n3\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\ncase_id\n137\n0.98\n6\n6\n0\n5888\n0\n\n\ndate_onset\n293\n0.96\n10\n10\n0\n580\n0\n\n\noutcome\n1500\n0.77\n5\n7\n0\n2\n0\n\n\ngender\n324\n0.95\n1\n1\n0\n2\n0\n\n\nhospital\n1512\n0.77\n5\n36\n0\n13\n0\n\n\ninfector\n2323\n0.65\n6\n6\n0\n2697\n0\n\n\nsource\n2323\n0.65\n5\n7\n0\n2\n0\n\n\nage\n107\n0.98\n1\n2\n0\n75\n0\n\n\nage_unit\n7\n1.00\n5\n6\n0\n2\n0\n\n\nfever\n258\n0.96\n2\n3\n0\n2\n0\n\n\nchills\n258\n0.96\n2\n3\n0\n2\n0\n\n\ncough\n258\n0.96\n2\n3\n0\n2\n0\n\n\naches\n258\n0.96\n2\n3\n0\n2\n0\n\n\nvomit\n258\n0.96\n2\n3\n0\n2\n0\n\n\ntime_admission\n844\n0.87\n5\n5\n0\n1091\n0\n\n\nmerged_header\n0\n1.00\n1\n1\n0\n1\n0\n\n\nx28\n0\n1.00\n1\n1\n0\n1\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\ngeneration\n7\n1.00\n16.60\n5.71\n0.00\n13.00\n16.00\n20.00\n37.00\n▁▆▇▂▁\n\n\nlon\n7\n1.00\n-13.23\n0.02\n-13.27\n-13.25\n-13.23\n-13.22\n-13.21\n▅▃▃▅▇\n\n\nlat\n7\n1.00\n8.47\n0.01\n8.45\n8.46\n8.47\n8.48\n8.49\n▅▇▇▇▆\n\n\nrow_num\n0\n1.00\n3240.91\n1857.83\n1.00\n1647.50\n3241.00\n4836.50\n6481.00\n▇▇▇▇▇\n\n\nwt_kg\n7\n1.00\n52.69\n18.59\n-11.00\n41.00\n54.00\n66.00\n111.00\n▁▃▇▅▁\n\n\nht_cm\n7\n1.00\n125.25\n49.57\n4.00\n91.00\n130.00\n159.00\n295.00\n▂▅▇▂▁\n\n\nct_blood\n7\n1.00\n21.26\n1.67\n16.00\n20.00\n22.00\n22.00\n26.00\n▁▃▇▃▁\n\n\ntemp\n158\n0.98\n38.60\n0.95\n35.20\n38.30\n38.80\n39.20\n40.80\n▁▂▂▇▁\n\n\n\nVariable type: POSIXct\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nmedian\nn_unique\n\n\n\n\ninfection_date\n2322\n0.65\n2012-04-09\n2015-04-27\n2014-10-04\n538\n\n\nhosp_date\n7\n1.00\n2012-04-20\n2015-04-30\n2014-10-15\n570\n\n\ndate_of_outcome\n1068\n0.84\n2012-05-14\n2015-06-04\n2014-10-26\n575"
  },
  {
    "objectID": "slides/intro.html#recap",
    "href": "slides/intro.html#recap",
    "title": "Welcome to R Café",
    "section": "Recap",
    "text": "Recap\nAfter today, you have learnt to:\n\nCreate an R project and set up a project environment\nHow to upload your project to Github using Github Desktop\nUnderstand R variables and classes, functions, packages\nHow to look up documentations for functions and packages\nPerform data import, export, overview in R"
  },
  {
    "objectID": "slides/intro.html#take-home-exercise",
    "href": "slides/intro.html#take-home-exercise",
    "title": "Welcome to R Café",
    "section": "Take home exercise",
    "text": "Take home exercise\nBefore the next lesson (23rd Dec, 2024), please complete all the tasks for Day 1 - Take home exercise"
  },
  {
    "objectID": "slides/intro.html#upcoming-lessons",
    "href": "slides/intro.html#upcoming-lessons",
    "title": "Welcome to R Café",
    "section": "Upcoming lessons",
    "text": "Upcoming lessons\n\nData cleaning in R\ntidyverse package for\n\nData cleaning, handling tricky datatypes (string, Date, factor, etc.)\nData visualization using ggplots\n\nData analysis in R\n\nDemographic analysis, perform statistical tests using gtsummary\nCreating report using Rmarkdown/Quarto"
  },
  {
    "objectID": "slides/quarto.html#what-is-quarto",
    "href": "slides/quarto.html#what-is-quarto",
    "title": "Quarto",
    "section": "What is Quarto?",
    "text": "What is Quarto?\n\nA publishing system for creating documents, presentations, websites…\nCombines Markdown and R/Python code for reproducible workflows."
  },
  {
    "objectID": "slides/quarto.html#what-can-quarto-do",
    "href": "slides/quarto.html#what-can-quarto-do",
    "title": "Quarto",
    "section": "What can Quarto do?",
    "text": "What can Quarto do?\n\n\n    \nOr click here"
  },
  {
    "objectID": "slides/quarto.html#creating-a-quarto-file",
    "href": "slides/quarto.html#creating-a-quarto-file",
    "title": "Quarto",
    "section": "Creating a Quarto file",
    "text": "Creating a Quarto file\n\n\n\n\n\n\n\nOpen RStudio\nGo to File &gt; New File &gt; Quarto Document\nSelect the format you want\nSave the file with a .qmd extension"
  },
  {
    "objectID": "slides/quarto.html#how-to-use-quarto",
    "href": "slides/quarto.html#how-to-use-quarto",
    "title": "Quarto",
    "section": "How to use Quarto?",
    "text": "How to use Quarto?\n\n\n\nindex.qmd\n---\ntitle: \"My Quarto file\"\nauthor: \"Your Name\"\ndate: \"`r Sys.Date()`\"\nformat: html\n---\n\nSummary of `mtcars`\n\n```{r}\nsummary(mtcars)\n```\n\n\n\n\nMain components of a Quarto file:\n\nHeader (YAML metadata)\nBody (Markdown content and code chunks)"
  },
  {
    "objectID": "slides/quarto.html#header",
    "href": "slides/quarto.html#header",
    "title": "Quarto",
    "section": "Header",
    "text": "Header\n\n\n\nindex.qmd\n---\ntitle: \"My Quarto file\"\nauthor: \"Your Name\"\ndate: \"`r Sys.Date()`\"\nformat: html\n---\n\n\n\n\nDefines document properties and settings, for examples:\n\ntitle: Document title\nauthor: Authorship\ndate: Date this document was published\nformat: html, docx, or pdf"
  },
  {
    "objectID": "slides/quarto.html#body",
    "href": "slides/quarto.html#body",
    "title": "Quarto",
    "section": "Body",
    "text": "Body\n\n\n\nindex.qmd\n---\ntitle: \"Hello, Quarto\"\ndate: 2025-01-06\nauthor:\n  - name: Thinh Ong\n    orcid: 0000-0001-6772-9291\nformat: \n  html:\n    code-overflow: wrap\nnumber-sections: true\nnavbar: false\n---\n\n## Introduction to Quarto\n\nQuarto is a publishing system that allows you to create documents, presentations, websites, and more using Markdown syntax and additional tools. \n\n## Header Levels\n\nQuarto supports multiple header levels to create a hierarchical structure in your document. For example:\n\n- Level 1 header: `# Header`\n- Level 2 header: `## Subheader`\n- Level 3 header: `### Sub-subheader`\n\n### Nested Headers\n\nUsing headers, you can create nested sections to structure your document in a clear and organized way.\n\n## Inline Text Formatting\n\nYou can format your text inline to add emphasis or other styling options.\n\n- **Bold text**: `**bold**`\n- *Italic text*: `*italic*`\n- Inline `code`: `` `code` ``\n\n&gt; Blockquotes can be used to highlight important information or quotes by adding `&gt; ` at the beginning of a line.\n\n## Lists\n\nQuarto supports both ordered and unordered lists.\n\n### Unordered List\n\nTo create an unordered list, use an asterisk `*` before each item:\n\n* First item\n* Second item\n* Third item\n\n### Ordered List\n\nTo create an ordered list, use numbers before each item:\n\n1. First item\n2. Second item\n3. Third item\n\n## Links and images\n\n&lt;http://example.com&gt;\n\n[linked phrase](http://example.com)\n\n![optional caption text](imgs/oucru-logo.png)\n\n## Tables\n\n| First Header | Second Header |\n|--------------|---------------|\n| Content Cell | Content Cell  |\n| Content Cell | Content Cell  |\n\n## Code block\n\nQuarto also supports code blocks, making it easy to include and execute code within your document. Here’s an example of a code block to create a simple plot using R:\n\n```{r}\n#| fig-width: 4\n#| fig-height: 3\n#| out-width: \"100%\"\nx &lt;- c(1, 2, 3, 4, 5)\ny &lt;- c(1, 4, 9, 16, 25)\n\nplot(x, y, type = \"o\", col = \"blue\", main = \"Simple plot\", xlab = \"x\", ylab = \"y\")\n```\n\n## Footnotes\n\nFootnotes can be added inline to provide additional information or references. Here's an example of a footnote in Quarto: ^[This is an example footnote.]\n\n\n\nindex.html"
  },
  {
    "objectID": "slides/quarto.html#rendering-output",
    "href": "slides/quarto.html#rendering-output",
    "title": "Quarto",
    "section": "Rendering output",
    "text": "Rendering output\n\nSave your Quarto file.\nRender it using the “Render” button in RStudio or by pressing Ctrl+Shift+K."
  },
  {
    "objectID": "takehome_exercises/day1.html",
    "href": "takehome_exercises/day1.html",
    "title": "Day 1 - Take home exercise",
    "section": "",
    "text": "Data covid_cases.rds under R-cafe/day1/data/covid_cases.rds is used for this exercise.\n\n  \n    Data dictionary\n  \n\n\n\n\n\n\n\nColumn\nDescription\n\n\n\n\ndate\ndate of the case report\n\n\n211 columns with the format cases_{country_code}\nnumber of reported cases of each country and archipelago\n\n\n\nCountry codes of interest (i.e. Codes for countries needed for the exercise)\n\n\n\nCode\nCountry name\n\n\n\n\nchn\nChina\n\n\nusa\nUnited States of America\n\n\nvnm\nVietnam\n\n\nsgp\nSingapore"
  },
  {
    "objectID": "takehome_exercises/day1.html#dataset",
    "href": "takehome_exercises/day1.html#dataset",
    "title": "Day 1 - Take home exercise",
    "section": "",
    "text": "Data covid_cases.rds under R-cafe/day1/data/covid_cases.rds is used for this exercise.\n\n  \n    Data dictionary\n  \n\n\n\n\n\n\n\nColumn\nDescription\n\n\n\n\ndate\ndate of the case report\n\n\n211 columns with the format cases_{country_code}\nnumber of reported cases of each country and archipelago\n\n\n\nCountry codes of interest (i.e. Codes for countries needed for the exercise)\n\n\n\nCode\nCountry name\n\n\n\n\nchn\nChina\n\n\nusa\nUnited States of America\n\n\nvnm\nVietnam\n\n\nsgp\nSingapore"
  },
  {
    "objectID": "takehome_exercises/day1.html#preparation",
    "href": "takehome_exercises/day1.html#preparation",
    "title": "Day 1 - Take home exercise",
    "section": "Preparation",
    "text": "Preparation\nBefore working on this exercise, you should have completed the following checklist\n\n\n\n\n\n\nChecklist\n\n\n\nOn Github Desktop\n\nCloned R-cafe repository\nCreated your own branch on the repository\nCheckout your own branch\n\nOn RStudio\n\nMake an R project from cloned R-cafe directory\nHave renv setup\n\n\n\n\n\n\n\n\n\nAnswer script\n\n\n\nYou are expected to save your answer under R-cafe/day1/takehome.R"
  },
  {
    "objectID": "takehome_exercises/day1.html#exercises",
    "href": "takehome_exercises/day1.html#exercises",
    "title": "Day 1 - Take home exercise",
    "section": "Exercises",
    "text": "Exercises\n\nTask 1: Data import\nRead data from R-cafe/day1/data/covid_cases.rds\n\n\nTask 2: Simple computations using dataset\nCompute the following\n\nThe earliest and latest date of data report in the dataset and assign them to 2 variables first_report_date, last_report_date\nCreate new column case_global for covid_cases, which represents the total cases across every country per report day.\nCreate new column percent_chn in covid_cases, which represents the percentage of global cases that China’s cases account for per report day.\n\n\n\n\n\n\n\nTip: compute sum of each row\n\n\n\n\n\nUse function rowSums() to compute sum of case columns row wise\nExample\n\nexample_table &lt;- data.frame(\n  a = c(1:3), b = c(4:6)\n)\n# show example_table\nexample_table\n\n\n  \n\n\n# see output of rowSums\nrowSums(example_table)\n\n[1] 5 7 9\n\n\n\n\n\n\n\n\n\n\n\nTip: create new column/ update column values\n\n\n\n\n\nTo create/update a column, use the syntax data[[\"colname\"]] &lt;- values_for_col where length of values_for_col must be equal to number of rows\nExample\n\nexample_table &lt;- data.frame(\n  a = c(1:3), b = c(4:6)\n)\n\n# create new column new_col\nexample_table[[\"new_col\"]] &lt;- c(7,9,11)\nexample_table\n\n\n  \n\n\n\n\n\n\n\n\nTask 3: Create a function\nComplete the following:\n\nCreate a function compute_percent that\n\ntakes the dataset and the country code (i.e. the 3 characters after cases_ in column name) as input.\nreturn the percentage of the global cases that the given country’s cases account for per report day.\n\nUse that function to create 3 new columns for covid_cases: percent_vnm, percent_usa, percent_sgp\nPrint the final covid_cases selecting only the following columns date, percent_chn, percent_vnm, percent_usa, percent_sgp\n\n\n\n\n\n\n\nTip: joining strings\n\n\n\n\n\nUse function paste() to join multiple strings together\nExample\n\n# joining 2 strings\npaste(\"cases_\", \"chn\", sep = \"\")\n\n[1] \"cases_chn\"\n\n# joining 3 strings\npaste(\"hello\", \"world,\", \"welcome to R-cafe\", sep = \" \")\n\n[1] \"hello world, welcome to R-cafe\"\n\n\n\n\n\n\n\nTask 3.5 (Optional) Create a function from given code\nCreate a function that returns the plot for number of cases reported for a country over time, where users can\n\nSelect the case column being plotted\nChange the country name displayed on the plot’s title\nChange the color of the bar chart and line chart\nSet the min and max date (x-axis limit) for the plot\n\nGiven that the code to plot case reports for China is as followed\n\n# Uncomment and run the following if you have not installed tidyverse or ggplot2\n# install.packages(\"tidyverse\")\nlibrary(ggplot2)\nplot_col &lt;- \"cases_chn\"\ncountry &lt;- \"China\"\n\nggplot() +\n  geom_col( # layer for bar chart\n    aes( # define columns for x, y axis\n      x = covid_cases$date, # this is equivalent to covid_cases[[\"date\"]]\n      y = covid_cases[[plot_col]] \n      ), \n    fill = \"cornflowerblue\" # choose color for bar chart\n  ) +\n  geom_line( # layer for line chart\n    aes( # define columns for x, y axis\n      x = covid_cases$date, \n      y = covid_cases[[plot_col]] \n      ), \n    color = \"red\" # choose color for line chart\n  ) +\n  labs(\n    y = \"Cases\",\n    x = \"Date\",\n    title = paste0(\"Reported Covid cases for \", country) # define title for the plot\n  )\n\n\n\n\n\n\n\n\n\n\nTask 4: Generate data summary\nComplete the following:\n\nUse the function skim() from package skimr to generate summary for the following countries: China, Vietnam, USA, Singapore\nDescribe notable observations from each country from the result of skim()\n\n\n\nTask 5: Peer review\nComplete the following:\n\nPush your solution to Github with the commit message \"day 1 take home solution your_name\"\nCreate an issue commenting on at least 1 other participant’s solution"
  }
]